Sat Oct 19 16:43:07 2024
spot(s):
[561.4  562.84 563.07 567.8  567.82 568.62 568.86 570.98 571.47 572.3
 572.98 573.17 573.76 576.13 577.14 579.58 579.78 584.32]

strikes:
[280 281 283 284 285 286 288 289 292 421 422 425 426 428 429 430 432 434
 438 561 562 563 567 568 570 571 572 573 576 577 579 584 701 703 709 710
 711 713 714 715 716 717 720 721 724 730 842 844 851 852 853 856 857 858
 859 860 864 865 869 876]

maturities:
[ 30 150 300]

types:
['call' 'put']

averaging_type:
['arithmetic' 'geometric']

fixing_frequency:
[30]

past_fixings:
[0]

n_fixings:
[ 1  5 10]

number of calls, puts:
540,540

total prices:
1080
Deep Neural Network
hidden layers sizes: (15, 15, 15)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
       spot_price  strike_price  risk_free_rate  dividend_rate  \
count  1080.00000    1080.00000      1080.00000     1080.00000   
mean    571.77889     571.25556         0.04000        0.00000   
min     561.40000     280.00000         0.04000        0.00000   
25%     567.82000     425.00000         0.04000        0.00000   
50%     571.88500     571.50000         0.04000        0.00000   
75%     576.13000     720.00000         0.04000        0.00000   
max     584.32000     876.00000         0.04000        0.00000   
std       6.01947     202.36474         0.00000        0.00000   

       fixing_frequency  n_fixings  past_fixings      kappa      theta  \
count        1080.00000 1080.00000    1080.00000 1080.00000 1080.00000   
mean           30.00000    5.33333       0.00000    5.09268    0.29906   
min            30.00000    1.00000       0.00000    0.01341    0.04390   
25%            30.00000    1.00000       0.00000    2.75471    0.05004   
50%            30.00000    5.00000       0.00000    3.60480    0.05146   
75%            30.00000   10.00000       0.00000    7.53567    0.05985   
max            30.00000   10.00000       0.00000   12.42279    4.40126   
std             0.00000    3.68349       0.00000    3.63790    0.99554   

             rho        eta         v0     calculation_date  days_to_maturity  \
count 1080.00000 1080.00000 1080.00000                 1080        1080.00000   
mean    -0.71369    2.54968    0.03422  2024-10-01 12:00:00         160.00000   
min     -0.79062    1.22247    0.01412  2024-09-16 00:00:00          30.00000   
25%     -0.74857    1.59735    0.02730  2024-09-26 00:00:00          30.00000   
50%     -0.72176    1.99898    0.03510  2024-10-02 12:00:00         150.00000   
75%     -0.66907    3.46192    0.04596  2024-10-09 00:00:00         300.00000   
max     -0.63767    4.66356    0.05040  2024-10-15 00:00:00         300.00000   
std      0.04422    1.15761    0.01104                  NaN         110.50478   

       asian_price    vanilla  difference  moneyness  observed_price  
count   1080.00000 1080.00000  1080.00000 1080.00000      1080.00000  
mean      80.83492   89.79388     8.95896    0.08028        80.85737  
min        0.00000    0.00000   -10.65225   -0.50160         0.00000  
25%        0.00906    0.54218     0.00064   -0.25088         0.10213  
50%        9.62514   21.23641     1.12937    0.00000         9.63975  
75%      145.52173  153.59955     6.98193    0.33489       145.35446  
max      292.73809  303.22674   286.91581    1.00643       292.92634  
std      108.81720  109.79414    37.86763    0.42813       108.80705  
#############
# test data #
#############
       spot_price  strike_price  risk_free_rate  dividend_rate  \
count   120.00000     120.00000       120.00000      120.00000   
mean    582.32500     581.80000         0.04000        0.00000   
min     582.30000     291.00000         0.04000        0.00000   
25%     582.30000     436.00000         0.04000        0.00000   
50%     582.32500     582.00000         0.04000        0.00000   
75%     582.35000     727.00000         0.04000        0.00000   
max     582.35000     873.00000         0.04000        0.00000   
std       0.02510     206.63098         0.00000        0.00000   

       fixing_frequency  n_fixings  past_fixings     kappa     theta  \
count         120.00000  120.00000     120.00000 120.00000 120.00000   
mean           30.00000    5.33333       0.00000   4.34713   0.04413   
min            30.00000    1.00000       0.00000   3.91783   0.04171   
25%            30.00000    1.00000       0.00000   3.91783   0.04171   
50%            30.00000    5.00000       0.00000   4.34713   0.04413   
75%            30.00000   10.00000       0.00000   4.77644   0.04654   
max            30.00000   10.00000       0.00000   4.77644   0.04654   
std             0.00000    3.69722       0.00000   0.43110   0.00243   

            rho       eta        v0     calculation_date  days_to_maturity  \
count 120.00000 120.00000 120.00000                  120         120.00000   
mean   -0.71277   2.12882   0.03793  2024-10-16 12:00:00         160.00000   
min    -0.72834   1.76153   0.03697  2024-10-16 00:00:00          30.00000   
25%    -0.72834   1.76153   0.03697  2024-10-16 00:00:00          30.00000   
50%    -0.71277   2.12882   0.03793  2024-10-16 12:00:00         150.00000   
75%    -0.69721   2.49610   0.03890  2024-10-17 00:00:00         300.00000   
max    -0.69721   2.49610   0.03890  2024-10-17 00:00:00         300.00000   
std     0.01563   0.36882   0.00097                  NaN         110.91673   

       asian_price   vanilla  difference  moneyness  observed_price  
count    120.00000 120.00000   120.00000  120.00000       120.00000  
mean      88.68140  91.10863     2.42723    0.08008        88.66138  
min        0.00000   0.00000   -10.58129   -0.50030         0.00000  
25%        0.02542   0.55307     0.00040   -0.25126         0.12950  
50%       13.26228  21.18774     1.01045    0.00000        13.33946  
75%      149.13060 156.39947     5.11567    0.33558       149.04470  
max      291.75119 302.27623    19.34951    1.00120       291.82674  
std      113.04281 112.22190     6.11359    0.42905       113.01662  

spot_price                 float64
strike_price                 int64
risk_free_rate             float64
dividend_rate              float64
w                           object
averaging_type              object
fixing_frequency             int64
n_fixings                    int64
past_fixings                 int64
kappa                      float64
theta                      float64
rho                        float64
eta                        float64
v0                         float64
calculation_date    datetime64[ns]
days_to_maturity             int64
asian_price                float64
vanilla                    float64
difference                 float64
moneyness                  float64
observed_price             float64
dtype: object
in sample results:
     RMSE: 28.4742557980399
     MAE: 17.468351449219323

out of sample results:
     RMSE: 18.251839172555997
     MAE: 14.53565034381689

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     fixing_frequency
     n_fixings
     past_fixings
     averaging_type
     w

target: observed_price

cpu: 3.3552377223968506
Sat Oct 19 16:43:10 2024