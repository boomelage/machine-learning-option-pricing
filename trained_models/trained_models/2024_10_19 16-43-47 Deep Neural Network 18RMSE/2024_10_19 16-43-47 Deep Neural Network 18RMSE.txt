Sat Oct 19 16:43:44 2024
spot(s):
[561.4  562.84 563.07 567.8  567.82 568.25 568.62 568.86 569.67 570.04
 570.98 571.3  571.47 572.3  572.98 573.17 573.76 576.13 577.14 579.58
 584.32]

strikes:
[280 281 283 284 285 286 288 289 292 421 422 425 426 427 428 429 430 432
 434 438 561 562 563 567 568 569 570 571 572 573 576 577 579 584 701 703
 709 710 711 712 713 714 715 716 717 720 721 724 730 842 844 851 852 853
 854 855 856 857 858 859 860 864 865 869 876]

maturities:
[ 30 150 300]

types:
['call' 'put']

averaging_type:
['arithmetic' 'geometric']

fixing_frequency:
[30]

past_fixings:
[0]

n_fixings:
[ 1  5 10]

number of calls, puts:
630,630

total prices:
1260
Deep Neural Network
hidden layers sizes: (15, 15, 15)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
       spot_price  strike_price  risk_free_rate  dividend_rate  \
count  1260.00000    1260.00000      1260.00000     1260.00000   
mean    571.02381     570.54286         0.04000        0.00000   
min     561.40000     280.00000         0.04000        0.00000   
25%     568.25000     426.00000         0.04000        0.00000   
50%     570.98000     570.00000         0.04000        0.00000   
75%     573.17000     716.00000         0.04000        0.00000   
max     584.32000     876.00000         0.04000        0.00000   
std       5.32847     202.05587         0.00000        0.00000   

       fixing_frequency  n_fixings  past_fixings      kappa      theta  \
count        1260.00000 1260.00000    1260.00000 1260.00000 1260.00000   
mean           30.00000    5.33333       0.00000    5.01061    0.26588   
min            30.00000    1.00000       0.00000    0.01341    0.04390   
25%            30.00000    1.00000       0.00000    2.72222    0.05004   
50%            30.00000    5.00000       0.00000    3.08054    0.05185   
75%            30.00000   10.00000       0.00000    7.53567    0.05985   
max            30.00000   10.00000       0.00000   12.42279    4.40126   
std             0.00000    3.68325       0.00000    3.67781    0.92524   

             rho        eta         v0               calculation_date  \
count 1260.00000 1260.00000 1260.00000                           1260   
mean    -0.70633    2.49039    0.03085  2024-09-29 05:42:51.428571392   
min     -0.79062    1.22247    0.01068            2024-09-16 00:00:00   
25%     -0.73748    1.57604    0.02035            2024-09-23 00:00:00   
50%     -0.69539    1.90807    0.02988            2024-09-30 00:00:00   
75%     -0.66907    3.46192    0.03984            2024-10-07 00:00:00   
max     -0.61937    4.66356    0.05040            2024-10-14 00:00:00   
std      0.04619    1.15800    0.01214                            NaN   

       days_to_maturity  asian_price    vanilla  difference  moneyness  \
count        1260.00000   1260.00000 1260.00000  1260.00000 1260.00000   
mean          160.00000     81.54101   89.58085     8.03984    0.08026   
min            30.00000      0.00000    0.00000   -10.65225   -0.50160   
25%            30.00000      0.00906    0.52860     0.00033   -0.25082   
50%           150.00000      9.53155   21.23641     1.06371    0.00000   
75%           300.00000    145.34596  153.10660     6.77901    0.33479   
max           300.00000    292.73809  303.22674   286.91581    1.00643   
std           110.49747    108.97762  109.67298    35.20685    0.42802   

       observed_price  
count      1260.00000  
mean         81.56218  
min           0.00000  
25%           0.10311  
50%           9.65068  
75%         145.36211  
max         292.61426  
std         108.96866  
#############
# test data #
#############
       spot_price  strike_price  risk_free_rate  dividend_rate  \
count   180.00000     180.00000       180.00000      180.00000   
mean    581.47667     580.86667         0.04000        0.00000   
min     579.78000     289.00000         0.04000        0.00000   
25%     579.78000     434.00000         0.04000        0.00000   
50%     582.30000     582.00000         0.04000        0.00000   
75%     582.35000     727.00000         0.04000        0.00000   
max     582.35000     873.00000         0.04000        0.00000   
std       1.20325     206.11030         0.00000        0.00000   

       fixing_frequency  n_fixings  past_fixings     kappa     theta  \
count         180.00000  180.00000     180.00000 180.00000 180.00000   
mean           30.00000    5.33333       0.00000   4.27444   0.04644   
min            30.00000    1.00000       0.00000   3.91783   0.04171   
25%            30.00000    1.00000       0.00000   3.91783   0.04171   
50%            30.00000    5.00000       0.00000   4.12907   0.04654   
75%            30.00000   10.00000       0.00000   4.77644   0.05107   
max            30.00000   10.00000       0.00000   4.77644   0.05107   
std             0.00000    3.69206       0.00000   0.36631   0.00383   

            rho       eta        v0     calculation_date  days_to_maturity  \
count 180.00000 180.00000 180.00000                  180         180.00000   
mean   -0.70254   2.15363   0.03832  2024-10-16 00:00:00         160.00000   
min    -0.72834   1.76153   0.03697  2024-10-15 00:00:00          30.00000   
25%    -0.72834   1.76153   0.03697  2024-10-15 00:00:00          30.00000   
50%    -0.69721   2.20326   0.03890  2024-10-16 00:00:00         150.00000   
75%    -0.68208   2.49610   0.03910  2024-10-17 00:00:00         300.00000   
max    -0.68208   2.49610   0.03910  2024-10-17 00:00:00         300.00000   
std     0.01931   0.30278   0.00097                  NaN         110.76171   

       asian_price   vanilla  difference  moneyness  observed_price  
count    180.00000 180.00000   180.00000  180.00000       180.00000  
mean      88.62111  91.11981     2.49870    0.08021        88.64091  
min        0.00000   0.00000   -10.58129   -0.50154         0.00000  
25%        0.02612   0.55766     0.00046   -0.25131         0.16968  
50%       13.29512  21.39379     1.01901    0.00000        13.27789  
75%      148.93323 156.26851     5.12205    0.33567       148.95504  
max      291.75119 302.27623    20.10217    1.00616       292.13602  
std      112.73172 111.90062     6.15075    0.42888       112.73148  

spot_price                 float64
strike_price                 int64
risk_free_rate             float64
dividend_rate              float64
w                           object
averaging_type              object
fixing_frequency             int64
n_fixings                    int64
past_fixings                 int64
kappa                      float64
theta                      float64
rho                        float64
eta                        float64
v0                         float64
calculation_date    datetime64[ns]
days_to_maturity             int64
asian_price                float64
vanilla                    float64
difference                 float64
moneyness                  float64
observed_price             float64
dtype: object
in sample results:
     RMSE: 29.193210396679508
     MAE: 17.979845268769807

out of sample results:
     RMSE: 18.309015856576494
     MAE: 14.445558683111658

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     fixing_frequency
     n_fixings
     past_fixings
     averaging_type
     w

target: observed_price

cpu: 2.652416229248047
Sat Oct 19 16:43:47 2024