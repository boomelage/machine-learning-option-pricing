Thu Oct 10 11:49:42 2024
spot(s):
[ 966.34  969.87  985.17 1156.65 1161.63 1165.72 1187.4  1188.42 1195.66
 1203.3  1207.56 1210.16 1213.76 1214.59 1214.91 1225.07 1228.34 1231.72
 1235.03 1236.81 1240.01 1242.38 1244.81 1245.64 1248.97 1249.51 1251.98
 1252.02 1253.1  1253.33 1253.75 1257.85 1259.82 1260.39 1260.44 1260.47
 1261.75 1263.07 1263.23 1266.66 1267.13 1267.3  1267.4  1267.76 1271.47
 1273.68 1274.24 1274.77 1275.25 1276.78 1276.84 1277.53 1277.54 1279.06
 1279.22 1279.51 1281.63 1281.9  1283.32 1283.57 1284.14 1284.21 1285.13
 1285.9  1288.77 1289.26 1289.99 1292.07 1292.95 1293.41 1295.65 1298.15
 1298.46 1299.97 1304.46 1305.09 1308.8  1311.13 1314.51 1314.81 1315.19
 1317.94 1318.45 1320.45 1322.21 1322.24 1325.42 1325.9  1326.38 1326.79
 1328.62 1329.65 1329.75 1330.53 1330.91 1331.14 1331.49 1333.24 1333.44
 1333.8  1334.79 1335.63 1336.97 1337.24 1338.18 1338.73 1339.01 1340.15
 1340.92 1342.48 1342.83 1348.8  1348.82 1348.83 1349.69 1349.91 1350.78
 1351.52 1352.69 1353.69 1353.73 1354.63 1354.95 1358.24 1359.88 1360.
 1360.03 1360.47 1360.48 1362.14 1363.84 1365.56 1365.65 1366.54 1367.41
 1367.69 1369.22 1369.79 1370.68 1371.44 1372.41 1372.91 1374.2  1376.17
 1376.18 1376.5  1377.07 1377.59 1377.99 1379.83 1380.11 1380.72 1380.79
 1381.38 1385.23 1385.42 1385.74 1386.77 1386.98 1387.16 1388.04 1388.3
 1388.63 1390.08 1390.45 1390.84 1391.01 1391.18 1391.82 1392.05 1392.46
 1394.07 1395.   1395.15 1396.31 1397.45 1398.   1398.05 1399.4  1399.96
 1401.2  1401.5  1401.77 1402.74 1403.05 1403.12 1403.51 1403.52 1406.48
 1406.58 1406.64 1406.77 1407.53 1408.06 1409.11 1409.14 1409.82 1410.74
 1411.59 1412.12 1412.71 1413.18 1413.53 1413.8  1414.71 1416.12 1416.34
 1416.4  1416.59 1416.97 1418.28 1418.38 1419.95 1420.46 1420.83 1422.42
 1422.43 1423.07 1423.24 1423.8  1424.27 1424.44 1425.15 1426.09 1426.43
 1426.6  1428.02 1428.35 1428.7  1428.81 1430.36 1430.59 1430.69 1431.78
 1433.18 1433.19 1433.55 1433.65 1434.56 1434.69 1436.11 1437.38 1437.45
 1438.07 1438.45 1438.91 1438.99 1439.15 1439.53 1439.88 1439.97 1443.66
 1444.24 1444.47 1445.28 1445.5  1445.71 1446.04 1446.9  1447.03 1447.04
 1447.54 1447.77 1447.89 1448.38 1448.46 1449.6  1449.93 1451.21 1451.23
 1451.6  1452.52 1452.78 1452.95 1452.96 1453.53 1453.85 1454.4  1454.47
 1454.78 1455.05 1455.51 1456.3  1456.93 1457.51 1457.85 1458.35 1459.18
 1459.53 1460.37 1462.63 1462.85 1463.59 1463.78 1466.35 1466.84 1467.25
 1467.54 1467.95 1468.23 1469.04 1469.89 1470.07 1470.62 1471.33 1471.43
 1471.49 1471.93 1471.99 1472.32 1472.58 1472.83 1473.51 1474.26 1475.44
 1476.23 1476.68 1476.91 1477.65 1477.88 1478.45 1479.09 1480.49 1480.57
 1481.12 1481.25 1482.47 1483.7  1484.16 1484.4  1484.51 1484.68 1484.86
 1486.09 1486.9  1488.85 1489.28 1489.55 1491.66 1492.47 1493.24 1494.22
 1494.32 1495.27 1496.   1496.9  1497.37 1497.42 1497.46 1500.66 1501.4
 1502.13 1502.3  1502.37 1503.06 1503.36 1504.31 1505.36 1505.49 1506.
 1506.03 1506.09 1506.44 1507.3  1507.68 1507.84 1507.94 1508.33 1509.13
 1510.2  1510.29 1511.77 1512.26 1512.52 1512.61 1513.95 1514.24 1515.42
 1515.75 1515.9  1516.16 1516.28 1517.65 1517.78 1517.93 1518.08 1518.59
 1518.8  1519.26 1519.38 1519.66 1520.45 1521.61 1522.16 1522.51 1522.95
 1523.96 1524.76 1524.84 1525.35 1525.39 1525.5  1526.61 1528.78 1529.95
 1530.14 1530.37 1530.69 1531.05 1531.08 1531.44 1531.83 1532.93 1533.31
 1534.08 1535.14 1536.18 1538.87 1539.04 1539.62 1539.7  1540.86 1541.15
 1542.85 1544.83 1546.47 1546.48 1547.66 1548.82 1549.07 1549.66 1549.68
 1552.26 1552.65 1552.8  1554.55 1557.09 1561.58 1562.09 1565.18]

strikes:
[ 869.706      872.883      873.6502449 ... 1717.738     1718.299
 1721.698    ]

maturities:
[ 60  90 180 360 540 720]

types:
['call' 'put']

['DownOut' 'DownIn' 'UpOut' 'UpIn']
number of calls, puts:
2307119,2360454

total prices:
4667573
Deep Neural Network
hidden layers sizes: (13, 13, 13)
learning rate: constant
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
         spot_price  strike_price       barrier  days_to_maturity  \
count 4667573.00000 4667573.00000 4667573.00000     4667573.00000   
mean     1397.30676    1396.28982    1397.21087         330.41497   
min       966.34000     869.70600     483.17000          60.00000   
25%      1318.45000    1302.21000    1033.30010          90.00000   
50%      1409.14000    1398.32284    1394.59790         360.00000   
75%      1492.47000    1496.00347    1739.87892         540.00000   
max      1565.18000    1721.69800    2347.77000         720.00000   
std       111.23656     137.97653     447.12905         241.58173   

       barrier_price        rebate  dividend_rate  risk_free_rate  \
count  4667573.00000 4667573.00000  4667573.00000   4667573.00000   
mean        53.86260       0.00000        0.02064         0.04000   
min          0.00000       0.00000        0.01780         0.04000   
25%          2.49687       0.00000        0.01881         0.04000   
50%         32.27427       0.00000        0.02017         0.04000   
75%         93.67732       0.00000        0.02228         0.04000   
max        293.09806       0.00000        0.02944         0.04000   
std         57.60931       0.00000        0.00207         0.00000   

              theta         kappa           rho           eta            v0  \
count 4667573.00000 4667573.00000 4667573.00000 4667573.00000 4667573.00000   
mean        0.05046       2.54513      -0.93738       0.22781       0.04717   
min         0.01992       0.03970      -1.00000       0.08818       0.00524   
25%         0.04034       1.27238      -1.00000       0.15860       0.02683   
50%         0.05427       1.85814      -1.00000       0.17809       0.04289   
75%         0.05834       2.75434      -1.00000       0.20825       0.05706   
max         0.40505      12.32603      -0.24433       1.52388       0.29963   
std         0.01550       2.22894       0.16677       0.19036       0.03483   

                    calculation_date                expiration_date  \
count                        4667573                        4667573   
mean   2008-01-10 21:53:17.974022400  2008-12-06 07:50:51.145681152   
min              2007-01-03 00:00:00            2007-03-04 00:00:00   
25%              2007-08-27 00:00:00            2008-04-28 00:00:00   
50%              2008-01-11 00:00:00            2008-11-15 00:00:00   
75%              2008-06-06 00:00:00            2009-07-12 00:00:00   
max              2008-11-03 00:00:00            2010-10-24 00:00:00   
std                              NaN                            NaN   

          moneyness  observed_price  
count 4667573.00000   4667573.00000  
mean        3.48310        53.86957  
min        -0.96515         0.00000  
25%        -0.78599         2.49856  
50%        -0.39457        32.27158  
75%         3.33884        93.67263  
max        27.69497       292.85670  
std         6.91364        57.60306  
#############
# test data #
#############
        spot_price  strike_price      barrier  days_to_maturity  \
count 914130.00000  914130.00000 914130.00000      914130.00000   
mean     845.42078     845.39106    845.57056         325.09852   
min      676.03000     608.42700    338.01500          60.00000   
25%      826.55000     792.64196    625.87395          90.00000   
50%      857.33000     849.32737    848.75670         360.00000   
75%      888.94000     905.60204   1058.26463         540.00000   
max     1005.42000    1105.96200   1508.13000         720.00000   
std       67.14607      83.64351    272.84312         241.49723   

       barrier_price       rebate  dividend_rate  risk_free_rate        theta  \
count   914130.00000 914130.00000   914130.00000    914130.00000 914130.00000   
mean        58.39169      0.00000        0.03291         0.04000      0.14192   
min          0.00000      0.00000        0.02827         0.04000      0.11522   
25%          7.00700      0.00000        0.03203         0.04000      0.13053   
50%         43.28167      0.00000        0.03292         0.04000      0.13674   
75%         98.18251      0.00000        0.03406         0.04000      0.15301   
max        253.83195      0.00000        0.03560         0.04000      0.19559   
std         56.32248      0.00000        0.00135         0.00000      0.01682   

             kappa          rho          eta           v0  \
count 914130.00000 914130.00000 914130.00000 914130.00000   
mean       4.31259     -0.99992      0.25323      0.20406   
min        0.91936     -1.00000      0.19276      0.09981   
25%        2.80113     -1.00000      0.21908      0.15215   
50%        3.69742     -0.99999      0.25015      0.17695   
75%        5.58025     -0.99989      0.28262      0.26178   
max       12.31060     -0.99922      0.43651      0.38708   
std        2.46292      0.00014      0.04331      0.07286   

                    calculation_date                expiration_date  \
count                         914130                         914130   
mean   2009-01-10 14:21:50.418430976  2009-12-01 16:43:42.538151680   
min              2008-11-04 00:00:00            2009-01-03 00:00:00   
25%              2008-12-12 00:00:00            2009-04-27 00:00:00   
50%              2009-01-12 00:00:00            2009-10-30 00:00:00   
75%              2009-02-10 00:00:00            2010-07-07 00:00:00   
max              2009-03-10 00:00:00            2011-02-28 00:00:00   
std                              NaN                            NaN   

         moneyness  observed_price  
count 914130.00000    914130.00000  
mean       1.95812        58.39564  
min       -0.94575         0.00000  
25%       -0.70721         7.00426  
50%       -0.00286        43.27579  
75%        1.92393        98.18871  
max       17.43270       253.69872  
std        4.24193        56.31862  

spot_price                  float64
strike_price                float64
barrier                     float64
days_to_maturity              int64
barrier_price               float64
updown                       object
outin                        object
w                            object
barrier_type_name            object
rebate                      float64
dividend_rate               float64
risk_free_rate              float64
theta                       float64
kappa                       float64
rho                         float64
eta                         float64
v0                          float64
calculation_date     datetime64[ns]
expiration_date      datetime64[ns]
moneyness                   float64
observed_price              float64
dtype: object
in sample results:
     RMSE: 5.356772572248143
     MAE: 3.6196318442745268

out of sample results:
     RMSE: 17.384060532676404
     MAE: 12.58775891004171

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     barrier
     barrier_type_name
     w

target: observed_price

cpu: 879.7736015319824
Thu Oct 10 12:04:22 2024