Sat Oct 26 19:48:47 2024
spot(s):
[ 810.12  814.96  824.7   832.58  833.54  834.92  841.27  841.94  843.51
  849.83  852.    852.08  855.    856.34  857.61  858.09  865.04  865.79
  869.57  872.54  873.29  877.33  878.94  879.73  880.94  882.34  883.16
  884.01  887.28  888.29  892.53  893.02  893.08  894.83  897.78  898.58
  900.74  900.91  903.38  903.63  905.71  906.67  907.35  907.51  908.24
  908.46  909.48  909.78  910.21  910.77  911.92  918.26  918.44  919.37
  919.4   919.42  920.17  920.98  923.08  923.86  927.17  929.05  932.06
  932.58  939.09  939.21  940.4   940.46  940.62  942.07  942.22  943.4
  944.62  944.67  946.18  950.86  953.92  954.42  975.26  976.04  979.31
  979.69  979.83  982.26  986.54  987.39  989.34  994.36  994.63  996.51
  997.07  997.63 1002.34 1002.69 1003.05 1004.09 1005.38 1005.8  1007.2
 1007.29 1010.48 1012.75 1016.3  1020.61 1022.31 1025.09 1025.26 1025.37
 1025.53 1027.72 1027.88 1027.95 1028.84 1029.64 1030.49 1030.57 1030.72
 1033.21 1035.98 1040.26 1041.45 1042.58 1042.78 1042.84 1044.03 1044.66
 1045.06 1046.38 1047.46 1048.92 1049.01 1049.16 1050.42 1050.65 1051.82
 1052.65 1054.76 1055.39 1055.77 1056.37 1056.71 1057.55 1060.18 1060.57
 1060.91 1061.94 1062.78 1063.03 1063.43 1064.52 1064.74 1064.99 1065.
 1065.26 1065.72 1065.84 1066.24 1066.57 1067.01 1067.38 1067.84 1068.06
 1068.19 1068.62 1069.24 1069.52 1070.1  1070.48 1070.6  1071.38 1071.42
 1071.58 1071.63 1071.64 1073.5  1073.57 1073.76 1074.18 1074.53 1075.64
 1076.08 1076.21 1077.41 1077.89 1078.49 1078.78 1079.39 1079.45 1079.7
 1080.19 1081.3  1083.43 1083.58 1084.55 1086.93 1087.24 1087.71 1087.78
 1089.1  1089.29 1089.75 1089.82 1089.97 1091.08 1091.49 1091.64 1091.93
 1091.94 1092.03 1092.11 1092.18 1092.54 1092.59 1092.7  1092.92 1093.03
 1093.46 1093.47 1094.2  1094.72 1094.81 1095.05 1095.13 1095.24 1095.44
 1095.72 1095.82 1096.22 1096.25 1096.35 1096.86 1097.22 1097.42 1097.69
 1098.51 1098.58 1098.9  1099.56 1099.92 1101.45 1101.6  1102.18 1102.57
 1102.84 1102.91 1103.13 1103.14 1103.23 1103.28 1104.32 1104.49 1104.56
 1105.13 1105.75 1105.8  1106.12 1106.15 1106.49 1106.57 1107.94 1107.97
 1108.72 1108.96 1109.05 1109.22 1109.39 1109.7  1109.71 1110.24 1110.41
 1110.82 1113.16 1113.8  1114.09 1114.18 1114.54 1114.81 1114.87 1115.09
 1115.14 1115.56 1115.87 1116.3  1117.44 1118.12 1118.13 1118.69 1120.3
 1120.56 1120.83 1121.1  1121.54 1121.83 1122.87 1124.86 1124.98 1125.26
 1125.57 1125.76 1125.78 1126.17 1126.18 1126.26 1127.22 1127.66 1127.85
 1127.93 1133.02 1134.44 1135.83 1136.01 1136.22 1136.37 1136.71 1136.83
 1137.06 1137.97 1138.43 1138.62 1139.99 1140.42 1141.16 1141.59 1142.5
 1142.63 1144.51 1144.92 1145.52 1145.7  1146.05 1146.96 1147.59 1148.38
 1148.39 1150.   1150.05 1150.18 1150.34 1155.78 1157.26 1157.85 1159.46
 1159.57 1159.68 1159.72 1160.07 1164.82 1165.14 1165.64 1165.87 1165.91
 1165.92 1165.95 1166.17 1166.68 1167.89 1169.5  1169.6  1171.66 1173.27
 1173.31 1173.64 1173.69 1174.13 1176.1  1177.85 1177.91 1177.97 1178.04
 1178.08 1180.13 1180.31 1182.32 1182.49 1182.79 1183.22 1183.43 1183.75
 1184.08 1184.38 1185.57 1185.63 1186.53 1186.72 1187.39 1189.48 1191.58
 1192.31 1193.38 1194.35 1195.98 1196.51 1197.25 1197.26 1197.47 1197.65
 1197.75 1199.03 1199.1  1202.18 1205.75 1206.79 1207.3  1208.87 1210.6
 1211.77 1212.19 1213.5  1213.66 1217.14 1218.57 1220.71 1223.13 1225.71]

strikes:
[ 405.  407.  412. ... 1831. 1834. 1838.]

maturities:
[  1   7  28  84 168 336]

types:
['call' 'put']

averaging_type:
['arithmetic' 'geometric']

fixing_frequency:
[  1   7  28  84 168 336]

past_fixings:
[0]

n_fixings:
[  1.   2.   3.   4.   6.   7.  12.  24.  28.  48.  84. 168. 336.]

number of calls, puts:
87570,87570

total prices:
175140
Deep Neural Network
hidden layers sizes: (15, 15, 15)
learning rate: adaptive
activation: relu
solver: lbfgs
alpha: 0.0001
#################
# training data #
#################
        spot_price  strike_price  days_to_maturity    n_fixings  \
count 175140.00000  175140.00000      175140.00000 175140.00000   
mean    1066.71367    1066.20743         156.71429     35.52381   
min      810.12000     405.00000           1.00000      1.00000   
25%     1022.31000     766.50000          28.00000      1.00000   
50%     1091.93000    1080.75000         168.00000      4.00000   
75%     1135.83000    1381.00000         336.00000     24.00000   
max     1225.71000    1838.00000         336.00000    336.00000   
std       97.68998     391.11544         126.00570     77.38831   

       fixing_frequency  past_fixings  risk_free_rate  dividend_rate  \
count      175140.00000  175140.00000    175140.00000   175140.00000   
mean           51.28571       0.00000         0.04000        0.02170   
min             1.00000       0.00000         0.04000        0.01886   
25%             1.00000       0.00000         0.04000        0.02027   
50%             7.00000       0.00000         0.04000        0.02107   
75%            84.00000       0.00000         0.04000        0.02242   
max           336.00000       0.00000         0.04000        0.02902   
std            81.25945       0.00000         0.00000        0.00214   

                    calculation_date        kappa        theta          rho  \
count                         175140 175140.00000 175140.00000 175140.00000   
mean   2010-01-27 07:25:28.057553920      4.45372      0.07235     -0.90167   
min              2009-04-01 00:00:00      0.25135      0.04162     -1.00000   
25%              2009-08-28 00:00:00      3.31337      0.06261     -0.99998   
50%              2010-01-28 00:00:00      4.28902      0.06982     -0.92557   
75%              2010-06-28 00:00:00      5.45924      0.07807     -0.84123   
max              2010-11-23 00:00:00     12.96091      0.21985     -0.41779   
std                              NaN      1.75881      0.02030      0.11464   

               eta           v0        asian  observed_price  
count 175140.00000 175140.00000 175140.00000    175140.00000  
mean       0.20121      0.04391    165.77631       165.77865  
min        0.11096      0.00992      0.00000         0.00000  
25%        0.17376      0.02578      0.00326         0.02969  
50%        0.18833      0.03662     36.22074        36.21849  
75%        0.20732      0.05265    280.44331       280.44873  
max        0.75922      0.15056    614.57498       614.57677  
std        0.05953      0.02682    206.17731       206.17534  
#############
# test data #
#############
        spot_price  strike_price  days_to_maturity    n_fixings  \
count 175140.00000  175140.00000      175140.00000 175140.00000   
mean    1292.99029    1292.49041         156.71429     35.52381   
min     1098.53000     549.00000           1.00000      1.00000   
25%     1253.78000     939.50000          28.00000      1.00000   
50%     1307.62000    1307.00000         168.00000      4.00000   
75%     1341.89000    1675.00000         336.00000     24.00000   
max     1418.47000    2127.00000         336.00000    336.00000   
std       67.33287     462.69171         126.00570     77.38831   

       fixing_frequency  past_fixings  risk_free_rate  dividend_rate  \
count      175140.00000  175140.00000    175140.00000   175140.00000   
mean           51.28571       0.00000         0.04000        0.02124   
min             1.00000       0.00000         0.04000        0.01791   
25%             1.00000       0.00000         0.04000        0.01985   
50%             7.00000       0.00000         0.04000        0.02159   
75%            84.00000       0.00000         0.04000        0.02245   
max           336.00000       0.00000         0.04000        0.02444   
std            81.25945       0.00000         0.00000        0.00164   

                    calculation_date        kappa        theta          rho  \
count                         175140 175140.00000 175140.00000 175140.00000   
mean   2011-09-22 17:57:24.604316928      2.53617      0.06582     -0.82870   
min              2010-11-24 00:00:00      0.09804      0.03784     -1.00000   
25%              2011-04-26 00:00:00      1.55539      0.05233     -1.00000   
50%              2011-09-22 00:00:00      2.03474      0.06149     -0.99997   
75%              2012-02-22 00:00:00      2.72324      0.07113     -0.66594   
max              2012-07-20 00:00:00     15.99144      0.35610     -0.18176   
std                              NaN      1.94428      0.03104      0.22476   

               eta           v0        asian  observed_price  
count 175140.00000 175140.00000 175140.00000    175140.00000  
mean       0.23379      0.03840    199.18290       199.18545  
min        0.11328      0.00756      0.00000         0.00000  
25%        0.14456      0.01722      0.00030         0.02365  
50%        0.18800      0.02356     36.94608        36.94363  
75%        0.24622      0.04209    332.12748       332.11241  
max        1.52882      0.22480    709.43278       709.43492  
std        0.15854      0.03481    249.52058       249.51850  

spot_price                 float64
strike_price               float64
days_to_maturity             int64
n_fixings                  float64
fixing_frequency             int64
past_fixings                 int64
averaging_type              object
w                           object
risk_free_rate             float64
dividend_rate              float64
calculation_date    datetime64[ns]
kappa                      float64
theta                      float64
rho                        float64
eta                        float64
v0                         float64
asian                      float64
observed_price             float64
dtype: object
in sample results:
     RMSE: 2.3146843854051165
     MAE: 1.4193699590572189

out of sample results:
     RMSE: 17.185041971384273
     MAE: 11.140830238577603

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     fixing_frequency
     n_fixings
     past_fixings
     averaging_type
     w

target: observed_price

cpu: 38.44575071334839
Sat Oct 26 19:49:25 2024