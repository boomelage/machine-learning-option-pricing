Wed Oct  9 23:07:12 2024
spot(s):
[1214.91 1228.34 1240.01 1244.81 1251.98 1253.75 1261.75 1263.23 1273.68
 1274.24 1276.84 1279.06 1279.51 1283.57 1285.13 1288.77 1293.41 1298.46
 1304.46 1308.8  1311.13 1314.51 1314.81 1315.19 1317.94 1318.45 1320.45
 1322.21 1322.24 1325.42 1325.9  1326.38 1326.79 1328.62 1329.65 1329.75
 1330.53 1330.91 1331.14 1331.49 1333.24 1333.44 1333.8  1334.79 1335.63
 1336.97 1337.24 1338.18 1338.73 1339.01 1340.15 1340.92 1342.48 1342.83
 1348.8  1348.82 1348.83 1349.69 1349.91 1350.78 1351.52 1352.69 1353.69
 1353.73 1354.63 1354.95 1358.24 1359.88 1360.   1360.03 1360.47 1360.48
 1362.14 1363.84 1365.56 1365.65 1366.54 1367.41 1367.69 1369.22 1369.79
 1370.68 1371.44 1372.41 1372.91 1374.2  1376.17 1376.18 1376.5  1377.07
 1377.59 1377.99 1379.83 1380.11 1380.72 1380.79 1381.38 1385.23 1385.42
 1385.74 1386.77 1386.98 1387.16 1388.04 1388.3  1388.63 1390.08 1390.45
 1390.84 1391.01 1391.18 1391.82 1392.05 1392.46 1394.07 1395.   1395.15
 1396.31 1397.45 1398.   1398.05 1399.4  1399.96 1401.2  1401.5  1401.77
 1402.74 1403.05 1403.12 1403.51 1403.52 1406.48 1406.58 1406.64 1406.77
 1407.53 1408.06 1409.11 1409.14 1409.82 1410.74 1411.59 1412.12 1412.71
 1413.18 1413.53 1413.8  1414.71 1416.12 1416.34 1416.4  1416.59 1416.97
 1418.28 1418.38 1419.95 1420.46 1420.83 1422.42 1422.43 1423.07 1423.24
 1423.8  1424.27 1424.44 1425.15 1426.09 1426.43 1426.6  1428.02 1428.35
 1428.7  1428.81 1430.36 1430.59 1430.69 1431.78 1433.18 1433.19 1433.55
 1433.65 1434.56 1434.69 1436.11 1437.38 1437.45 1438.07 1438.45 1438.91
 1438.99 1439.15 1439.53 1439.88 1439.97 1443.66 1444.24 1444.47 1445.28
 1445.5  1445.71 1446.04 1446.9  1447.03 1447.04 1447.54 1447.77 1447.89
 1448.38 1448.46 1449.6  1449.93 1451.21 1451.23 1451.6  1452.52 1452.78
 1452.95 1452.96 1453.53 1453.85 1454.4  1454.47 1454.78 1455.05 1455.51
 1456.3  1456.93 1457.51 1457.85 1458.35 1459.18 1459.53 1460.37 1462.63
 1462.85 1463.59 1463.78 1466.35 1466.84 1467.25 1467.54 1467.95 1468.23
 1469.04 1469.89 1470.07 1470.62 1471.33 1471.43 1471.49 1471.93 1471.99
 1472.32 1472.58 1472.83 1473.51 1474.26 1475.44 1476.23 1476.68 1476.91
 1477.65 1477.88 1478.45 1479.09 1480.49 1480.57 1481.12 1481.25 1482.47
 1483.7  1484.16 1484.4  1484.51 1484.68 1484.86 1486.09 1486.9  1488.85
 1489.28 1489.55 1491.66 1492.47 1493.24 1494.22 1494.32 1495.27 1496.
 1496.9  1497.37 1497.42 1497.46 1500.66 1501.4  1502.13 1502.3  1502.37
 1503.06 1503.36 1504.31 1505.36 1505.49 1506.   1506.03 1506.09 1506.44
 1507.3  1507.68 1507.84 1507.94 1508.33 1509.13 1510.2  1510.29 1511.77
 1512.26 1512.52 1512.61 1513.95 1514.24 1515.42 1515.75 1515.9  1516.16
 1516.28 1517.65 1517.78 1517.93 1518.08 1518.59 1518.8  1519.26 1519.38
 1519.66 1520.45 1521.61 1522.16 1522.51 1522.95 1523.96 1524.76 1524.84
 1525.35 1525.39 1525.5  1526.61 1528.78 1529.95 1530.14 1530.37 1530.69
 1531.05 1531.08 1531.44 1531.83 1532.93 1533.31 1534.08 1535.14 1536.18
 1538.87 1539.04 1539.62 1539.7  1540.86 1541.15 1542.85 1544.83 1546.47
 1546.48 1547.66 1548.82 1549.07 1549.66 1549.68 1552.26 1552.65 1552.8
 1554.55 1557.09 1561.58 1562.09 1565.18]

strikes:
[1093.419      1098.37781633 1103.33663265 ... 1717.738      1718.299
 1721.698     ]

maturities:
[ 60  90 180 360 540 720]

types:
['call' 'put']

['DownOut' 'DownIn' 'UpOut' 'UpIn']
number of calls, puts:
1881868,1929408

total prices:
3811276
Deep Neural Network
hidden layers sizes: (13, 13, 13)
learning rate: constant
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
         spot_price  strike_price       barrier  days_to_maturity  \
count 3811276.00000 3811276.00000 3811276.00000     3811276.00000   
mean     1434.48475    1433.37479    1434.11500         330.90064   
min      1214.91000    1093.41900     607.45500          60.00000   
25%      1369.79000    1351.71480    1076.13015          90.00000   
50%      1451.60000    1431.28449    1443.07680         360.00000   
75%      1505.49000    1517.83573    1798.64090         540.00000   
max      1565.18000    1721.69800    2347.77000         720.00000   
std        80.28768     116.11119     450.91654         241.62322   

       barrier_price        rebate  dividend_rate  risk_free_rate  \
count  3811276.00000 3811276.00000  3811276.00000   3811276.00000   
mean        53.84956       0.00000        0.01998         0.04000   
min          0.00000       0.00000        0.01780         0.04000   
25%          2.19542       0.00000        0.01863         0.04000   
50%         31.52177       0.00000        0.01932         0.04000   
75%         93.60806       0.00000        0.02137         0.04000   
max        293.09806       0.00000        0.02406         0.04000   
std         58.17597       0.00000        0.00154         0.00000   

              theta         kappa           rho           eta            v0  \
count 3811276.00000 3811276.00000 3811276.00000 3811276.00000 3811276.00000   
mean        0.04795       2.17726      -0.95864       0.20148       0.04030   
min         0.01992       0.03970      -1.00000       0.08818       0.00524   
25%         0.03818       1.13071      -1.00000       0.15274       0.02388   
50%         0.05244       1.75118      -1.00000       0.17849       0.03853   
75%         0.05672       2.44837      -1.00000       0.20514       0.05468   
max         0.40505      12.32603      -0.27661       1.45769       0.13501   
std         0.01501       1.76034       0.13497       0.13509       0.02047   

                    calculation_date                expiration_date  \
count                        3811276                        3811276   
mean   2007-11-19 13:17:28.894700544  2008-10-15 10:54:24.471426048   
min              2007-01-03 00:00:00            2007-03-04 00:00:00   
25%              2007-07-31 00:00:00            2008-03-12 00:00:00   
50%              2007-11-16 00:00:00            2008-09-10 00:00:00   
75%              2008-03-18 00:00:00            2009-05-19 00:00:00   
max              2008-07-15 00:00:00            2010-07-05 00:00:00   
std                              NaN                            NaN   

          moneyness  observed_price  
count 3811276.00000   3811276.00000  
mean        3.58299        53.85680  
min        -0.96515         0.00000  
25%        -0.78587         2.20033  
50%        -0.42968        31.51731  
75%         3.36531        93.61327  
max        27.69497       293.28851  
std         7.07662        58.16960  
#############
# test data #
#############
        spot_price  strike_price      barrier  days_to_maturity  \
count 985257.00000  985257.00000 985257.00000      985257.00000   
mean    1189.34484    1188.82047   1190.32292         327.82854   
min      849.89000     764.90100    424.94500          60.00000   
25%     1187.40000    1133.68514    872.20185          90.00000   
50%     1248.97000    1217.56957   1202.44410         360.00000   
75%     1274.77000    1295.50302   1472.21603         540.00000   
max     1305.09000    1435.59900   1957.63500         720.00000   
std      129.47383     146.94312    393.30810         241.40341   

       barrier_price       rebate  dividend_rate  risk_free_rate        theta  \
count   985257.00000 985257.00000   985257.00000    985257.00000 985257.00000   
mean        55.55183      0.00000        0.02462         0.04000      0.07068   
min          0.00000      0.00000        0.02227         0.04000      0.05139   
25%          4.84779      0.00000        0.02275         0.04000      0.05631   
50%         37.48954      0.00000        0.02329         0.04000      0.05984   
75%         96.48149      0.00000        0.02411         0.04000      0.06438   
max        248.35434      0.00000        0.03355         0.04000      0.14394   
std         55.99921      0.00000        0.00304         0.00000      0.02627   

             kappa          rho          eta           v0  \
count 985257.00000 985257.00000 985257.00000 985257.00000   
mean       4.02022     -0.86333      0.33630      0.10608   
min        0.67288     -1.00000      0.15083      0.02683   
25%        1.96304     -1.00000      0.16720      0.03950   
50%        2.76426     -1.00000      0.23100      0.05257   
75%        4.16711     -0.73762      0.32899      0.14256   
max       11.87783     -0.24433      1.52388      0.37980   
std        2.98735      0.23359      0.29492      0.09413   

                    calculation_date                expiration_date  \
count                         985257                         985257   
mean   2008-09-09 22:19:01.826751232  2009-08-03 18:12:07.346469120   
min              2008-07-16 00:00:00            2008-09-14 00:00:00   
25%              2008-08-14 00:00:00            2008-12-19 00:00:00   
50%              2008-09-08 00:00:00            2009-07-13 00:00:00   
75%              2008-09-24 00:00:00            2010-03-03 00:00:00   
max              2008-11-28 00:00:00            2010-11-18 00:00:00   
std                              NaN                            NaN   

         moneyness  observed_price  
count 985257.00000    985257.00000  
mean       2.92228        55.55740  
min       -0.95821         0.00000  
25%       -0.76777         4.85153  
50%       -0.16330        37.48424  
75%        2.79539        96.47768  
max       22.92665       248.52335  
std        5.94327        55.99406  

spot_price                  float64
strike_price                float64
barrier                     float64
days_to_maturity              int64
barrier_price               float64
updown                       object
outin                        object
w                            object
barrier_type_name            object
rebate                      float64
dividend_rate               float64
risk_free_rate              float64
theta                       float64
kappa                       float64
rho                         float64
eta                         float64
v0                          float64
calculation_date     datetime64[ns]
expiration_date      datetime64[ns]
moneyness                   float64
observed_price              float64
dtype: object
in sample results:
     RMSE: 4.606804770158888
     MAE: 3.199946642395187

out of sample results:
     RMSE: 21.051425683501936
     MAE: 10.61625113783416

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     barrier
     barrier_type_name
     w

target: observed_price

cpu: 251.74322628974915
Wed Oct  9 23:11:23 2024