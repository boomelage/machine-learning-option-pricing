Sat Oct 19 16:46:06 2024
spot(s):
[540.36 546.41 548.79 549.61 550.95 552.08 554.42 558.3  558.35 559.09
 561.4  562.01 562.84 563.07 563.68 567.8  567.82 568.25 568.62 568.86
 569.67 570.04 570.98 571.3  571.47 572.3  572.98 573.17 573.76 576.13
 577.14 579.58 579.78 582.3  582.35 584.32]

strikes:
[270 273 274 275 276 277 279 280 281 283 284 285 286 288 289 291 292 405
 409 411 412 413 414 415 418 419 421 422 425 426 427 428 429 430 432 434
 436 438 540 546 548 549 550 552 554 558 559 561 562 563 567 568 569 570
 571 572 573 576 577 579 582 584 675 683 685 687 688 690 693 697 698 701
 702 703 704 709 710 711 712 713 714 715 716 717 720 721 724 727 730 810
 819 823 824 826 828 831 837 838 842 843 844 845 851 852 853 854 855 856
 857 858 859 860 864 865 869 873 876]

maturities:
[ 30 300]

types:
['call' 'put']

averaging_type:
['arithmetic' 'geometric']

fixing_frequency:
[30]

past_fixings:
[0]

n_fixings:
[ 1  5 10]

number of calls, puts:
720,720

total prices:
1440
Deep Neural Network
hidden layers sizes: (15, 15, 15)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
       spot_price  strike_price  risk_free_rate  dividend_rate  \
count  1440.00000    1440.00000      1440.00000     1440.00000   
mean    566.11056     565.63333         0.04000        0.00000   
min     540.36000     270.00000         0.04000        0.00000   
25%     558.90500     418.75000         0.04000        0.00000   
50%     568.43500     568.00000         0.04000        0.00000   
75%     573.02750     716.00000         0.04000        0.00000   
max     584.32000     876.00000         0.04000        0.00000   
std      10.79915     200.53826         0.00000        0.00000   

       fixing_frequency  n_fixings  past_fixings      kappa      theta  \
count        1440.00000 1440.00000    1440.00000 1440.00000 1440.00000   
mean           30.00000    5.50000       0.00000    4.31247    0.61756   
min            30.00000    1.00000       0.00000    0.00246    0.03353   
25%            30.00000    1.00000       0.00000    1.80665    0.04973   
50%            30.00000    5.50000       0.00000    3.06496    0.05200   
75%            30.00000   10.00000       0.00000    6.89828    0.06910   
max            30.00000   10.00000       0.00000   12.42279   15.41199   
std             0.00000    4.50156       0.00000    3.44003    2.60135   

             rho        eta         v0     calculation_date  days_to_maturity  \
count 1440.00000 1440.00000 1440.00000                 1440        1440.00000   
mean    -0.73545    2.19199    0.03081  2024-09-22 18:00:00         165.00000   
min     -0.98127    0.80065    0.01068  2024-08-28 00:00:00          30.00000   
25%     -0.76503    1.34532    0.02068  2024-09-10 18:00:00          30.00000   
50%     -0.73239    1.79007    0.03137  2024-09-23 12:00:00         165.00000   
75%     -0.68618    2.86286    0.03872  2024-10-04 18:00:00         300.00000   
max     -0.61937    4.66356    0.05040  2024-10-17 00:00:00         300.00000   
std      0.06767    1.08452    0.01072                  NaN         135.04690   

       asian_price    vanilla  difference  moneyness  observed_price  
count   1440.00000 1440.00000  1440.00000 1440.00000      1440.00000  
mean      67.44213   88.80456    21.36242    0.08023        67.47297  
min        0.00000    0.00000   -10.65225   -0.50160         0.00000  
25%        0.00000    0.49906     0.00015   -0.25091         0.03690  
50%        1.61209   18.30606     1.27676    0.00000         1.57335  
75%      141.20831  149.75680    10.55977    0.33495       141.20166  
max      292.73809  303.22674   286.91581    1.00643       292.79151  
std      103.01500  108.81169    62.24069    0.42790       103.00304  
#############
# test data #
#############
       spot_price  strike_price  risk_free_rate  dividend_rate  \
count   720.00000     720.00000       720.00000      720.00000   
mean    566.11056     565.63333         0.04000        0.00000   
min     540.36000     270.00000         0.04000        0.00000   
25%     558.90500     418.75000         0.04000        0.00000   
50%     568.43500     568.00000         0.04000        0.00000   
75%     573.02750     716.00000         0.04000        0.00000   
max     584.32000     876.00000         0.04000        0.00000   
std      10.80291     200.60797         0.00000        0.00000   

       fixing_frequency  n_fixings  past_fixings     kappa     theta  \
count         720.00000  720.00000     720.00000 720.00000 720.00000   
mean           30.00000    5.00000       0.00000   4.31247   0.61756   
min            30.00000    5.00000       0.00000   0.00246   0.03353   
25%            30.00000    5.00000       0.00000   1.80665   0.04973   
50%            30.00000    5.00000       0.00000   3.06496   0.05200   
75%            30.00000    5.00000       0.00000   6.89828   0.06910   
max            30.00000    5.00000       0.00000  12.42279  15.41199   
std             0.00000    0.00000       0.00000   3.44122   2.60226   

            rho       eta        v0     calculation_date  days_to_maturity  \
count 720.00000 720.00000 720.00000                  720         720.00000   
mean   -0.73545   2.19199   0.03081  2024-09-22 18:00:00         150.00000   
min    -0.98127   0.80065   0.01068  2024-08-28 00:00:00         150.00000   
25%    -0.76503   1.34532   0.02068  2024-09-10 18:00:00         150.00000   
50%    -0.73239   1.79007   0.03137  2024-09-23 12:00:00         150.00000   
75%    -0.68618   2.86286   0.03872  2024-10-04 18:00:00         150.00000   
max    -0.61937   4.66356   0.05040  2024-10-17 00:00:00         150.00000   
std     0.06769   1.08489   0.01073                  NaN           0.00000   

       asian_price   vanilla  difference  moneyness  observed_price  
count    720.00000 720.00000   720.00000  720.00000       720.00000  
mean      86.31982  88.79626     2.47644    0.08023        86.33363  
min        0.00000   0.00000    -5.40589   -0.50160         0.00000  
25%        0.02238   0.48450     0.01514   -0.25091         0.13512  
50%       13.51227  22.38876     1.18842    0.00000        13.46922  
75%      145.37630 152.64027     6.61824    0.33495       145.31115  
max      292.61274 297.56505    12.93469    1.00643       292.43360  
std      109.64456 108.59602     5.01421    0.42805       109.62898  

spot_price                 float64
strike_price                 int64
risk_free_rate             float64
dividend_rate              float64
w                           object
averaging_type              object
fixing_frequency             int64
n_fixings                    int64
past_fixings                 int64
kappa                      float64
theta                      float64
rho                        float64
eta                        float64
v0                         float64
calculation_date    datetime64[ns]
days_to_maturity             int64
asian_price                float64
vanilla                    float64
difference                 float64
moneyness                  float64
observed_price             float64
dtype: object
in sample results:
     RMSE: 29.866946785070084
     MAE: 16.041160065959048

out of sample results:
     RMSE: 47.86525658839923
     MAE: 26.060682940776704

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     fixing_frequency
     n_fixings
     past_fixings
     averaging_type
     w

target: observed_price

cpu: 71.12141704559326
Sat Oct 19 16:47:17 2024