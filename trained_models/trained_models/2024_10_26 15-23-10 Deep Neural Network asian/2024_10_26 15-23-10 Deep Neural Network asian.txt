Sat Oct 26 15:22:55 2024
spot(s):
[2220.97  2325.825 2334.81  2433.31  2446.94  2450.31  2466.19  2511.695
 2524.185 2532.715 2568.555 2588.81  2590.59  2604.505 2620.51  2644.93
 2686.535 2740.755 2745.55  2750.555 2766.225 2784.75  2784.785 2792.26
 2795.005 2803.245 2809.055 2810.37  2830.04  2831.37  2838.21  2841.09
 2842.74  2844.59  2848.99  2851.875 2857.95  2861.93  2871.88  2876.59
 2878.075 2881.25  2884.095 2887.515 2906.94  2928.635 2937.055 2937.76
 2947.665 2950.38  2953.185 2955.03  2965.895 2974.095 2994.795 3009.645
 3015.925 3023.665 3027.41  3039.11  3046.88  3111.95  3125.465 3129.67
 3223.935 3233.84  3237.465 3240.77  3241.11  3247.445 3250.84  3251.865
 3262.91  3263.23  3272.02  3277.46  3279.735 3281.205 3283.415 3284.03
 3284.1   3288.365 3300.58  3313.15  3321.755 3321.95  3324.29  3324.81
 3330.825 3331.73  3334.45  3344.95  3346.525 3360.335 3371.355 3372.74
 3373.145 3375.03  3379.27  3387.475]

strikes:
[1110.   1162.   1167.   1216.   1223.   1225.   1233.   1255.   1262.
 1266.   1284.   1294.   1295.   1302.   1310.   1322.   1343.   1370.
 1372.   1375.   1383.   1392.   1396.   1397.   1401.   1404.   1405.
 1415.   1419.   1420.   1421.   1422.   1424.   1425.   1428.   1430.
 1435.   1438.   1439.   1440.   1442.   1443.   1453.   1464.   1468.
 1473.   1475.   1476.   1477.   1482.   1487.   1497.   1504.   1507.
 1511.   1513.   1519.   1523.   1555.   1562.   1564.   1611.   1616.
 1618.   1620.   1623.   1625.   1631.   1636.   1638.   1639.   1640.
 1641.   1642.   1644.   1650.   1656.   1660.   1662.   1665.   1665.25
 1667.   1672.   1673.   1680.   1685.   1686.   1687.   1689.   1693.
 1743.5  1750.75 1824.25 1834.75 1837.5  1849.5  1883.   1893.   1899.25
 1926.   1941.25 1942.5  1953.   1965.   1983.25 2014.5  2055.25 2058.5
 2062.5  2074.5  2088.25 2094.   2095.75 2101.75 2106.25 2107.5  2122.5
 2123.   2128.5  2130.25 2131.75 2133.   2136.25 2138.   2142.5  2145.5
 2153.   2157.   2158.5  2160.25 2163.   2165.   2179.75 2196.   2202.25
 2202.5  2210.   2212.5  2214.25 2215.75 2220.5  2223.5  2230.5  2245.75
 2256.5  2261.   2267.   2270.   2278.75 2284.75 2325.   2333.   2334.5
 2343.5  2346.5  2417.   2424.5  2427.5  2430.25 2432.5  2435.   2437.75
 2438.   2446.5  2446.75 2450.   2454.   2457.5  2459.   2460.25 2462.
 2463.   2466.   2475.   2484.25 2490.5  2493.   2493.25 2497.75 2498.
 2500.5  2508.25 2509.5  2511.   2520.   2524.   2528.   2529.25 2530.75
 2532.5  2533.75 2540.   2568.   2588.5  2590.   2604.   2620.   2644.5
 2686.   2740.5  2745.   2750.   2766.   2775.75 2784.5  2792.   2794.5
 2802.5  2808.5  2810.   2830.   2831.   2838.   2840.5  2842.5  2844.
 2848.5  2851.   2857.   2861.   2871.   2876.   2878.   2880.5  2884.
 2887.   2906.5  2918.25 2928.   2936.5  2937.   2947.   2950.   2952.5
 2954.5  2965.   2974.   2994.5  3009.   3015.   3023.   3027.   3038.5
 3040.75 3046.5  3058.25 3062.5  3082.5  3111.   3125.   3129.   3139.
 3155.   3165.75 3210.   3223.   3233.   3235.75 3237.   3237.5  3240.5
 3247.   3250.5  3251.   3255.   3262.5  3272.   3275.   3277.   3279.
 3280.5  3283.   3284.   3288.   3300.   3305.75 3312.5  3321.   3324.
 3324.5  3330.5  3331.   3334.   3344.5  3346.   3357.5  3360.   3371.
 3372.5  3374.5  3378.5  3387.   3425.75 3431.5  3437.5  3457.5  3480.75
 3488.   3490.   3493.25 3502.   3503.25 3510.75 3512.5  3537.5  3539.
 3547.5  3550.75 3553.25 3555.   3560.75 3564.   3571.5  3576.5  3589.
 3595.   3597.5  3600.75 3605.   3609.   3633.25 3649.   3660.   3670.
 3670.75 3671.5  3675.   3684.   3687.5  3690.75 3693.25 3699.   3706.5
 3717.5  3743.25 3761.5  3767.   3769.   3779.   3784.   3786.   3798.25
 3799.   3808.25 3852.   3883.   3885.   3889.   3906.   3906.5  3911.5
 3930.   3967.   4029.   4041.5  4046.5  4050.75 4059.   4063.25 4064.
 4078.25 4090.   4096.5  4099.   4100.75 4104.   4105.   4110.   4111.
 4118.   4125.   4140.75 4149.   4151.5  4155.   4155.75 4163.25 4164.
 4167.5  4177.   4180.75 4182.5  4188.   4192.   4200.   4204.   4213.
 4214.   4215.   4215.75 4218.25 4223.25 4234.   4245.   4247.   4257.
 4261.   4264.   4266.   4273.   4277.   4286.   4292.   4307.   4314.
 4317.   4321.   4326.   4331.   4360.   4392.   4405.   4406.   4421.
 4425.   4429.   4432.   4448.   4461.   4492.   4514.   4523.   4535.
 4541.   4558.   4570.   4667.   4688.   4694.   4835.   4850.   4856.
 4861.   4871.   4876.   4877.   4894.   4908.   4916.   4919.   4921.
 4925.   4926.   4932.   4950.   4969.   4982.   4986.   4987.   4996.
 4997.   5001.   5017.   5019.   5040.   5057.   5059.   5062.   5068.
 5081.  ]

maturities:
[  1   7  28  84 168 336]

types:
['call' 'put']

averaging_type:
['arithmetic' 'geometric']

fixing_frequency:
[  1   7  28  84 168 336]

past_fixings:
[0]

n_fixings:
[  1.   2.   3.   4.   6.   7.  12.  24.  28.  48.  84. 168. 336.]

number of calls, puts:
21000,21000

total prices:
42000
Deep Neural Network
hidden layers sizes: (15, 15, 15)
learning rate: adaptive
activation: relu
solver: lbfgs
alpha: 0.0001
#################
# training data #
#################
       spot_price  strike_price  days_to_maturity   n_fixings  \
count 42000.00000   42000.00000       42000.00000 42000.00000   
mean   2977.61390    2977.11000         156.71429    35.52381   
min    2220.97000    1110.00000           1.00000     1.00000   
25%    2801.18500    2100.25000          28.00000     1.00000   
50%    2951.78250    2936.75000         168.00000     4.00000   
75%    3273.38000    3893.25000         336.00000    24.00000   
max    3387.47500    5081.00000         336.00000   336.00000   
std     295.66962    1098.47439         126.00684    77.38901   

       fixing_frequency  past_fixings  risk_free_rate  dividend_rate  \
count       42000.00000   42000.00000     42000.00000    42000.00000   
mean           51.28571       0.00000         0.04000        0.00000   
min             1.00000       0.00000         0.04000        0.00000   
25%             1.00000       0.00000         0.04000        0.00000   
50%             7.00000       0.00000         0.04000        0.00000   
75%            84.00000       0.00000         0.04000        0.00000   
max           336.00000       0.00000         0.04000        0.00000   
std            81.26019       0.00000         0.00000        0.00000   

                    calculation_date       kappa       theta         rho  \
count                          42000 42000.00000 42000.00000 42000.00000   
mean   2020-03-15 19:40:48.000000256    14.02983     0.09563    -0.70988   
min              2020-01-02 00:00:00     0.00000     0.02328    -1.00000   
25%              2020-02-06 18:00:00     5.63407     0.03350    -0.77177   
50%              2020-03-17 12:00:00    10.02564     0.08719    -0.71085   
75%              2020-04-22 06:00:00    15.53121     0.14453    -0.65415   
max              2020-05-28 00:00:00    97.62520     0.33396    -0.12427   
std                              NaN    15.16480     0.06493     0.10717   

              eta          v0       asian  observed_price  
count 42000.00000 42000.00000 42000.00000     42000.00000  
mean      5.00482     0.15364   467.50624       467.50742  
min       0.00000     0.00000     0.00000         0.00000  
25%       2.95311     0.01032     1.38571         1.38953  
50%       3.78787     0.07667   102.17468       102.17252  
75%       5.72342     0.17855   810.55297       810.58397  
max      23.81751     0.92894  1768.62694      1768.64554  
std       3.79093     0.21100   576.21462       576.21375  
#############
# test data #
#############
        spot_price  strike_price  days_to_maturity    n_fixings  \
count 196560.00000  196560.00000      196560.00000 196560.00000   
mean    4015.88044    4015.38568         156.71429     35.52381   
min     3019.32000    1509.00000           1.00000      1.00000   
25%     3576.00500    2681.75000          28.00000      1.00000   
50%     4171.05250    3966.75000         168.00000      4.00000   
75%     4440.72500    5238.68750         336.00000     24.00000   
max     4801.65000    7202.00000         336.00000    336.00000   
std      502.27979    1516.49135         126.00567     77.38828   

       fixing_frequency  past_fixings  risk_free_rate  dividend_rate  \
count      196560.00000  196560.00000    196560.00000   196560.00000   
mean           51.28571       0.00000         0.04000        0.00000   
min             1.00000       0.00000         0.04000        0.00000   
25%             1.00000       0.00000         0.04000        0.00000   
50%             7.00000       0.00000         0.04000        0.00000   
75%            84.00000       0.00000         0.04000        0.00000   
max           336.00000       0.00000         0.04000        0.00000   
std            81.25943       0.00000         0.00000        0.00000   

                    calculation_date        kappa        theta          rho  \
count                         196560 196560.00000 196560.00000 196560.00000   
mean   2021-05-02 18:40:00.000000256     16.78643      0.16832     -0.69210   
min              2020-05-29 00:00:00      0.02497      0.04330     -1.00000   
25%              2020-11-11 18:00:00      6.94679      0.06746     -0.73209   
50%              2021-05-03 12:00:00     13.90031      0.08518     -0.68744   
75%              2021-10-19 06:00:00     21.46796      0.11118     -0.63961   
max              2022-04-06 00:00:00    166.51986     13.04739     -0.33386   
std                              NaN     16.75797      0.82600      0.09896   

               eta           v0        asian  observed_price  
count 196560.00000 196560.00000 196560.00000    196560.00000  
mean       7.67863      0.02694    618.73154       618.73257  
min        0.48091      0.00000      0.00000         0.00000  
25%        4.40048      0.00191      1.46152         1.45844  
50%        7.38789      0.01266     99.80135        99.80603  
75%       10.02009      0.03853   1106.05148      1106.05795  
max       52.54234      0.27801   2524.18560      2524.18424  
std        5.02365      0.03747    785.66654       785.66573  

spot_price                 float64
strike_price               float64
days_to_maturity             int64
n_fixings                  float64
fixing_frequency             int64
past_fixings                 int64
averaging_type              object
w                           object
risk_free_rate             float64
dividend_rate              float64
calculation_date    datetime64[ns]
kappa                      float64
theta                      float64
rho                        float64
eta                        float64
v0                         float64
asian                      float64
observed_price             float64
dtype: object
in sample results:
     RMSE: 10.593330688472781
     MAE: 6.042502020317958

out of sample results:
     RMSE: 228.27370631319036
     MAE: 79.0155406592412

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     fixing_frequency
     n_fixings
     past_fixings
     averaging_type
     w

target: observed_price

cpu: 15.486296892166138
Sat Oct 26 15:23:10 2024