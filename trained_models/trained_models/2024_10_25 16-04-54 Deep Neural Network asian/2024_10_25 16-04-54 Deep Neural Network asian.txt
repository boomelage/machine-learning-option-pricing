Fri Oct 25 16:04:35 2024
spot(s):
[2220.97  2325.825 2334.81  2433.31  2446.94  2450.31  2466.19  2511.695
 2524.185 2532.715 2568.555 2588.81  2590.59  2604.505 2620.51  2644.93
 2686.535 2740.755 2745.55  2750.555 2766.225 2784.75  2784.785 2792.26
 2795.005 2803.245 2809.055 2810.37  2830.04  2831.37  2838.21  2841.09
 2842.74  2844.59  2848.99  2851.875 2857.95  2861.93  2871.88  2876.59
 2878.075 2881.25  2884.095 2887.515 2906.94  2928.635 2937.055 2937.76
 2947.665 2950.38  2953.185 2955.03  2965.895 2974.095 2994.795 3009.645
 3015.925 3019.32  3023.665 3023.895 3026.935 3027.41  3038.9   3039.11
 3039.925 3046.88  3054.3   3056.59  3064.8   3067.245 3076.865 3092.635
 3101.52  3107.515 3110.58  3111.46  3111.95  3113.825 3114.415 3124.935
 3125.465 3128.605 3129.67  3136.26  3139.585 3148.635 3154.345 3164.74
 3171.79  3174.23  3179.695 3187.295 3191.12  3205.715 3212.355 3214.39
 3216.51  3223.145 3223.935 3224.945 3227.755 3231.245 3233.84  3234.445
 3237.465 3239.735 3240.77  3241.11  3244.3   3245.39  3247.445 3248.78
 3250.84  3251.865 3253.565 3254.14  3255.475 3258.3   3260.335 3262.91
 3263.23  3265.635 3272.02  3273.97  3277.46  3279.735 3281.205 3283.415
 3284.03  3284.1   3288.365 3291.44  3293.61  3297.35  3299.115 3299.225
 3300.58  3313.15  3316.435 3321.755 3321.95  3322.865 3323.235 3323.75
 3324.29  3324.81  3330.825 3331.73  3334.45  3338.495 3342.54  3343.33
 3344.95  3346.23  3346.525 3348.28  3348.94  3349.045 3352.31  3354.685
 3356.91  3357.465 3360.015 3360.335 3365.985 3367.74  3371.29  3371.355
 3372.74  3373.145 3374.55  3375.03  3379.055 3379.27  3382.    3383.99
 3384.95  3387.475 3389.385 3391.535 3391.565 3392.065 3393.005 3395.265
 3395.495 3400.265 3405.205 3411.065 3421.    3426.245 3429.98  3430.33
 3441.81  3442.59  3444.7   3445.58  3447.405 3455.78  3456.785 3462.71
 3472.865 3475.37  3486.975 3492.045 3492.255 3497.675 3507.335 3508.34
 3508.58  3515.845 3520.9   3522.275 3525.805 3538.195 3550.035 3568.49
 3569.405 3578.205 3580.94  3583.465 3585.    3588.33  3592.175 3609.065
 3616.965 3618.955 3631.65  3631.98  3634.315 3649.27  3660.595 3661.97
 3665.715 3669.47  3671.185 3673.265 3683.42  3685.06  3687.045 3690.35
 3695.035 3695.555 3697.67  3702.45  3704.9   3706.95  3719.735 3732.485
 3734.465 3736.685]

strikes:
[1110. 1162. 1167. ... 5598. 5601. 5605.]

maturities:
[  1   7  28  84 168 336]

types:
['call' 'put']

averaging_type:
['arithmetic' 'geometric']

fixing_frequency:
[  1   7  28  84 168 336]

past_fixings:
[0]

n_fixings:
[  1.   2.   3.   4.   6.   7.  12.  24.  28.  48.  84. 168. 336.]

number of calls, puts:
52500,52500

total prices:
105000
Deep Neural Network
hidden layers sizes: (15, 15, 15)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
        spot_price  strike_price  days_to_maturity    n_fixings  \
count 105000.00000  105000.00000      105000.00000 105000.00000   
mean    3221.77914    3221.27400         156.71429     35.52381   
min     2220.97000    1110.00000           1.00000      1.00000   
25%     3038.90000    2270.00000          28.00000      1.00000   
50%     3278.59750    3249.50000         168.00000      4.00000   
75%     3411.06500    4200.00000         336.00000     24.00000   
max     3736.68500    5605.00000         336.00000    336.00000   
std      312.41234    1186.29610         126.00594     77.38846   

       fixing_frequency  past_fixings  risk_free_rate  dividend_rate  \
count      105000.00000  105000.00000    105000.00000   105000.00000   
mean           51.28571       0.00000         0.04000        0.00000   
min             1.00000       0.00000         0.04000        0.00000   
25%             1.00000       0.00000         0.04000        0.00000   
50%             7.00000       0.00000         0.04000        0.00000   
75%            84.00000       0.00000         0.04000        0.00000   
max           336.00000       0.00000         0.04000        0.00000   
std            81.25961       0.00000         0.00000        0.00000   

                 calculation_date        kappa        theta          rho  \
count                      105000 105000.00000 105000.00000 105000.00000   
mean   2020-07-02 16:30:43.200000     17.06051      0.15010     -0.68315   
min           2020-01-02 00:00:00      0.00000      0.02328     -1.00000   
25%           2020-04-03 00:00:00      5.75006      0.07406     -0.72697   
50%           2020-07-04 00:00:00     11.61557      0.10110     -0.67002   
75%           2020-10-01 00:00:00     22.24804      0.12929     -0.61205   
max           2020-12-30 00:00:00    166.51986      8.58105     -0.12427   
std                           NaN     18.46461      0.57579      0.12084   

               eta           v0        asian  observed_price  
count 105000.00000 105000.00000 105000.00000    105000.00000  
mean       6.56740      0.08370    502.64987       502.65090  
min        0.00000      0.00000      0.00000         0.00000  
25%        3.26564      0.00847      1.62206         1.62110  
50%        5.13618      0.03107    102.25855       102.26335  
75%        8.66905      0.08324    860.37506       860.38464  
max       41.39698      0.92894   1969.11272      1969.14301  
std        5.25574      0.14972    624.40680       624.40596  
#############
# test data #
#############
        spot_price  strike_price  days_to_maturity    n_fixings  \
count 133560.00000  133560.00000      133560.00000 133560.00000   
mean    4313.67500    4313.18553         156.71429     35.52381   
min     3700.67000    1850.00000           1.00000      1.00000   
25%     4160.82500    3120.25000          28.00000      1.00000   
50%     4361.49250    4361.00000         168.00000      4.00000   
75%     4521.34000    5639.00000         336.00000     24.00000   
max     4801.65000    7202.00000         336.00000    336.00000   
std      276.77635    1553.11456         126.00582     77.38838   

       fixing_frequency  past_fixings  risk_free_rate  dividend_rate  \
count      133560.00000  133560.00000    133560.00000   133560.00000   
mean           51.28571       0.00000         0.04000        0.00000   
min             1.00000       0.00000         0.04000        0.00000   
25%             1.00000       0.00000         0.04000        0.00000   
50%             7.00000       0.00000         0.04000        0.00000   
75%            84.00000       0.00000         0.04000        0.00000   
max           336.00000       0.00000         0.04000        0.00000   
std            81.25953       0.00000         0.00000        0.00000   

                    calculation_date        kappa        theta          rho  \
count                         133560 133560.00000 133560.00000 133560.00000   
mean   2021-08-19 23:32:49.811320832     15.70410      0.15978     -0.70473   
min              2020-12-31 00:00:00      0.02807      0.04330     -1.00000   
25%              2021-04-27 00:00:00      7.43095      0.06437     -0.73933   
50%              2021-08-19 12:00:00     13.69642      0.07569     -0.70008   
75%              2021-12-13 00:00:00     20.30627      0.09856     -0.66328   
max              2022-04-06 00:00:00    138.40920     13.04739     -0.46624   
std                              NaN     14.78979      0.86378      0.08013   

               eta           v0        asian  observed_price  
count 133560.00000 133560.00000 133560.00000    133560.00000  
mean       7.71142      0.02215    662.43559       662.43648  
min        0.50144      0.00000      0.00000         0.00000  
25%        4.88014      0.00077      1.33304         1.33460  
50%        7.68742      0.01034     98.64774        98.61663  
75%       10.03827      0.03011   1136.18115      1136.18098  
max       52.54234      0.16352   2524.18560      2524.20969  
std        4.60662      0.03059    837.27196       837.27112  

spot_price                 float64
strike_price               float64
days_to_maturity             int64
n_fixings                  float64
fixing_frequency             int64
past_fixings                 int64
averaging_type              object
w                           object
risk_free_rate             float64
dividend_rate              float64
calculation_date    datetime64[ns]
kappa                      float64
theta                      float64
rho                        float64
eta                        float64
v0                         float64
asian                      float64
observed_price             float64
dtype: object
in sample results:
     RMSE: 30.973343751128656
     MAE: 19.882322271534022

out of sample results:
     RMSE: 124.66442564641069
     MAE: 83.81701313631716

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     fixing_frequency
     n_fixings
     past_fixings
     averaging_type
     w

target: observed_price

cpu: 19.163334369659424
Fri Oct 25 16:04:54 2024