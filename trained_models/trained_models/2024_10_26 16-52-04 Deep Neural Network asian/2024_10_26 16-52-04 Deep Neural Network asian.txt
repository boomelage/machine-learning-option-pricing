Sat Oct 26 16:51:15 2024
spot(s):
[1274.24 1276.84 1288.77 1293.41 1298.46 1304.46 1308.8  1311.13 1314.81
 1315.19 1320.45 1322.21 1325.42 1325.9  1326.38 1326.79 1328.62 1329.65
 1329.75 1330.53 1330.91 1331.14 1331.49 1333.24 1333.44 1333.8  1334.79
 1336.97 1337.24 1338.73 1339.01 1340.92 1342.48 1348.8  1348.82 1348.83
 1349.69 1349.91 1351.52 1352.69 1353.69 1353.73 1354.63 1354.95 1360.03
 1360.47 1362.14 1363.84 1365.56 1365.65 1366.54 1367.41 1367.69 1369.22
 1369.79 1370.68 1371.44 1372.41 1372.91 1374.2  1376.18 1376.5  1377.99
 1379.83 1380.11 1380.72 1380.79 1381.38 1385.23 1386.77 1386.98 1387.16
 1388.04 1388.3  1388.63 1390.08 1390.45 1390.84 1391.18 1391.82 1392.05
 1392.46 1394.07 1395.   1395.15 1396.31 1397.45 1398.   1399.96 1401.2
 1401.5  1401.77 1402.74 1403.05 1403.12 1403.51 1406.48 1406.58 1406.64
 1406.77 1407.53 1408.06 1409.11 1409.14 1409.82 1410.74 1411.59 1412.12
 1412.71 1413.18 1413.53 1413.8  1414.71 1416.12 1416.34 1416.4  1416.59
 1416.97 1418.28 1418.38 1419.95 1420.46 1420.83 1422.42 1422.43 1423.07
 1423.24 1423.8  1424.27 1424.44 1425.15 1426.09 1426.43 1426.6  1428.02
 1428.35 1428.7  1428.81 1430.36 1430.59 1430.69 1431.78 1433.18 1433.19
 1433.55 1433.65 1434.56 1434.69 1436.11 1437.38 1437.45 1438.07 1438.45
 1438.91 1438.99 1439.15 1439.53 1439.88 1439.97 1443.66 1444.24 1444.47
 1445.28 1445.5  1445.71 1446.04 1446.9  1447.03 1447.04 1447.54 1447.77
 1447.89 1448.38 1448.46 1449.6  1449.93 1451.21 1451.23 1451.6  1452.52
 1452.78 1452.95 1452.96 1453.53 1453.85 1454.4  1454.47 1454.78 1455.05
 1455.51 1456.3  1456.93 1457.51 1457.85 1458.35 1459.18 1459.53 1460.37
 1462.63 1462.85 1463.59 1463.78 1466.35 1466.84 1467.25 1467.54 1467.95
 1468.23 1469.04 1469.89 1470.07 1470.62 1471.33 1471.43 1471.49 1471.93
 1471.99 1472.32 1472.58 1472.83 1473.51 1474.26 1475.44 1476.23 1476.68
 1476.91 1477.65 1477.88 1478.45 1479.09 1480.49 1480.57 1481.12 1481.25
 1482.47 1483.7  1484.16 1484.4  1484.51 1484.68 1484.86 1486.09 1486.9
 1488.85 1489.28 1489.55 1491.66 1492.47 1493.24 1494.22 1494.32 1495.27
 1496.   1496.9  1497.37 1497.42 1497.46 1500.66 1501.4  1502.13 1502.3
 1502.37 1503.06 1503.36 1504.31 1505.36 1505.49 1506.   1506.03 1506.09
 1506.44 1507.3  1507.68 1507.84 1507.94 1508.33 1509.13 1510.2  1510.29
 1511.77 1512.26 1512.52 1512.61 1513.95 1514.24 1515.42 1515.75 1515.9
 1516.16 1516.28 1517.65 1517.78 1517.93 1518.08 1518.59 1518.8  1519.26
 1519.38 1519.66 1520.45 1521.61 1522.16 1522.51 1522.95 1523.96 1524.76
 1524.84 1525.35 1525.39 1525.5  1526.61 1528.78 1529.95 1530.14 1530.37
 1530.69 1531.05 1531.08 1531.44 1531.83 1532.93 1533.31 1534.08 1535.14
 1536.18 1538.87 1539.04 1539.62 1539.7  1540.86 1541.15 1542.85 1544.83
 1546.47 1546.48 1547.66 1548.82 1549.07 1549.66 1549.68 1552.26 1552.65
 1552.8  1554.55 1557.09 1561.58 1562.09 1565.18]

strikes:
[ 637.  638.  644. ... 2342. 2343. 2347.]

maturities:
[  1   7  28  84 168 336]

types:
['call' 'put']

averaging_type:
['arithmetic' 'geometric']

fixing_frequency:
[  1   7  28  84 168 336]

past_fixings:
[0]

n_fixings:
[  1.   2.   3.   4.   6.   7.  12.  24.  28.  48.  84. 168. 336.]

number of calls, puts:
73500,73500

total prices:
147000
Deep Neural Network
hidden layers sizes: (15, 15, 15)
learning rate: adaptive
activation: relu
solver: lbfgs
alpha: 0.0001
#################
# training data #
#################
        spot_price  strike_price  days_to_maturity    n_fixings  \
count 147000.00000  147000.00000      147000.00000 147000.00000   
mean    1445.15343    1444.66857         156.71429     35.52381   
min     1274.24000     637.00000           1.00000      1.00000   
25%     1398.00000    1048.50000          28.00000      1.00000   
50%     1449.03000    1448.50000         168.00000      4.00000   
75%     1502.37000    1877.50000         336.00000     24.00000   
max     1565.18000    2347.00000         336.00000    336.00000   
std       66.49209     515.78253         126.00577     77.38835   

       fixing_frequency  past_fixings  risk_free_rate  dividend_rate  \
count      147000.00000  147000.00000    147000.00000   147000.00000   
mean           51.28571       0.00000         0.04000        0.01953   
min             1.00000       0.00000         0.04000        0.01780   
25%             1.00000       0.00000         0.04000        0.01852   
50%             7.00000       0.00000         0.04000        0.01912   
75%            84.00000       0.00000         0.04000        0.02057   
max           336.00000       0.00000         0.04000        0.02308   
std            81.25950       0.00000         0.00000        0.00134   

                    calculation_date        kappa        theta          rho  \
count                         147000 147000.00000 147000.00000 147000.00000   
mean   2007-09-12 18:55:32.571428608      2.07053      0.04516     -0.94432   
min              2007-01-03 00:00:00      0.03970      0.01992     -1.00000   
25%              2007-05-09 00:00:00      1.00453      0.03024     -1.00000   
50%              2007-09-12 12:00:00      1.67230      0.04681     -1.00000   
75%              2008-01-17 00:00:00      2.31303      0.05637     -1.00000   
max              2008-05-22 00:00:00     12.32603      0.40505     -0.27661   
std                              NaN      1.85074      0.02422      0.14752   

               eta           v0        asian  observed_price  
count 147000.00000 147000.00000 147000.00000    147000.00000  
mean       0.19056      0.03450    221.51797       221.52079  
min        0.08818      0.00524      0.00000         0.00000  
25%        0.12298      0.01493      0.00000         0.01772  
50%        0.16765      0.03026     36.59853        36.60162  
75%        0.20035      0.05077    370.48638       370.48104  
max        1.45769      0.13501    784.81506       784.83755  
std        0.13774      0.02203    279.25466       279.25247  
#############
# test data #
#############
        spot_price  strike_price  days_to_maturity    n_fixings  \
count 395640.00000  395640.00000      395640.00000 395640.00000   
mean    1126.69528    1126.18843         156.71429     35.52381   
min      676.03000     338.00000           1.00000      1.00000   
25%     1030.49000     755.00000          28.00000      1.00000   
50%     1147.98500    1098.75000         168.00000      4.00000   
75%     1264.76000    1462.00000         336.00000     24.00000   
max     1403.52000    2105.00000         336.00000    336.00000   
std      163.30420     434.37799         126.00550     77.38819   

       fixing_frequency  past_fixings  risk_free_rate  dividend_rate  \
count      395640.00000  395640.00000    395640.00000   395640.00000   
mean           51.28571       0.00000         0.04000        0.02285   
min             1.00000       0.00000         0.04000        0.01791   
25%             1.00000       0.00000         0.04000        0.02017   
50%             7.00000       0.00000         0.04000        0.02153   
75%            84.00000       0.00000         0.04000        0.02345   
max           336.00000       0.00000         0.04000        0.03773   
std            81.25933       0.00000         0.00000        0.00409   

                    calculation_date        kappa        theta          rho  \
count                         395640 395640.00000 395640.00000 395640.00000   
mean   2010-04-05 17:11:50.828025600      3.81920      0.07680     -0.88977   
min              2008-05-23 00:00:00      0.09804      0.03784     -1.00000   
25%              2009-04-30 00:00:00      2.09887      0.05543     -1.00000   
50%              2010-04-07 12:00:00      3.43235      0.06792     -0.99983   
75%              2011-03-14 00:00:00      5.01541      0.08188     -0.83425   
max              2012-02-16 00:00:00     15.99144      0.35610     -0.18176   
std                              NaN      2.18236      0.03427      0.17247   

               eta           v0        asian  observed_price  
count 395640.00000 395640.00000 395640.00000    395640.00000  
mean       0.23099      0.07203    175.78166       175.78391  
min        0.11096      0.00756      0.00000         0.00000  
25%        0.17135      0.02401      0.01017         0.03573  
50%        0.19582      0.03966     39.28925        39.28813  
75%        0.24245      0.08004    311.21016       311.21477  
max        1.52882      0.69402    702.47266       702.52514  
std        0.13382      0.08850    219.68963       219.68779  

spot_price                 float64
strike_price               float64
days_to_maturity             int64
n_fixings                  float64
fixing_frequency             int64
past_fixings                 int64
averaging_type              object
w                           object
risk_free_rate             float64
dividend_rate              float64
calculation_date    datetime64[ns]
kappa                      float64
theta                      float64
rho                        float64
eta                        float64
v0                         float64
asian                      float64
observed_price             float64
dtype: object
in sample results:
     RMSE: 2.443187188929837
     MAE: 1.4074021243460675

out of sample results:
     RMSE: 14.672407775835975
     MAE: 6.51925372902654

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     fixing_frequency
     n_fixings
     past_fixings
     averaging_type
     w

target: observed_price

cpu: 48.96384906768799
Sat Oct 26 16:52:04 2024