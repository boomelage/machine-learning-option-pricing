Fri Oct 25 12:22:20 2024
spot(s):
[1214.91 1228.34 1235.03 1240.01 1244.81 1245.64 1248.97 1251.98 1253.33
 1253.75 1257.85 1259.82 1260.39 1260.44 1260.47 1261.75 1263.07 1263.23
 1267.3  1273.68 1274.24 1276.78 1276.84 1279.06 1279.51 1281.9  1283.57
 1284.14 1285.13 1288.77 1293.41 1298.46 1304.46 1308.8  1311.13 1314.51
 1314.81 1315.19 1317.94 1318.45 1320.45 1322.21 1322.24 1325.42 1325.9
 1326.38 1326.79 1328.62 1329.65 1329.75 1330.53 1330.91 1331.14 1331.49
 1333.24 1333.44 1333.8  1334.79 1335.63 1336.97 1337.24 1338.18 1338.73
 1339.01 1340.15 1340.92 1342.48 1342.83 1348.8  1348.82 1348.83 1349.69
 1349.91 1350.78 1351.52 1352.69 1353.69 1353.73 1354.63 1354.95 1358.24
 1359.88 1360.   1360.03 1360.47 1360.48 1362.14 1363.84 1365.56 1365.65
 1366.54 1367.41 1367.69 1369.22 1369.79 1370.68 1371.44 1372.41 1372.91
 1374.2  1376.17 1376.18 1376.5  1377.07 1377.59 1377.99 1379.83 1380.11
 1380.72 1380.79 1381.38 1385.23 1385.42 1385.74 1386.77 1386.98 1387.16
 1388.04 1388.3  1388.63 1390.08 1390.45 1390.84 1391.01 1391.18 1391.82
 1392.05 1392.46 1394.07 1395.   1395.15 1396.31 1397.45 1398.   1398.05
 1399.4  1399.96 1401.2  1401.5  1401.77 1402.74 1403.05 1403.12 1403.51
 1403.52 1406.48 1406.58 1406.64 1406.77 1407.53 1408.06 1409.11 1409.14
 1409.82 1410.74 1411.59 1412.12 1412.71 1413.18 1413.53 1413.8  1414.71
 1416.12 1416.34 1416.4  1416.59 1416.97 1418.28 1418.38 1419.95 1420.46
 1420.83 1422.42 1422.43 1423.07 1423.24 1423.8  1424.27 1424.44 1425.15
 1426.09 1426.43 1426.6  1428.02 1428.35 1428.7  1428.81 1430.36 1430.59
 1430.69 1431.78 1433.18 1433.19 1433.55 1433.65 1434.56 1434.69 1436.11
 1437.38 1437.45 1438.07 1438.45 1438.91 1438.99 1439.15 1439.53 1439.88
 1439.97 1443.66 1444.24 1444.47 1445.28 1445.5  1445.71 1446.04 1446.9
 1447.03 1447.04 1447.54 1447.77 1447.89 1448.38 1448.46 1449.6  1449.93
 1451.21 1451.23 1451.6  1452.52 1452.78 1452.95 1452.96 1453.53 1453.85
 1454.4  1454.47 1454.78 1455.05 1455.51 1456.3  1456.93 1457.51 1457.85
 1458.35 1459.18 1459.53 1460.37 1462.63 1462.85 1463.59 1463.78 1466.35
 1466.84 1467.25 1467.54 1467.95 1468.23 1469.04 1469.89 1470.07 1470.62
 1471.33 1471.43 1471.49 1471.93 1471.99 1472.32 1472.58 1472.83 1473.51
 1474.26 1475.44 1476.23 1476.68 1476.91 1477.65 1477.88 1478.45 1479.09
 1480.49 1480.57 1481.12 1481.25 1482.47 1483.7  1484.16 1484.4  1484.51
 1484.68 1484.86 1486.09 1486.9  1488.85 1489.28 1489.55 1491.66 1492.47
 1493.24 1494.22 1494.32 1495.27 1496.   1496.9  1497.37 1497.42 1497.46
 1500.66 1501.4  1502.13 1502.3  1502.37 1503.06 1503.36 1504.31 1505.36
 1505.49 1506.   1506.03 1506.09 1506.44 1507.3  1507.68 1507.84 1507.94
 1508.33 1509.13 1510.2  1510.29 1511.77 1512.26 1512.52 1512.61 1513.95
 1514.24 1515.42 1515.75 1515.9  1516.16 1516.28 1517.65 1517.78 1517.93
 1518.08 1518.59 1518.8  1519.26 1519.38 1519.66 1520.45 1521.61 1522.16
 1522.51 1522.95 1523.96 1524.76 1524.84 1525.35 1525.39 1525.5  1526.61
 1528.78 1529.95 1530.14 1530.37 1530.69 1531.05 1531.08 1531.44 1531.83
 1532.93 1533.31 1534.08 1535.14 1536.18 1538.87 1539.04 1539.62 1539.7
 1540.86 1541.15 1542.85 1544.83 1546.47 1546.48 1547.66 1548.82 1549.07
 1549.66 1549.68 1552.26 1552.65 1552.8  1554.55 1557.09 1561.58 1562.09
 1565.18]

strikes:
[ 607.  614.  617. ... 2342. 2343. 2347.]

maturities:
[ 7 28 84]

types:
['call' 'put']

averaging_type:
['arithmetic' 'geometric']

fixing_frequency:
[ 7 28 84]

past_fixings:
[0]

n_fixings:
[ 1.  3.  4. 12.]

number of calls, puts:
36000,36000

total prices:
72000
Deep Neural Network
hidden layers sizes: (15, 15, 15)
learning rate: adaptive
activation: tanh
solver: lbfgs
alpha: 0.0001
#################
# training data #
#################
       spot_price  strike_price  days_to_maturity   n_fixings  \
count 72000.00000   72000.00000       72000.00000 72000.00000   
mean   1427.73495    1427.24875          48.22222     2.77778   
min    1214.91000     607.00000           7.00000     1.00000   
25%    1373.87750    1030.18750          28.00000     1.00000   
50%    1437.41500    1437.00000          28.00000     1.00000   
75%    1493.48500    1860.93750          84.00000     3.00000   
max    1565.18000    2347.00000          84.00000    12.00000   
std      79.78609     511.82828          32.90676     3.42470   

       fixing_frequency  past_fixings  risk_free_rate  dividend_rate  \
count       72000.00000   72000.00000     72000.00000    72000.00000   
mean           31.11111       0.00000         0.04000        0.01989   
min             7.00000       0.00000         0.04000        0.01780   
25%             7.00000       0.00000         0.04000        0.01858   
50%            28.00000       0.00000         0.04000        0.01927   
75%            28.00000       0.00000         0.04000        0.02128   
max            84.00000       0.00000         0.04000        0.02406   
std            29.71905       0.00000         0.00000        0.00161   

          calculation_date       kappa       theta         rho         eta  \
count                72000 72000.00000 72000.00000 72000.00000 72000.00000   
mean   2007-10-19 01:44:24     2.07754     0.04641    -0.94833     0.18976   
min    2007-01-03 00:00:00     0.03970     0.01992    -1.00000     0.08818   
25%    2007-05-28 00:00:00     1.04865     0.03273    -1.00000     0.12851   
50%    2007-10-17 12:00:00     1.71629     0.05145    -1.00000     0.16916   
75%    2008-03-12 06:00:00     2.28665     0.05637    -1.00000     0.19866   
max    2008-08-04 00:00:00    12.32603     0.40505    -0.27661     1.45769   
std                    NaN     1.75762     0.02292     0.14234     0.12992   

               v0       asian  observed_price  
count 72000.00000 72000.00000     72000.00000  
mean      0.03574   217.17321       217.17672  
min       0.00524     0.00000         0.00000  
25%       0.01707     0.00000         0.00765  
50%       0.03344    19.31431        19.32076  
75%       0.05060   370.90387       370.92052  
max       0.13501   782.90549       782.88596  
std       0.02124   281.78962       281.78680  
#############
# test data #
#############
        spot_price  strike_price  days_to_maturity    n_fixings  \
count 117360.00000  117360.00000      117360.00000 117360.00000   
mean    1061.05305    1060.54525          48.22222      2.77778   
min      676.03000     338.00000           7.00000      1.00000   
25%      927.03750     691.37500          28.00000      1.00000   
50%     1090.52500    1055.87500          28.00000      1.00000   
75%     1170.11500    1366.50000          84.00000      3.00000   
max     1342.85000    2014.00000          84.00000     12.00000   
std      150.56778     407.71854          32.90667      3.42469   

       fixing_frequency  past_fixings  risk_free_rate  dividend_rate  \
count      117360.00000  117360.00000    117360.00000   117360.00000   
mean           31.11111       0.00000         0.04000        0.02344   
min             7.00000       0.00000         0.04000        0.01791   
25%             7.00000       0.00000         0.04000        0.02009   
50%            28.00000       0.00000         0.04000        0.02152   
75%            28.00000       0.00000         0.04000        0.02519   
max            84.00000       0.00000         0.04000        0.03773   
std            29.71897       0.00000         0.00000        0.00473   

                    calculation_date        kappa        theta          rho  \
count                         117360 117360.00000 117360.00000 117360.00000   
mean   2009-11-19 06:39:45.276073728      4.18487      0.08245     -0.90925   
min              2008-08-05 00:00:00      0.09849      0.03784     -1.00000   
25%              2009-03-29 06:00:00      2.62004      0.06080     -1.00000   
50%              2009-11-17 12:00:00      3.89950      0.07043     -0.99907   
75%              2010-07-14 06:00:00      5.36111      0.08808     -0.85304   
max              2011-03-07 00:00:00     13.25023      0.35610     -0.24433   
std                              NaN      2.08836      0.03572      0.13682   

               eta           v0        asian  observed_price  
count 117360.00000 117360.00000 117360.00000    117360.00000  
mean       0.22056      0.08194    162.54698       162.55025  
min        0.11096      0.00992      0.00000         0.00000  
25%        0.17313      0.02577      0.00000         0.01081  
50%        0.19330      0.04051     19.52019        19.50916  
75%        0.23216      0.09539    291.05885       291.06185  
max        1.52388      0.69402    671.60633       671.62100  
std        0.10813      0.10180    211.51565       211.51314  

spot_price                 float64
strike_price               float64
days_to_maturity             int64
n_fixings                  float64
fixing_frequency             int64
past_fixings                 int64
averaging_type              object
w                           object
risk_free_rate             float64
dividend_rate              float64
calculation_date    datetime64[ns]
kappa                      float64
theta                      float64
rho                        float64
eta                        float64
v0                         float64
asian                      float64
observed_price             float64
dtype: object
in sample results:
     RMSE: 2.473474162106138
     MAE: 1.6090949636569643

out of sample results:
     RMSE: 33.831156387805684
     MAE: 19.29436156457262

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     fixing_frequency
     n_fixings
     past_fixings
     averaging_type
     w

target: observed_price

cpu: 43.33262300491333
Fri Oct 25 12:23:03 2024