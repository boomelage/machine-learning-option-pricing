Fri Oct 11 16:53:56 2024
spot(s):
[ 676.03  682.43  683.09  696.44  701.13  712.8   718.09  720.76  735.18
  743.63  750.18  752.69  753.6   755.88  764.87  768.06  770.19  772.72
  777.66  778.97  783.62  788.25  789.34  793.89  805.28  805.9   813.65
  822.61  825.26  826.08  826.55  827.3   827.32  831.68  832.16  833.74
  835.12  836.44  838.11  840.13  842.82  843.98  845.19  845.22  845.62
  845.68  849.36  849.62  849.89  857.33  863.39  865.    868.15  868.97
  869.08  869.78  870.18  870.82  871.38  871.64  871.84  872.49  873.75
  873.87  876.65  879.73  885.33  887.22  888.94  890.17  890.47  895.24
  898.8   899.16  903.41  904.15  906.79  908.76  909.78  911.39  913.19
  919.06  927.54  930.68  931.03  934.45  952.69 1005.42 1156.65 1165.72
 1187.4  1188.42 1195.66 1203.3  1207.56 1210.16 1213.76 1214.59 1214.91
 1225.07 1228.34 1231.72 1235.03 1236.81 1240.01 1242.38 1244.81 1245.64
 1248.97 1249.51 1251.98 1252.02 1253.1  1253.33 1253.75 1257.85 1259.82
 1260.39 1260.44 1260.47 1261.75 1263.07 1263.23 1266.66 1267.13 1267.3
 1267.4  1267.76 1271.47 1273.68 1274.24 1274.77 1275.25 1276.78 1276.84
 1277.53 1277.54 1279.06 1279.22 1279.51 1281.63 1281.9  1283.32 1283.57
 1284.14 1284.21 1285.13 1285.9  1288.77 1289.26 1289.99 1292.07 1292.95
 1293.41 1295.65 1298.15 1298.46 1299.97 1304.46 1305.09 1308.8  1311.13
 1314.51 1314.81 1315.19 1317.94 1318.45 1320.45 1322.21 1322.24 1325.42
 1325.9  1326.38 1326.79 1328.62 1329.65 1329.75 1330.53 1330.91 1331.14
 1331.49 1333.24 1333.44 1333.8  1334.79 1335.63 1336.97 1337.24 1338.18
 1338.73 1339.01 1340.15 1340.92 1342.48 1342.83 1348.8  1348.82 1348.83
 1349.69 1349.91 1350.78 1351.52 1352.69 1353.69 1353.73 1354.63 1354.95
 1358.24 1359.88 1360.   1360.03 1360.47 1360.48 1362.14 1363.84 1365.56
 1365.65 1366.54 1367.41 1367.69 1369.22 1369.79 1370.68 1371.44 1372.41
 1372.91 1374.2  1376.17 1376.18 1376.5  1377.07 1377.59 1377.99 1379.83
 1380.11 1380.72 1380.79 1381.38 1385.23 1385.42 1385.74 1386.77 1386.98
 1387.16 1388.04 1388.3  1388.63 1390.08 1390.45 1390.84 1391.01 1391.18
 1391.82 1392.05 1392.46 1394.07 1395.   1395.15 1396.31 1397.45 1398.
 1398.05 1399.4  1399.96 1401.2  1401.5  1401.77 1402.74 1403.05 1403.12
 1403.51 1403.52 1406.48 1406.58 1406.64 1406.77 1407.53 1408.06 1409.11
 1409.14 1409.82 1410.74 1411.59 1412.12 1412.71 1413.18 1413.53 1413.8
 1414.71 1416.12 1416.34 1416.4  1416.59 1416.97 1418.28 1418.38 1419.95
 1420.46 1420.83 1422.42 1422.43 1423.07 1423.24 1423.8  1424.27 1424.44
 1425.15 1426.09 1426.43 1426.6  1428.02 1428.35 1428.7  1428.81 1430.36
 1430.59 1430.69 1431.78 1433.18 1433.19 1433.55 1433.65 1434.56 1434.69
 1436.11 1437.38 1437.45 1438.07 1438.45 1438.91 1438.99 1439.15 1439.53
 1439.88 1439.97 1443.66 1444.24 1444.47 1445.28 1445.5  1445.71 1446.04
 1446.9  1447.03 1447.04 1447.54 1447.77 1447.89 1448.38 1448.46 1449.6
 1449.93 1451.21 1451.23 1451.6  1452.52 1452.78 1452.95 1452.96 1453.53
 1453.85 1454.4  1454.47 1454.78 1455.05 1455.51 1456.3  1456.93 1457.51
 1457.85 1458.35 1459.18 1459.53 1460.37 1462.63 1462.85 1463.59 1463.78
 1466.35 1466.84 1467.25 1467.54 1467.95 1468.23 1469.04 1469.89 1470.07
 1470.62 1471.33 1471.43 1471.49 1471.93 1471.99 1472.32 1472.58 1472.83
 1473.51 1474.26 1475.44 1476.23 1476.68 1476.91 1477.65 1477.88 1478.45
 1479.09 1480.49 1480.57 1481.12 1481.25 1482.47 1483.7  1484.16 1484.4
 1484.51 1484.68 1484.86 1486.09 1486.9  1488.85 1489.28 1489.55 1491.66
 1492.47 1493.24 1494.22 1494.32 1495.27 1496.   1496.9  1497.37 1497.42
 1497.46 1500.66 1501.4  1502.13 1502.3  1502.37 1503.06 1503.36 1504.31
 1505.36 1505.49 1506.   1506.03 1506.09 1506.44 1507.3  1507.68 1507.84
 1507.94 1508.33 1509.13 1510.2  1510.29 1511.77 1512.26 1512.52 1512.61
 1513.95 1514.24 1515.42 1515.75 1515.9  1516.16 1516.28 1517.65 1517.78
 1517.93 1518.08 1518.59 1518.8  1519.26 1519.38 1519.66 1520.45 1521.61
 1522.16 1522.51 1522.95 1523.96 1524.76 1524.84 1525.35 1525.39 1525.5
 1526.61 1528.78 1529.95 1530.14 1530.37 1530.69 1531.05 1531.08 1531.44
 1531.83 1532.93 1533.31 1534.08 1535.14 1536.18 1538.87 1539.04 1539.62
 1539.7  1540.86 1541.15 1542.85 1544.83 1546.47 1546.48 1547.66 1548.82
 1549.07 1549.66 1549.68 1552.26 1552.65 1552.8  1554.55 1557.09 1561.58
 1562.09 1565.18]

strikes:
[ 608.427       611.18630612  613.94561224 ... 1717.738      1718.299
 1721.698     ]

maturities:
[ 60  90 180 360 540 720]

types:
['call' 'put']

['DownOut' 'DownIn' 'UpOut' 'UpIn']
number of calls, puts:
2793289,2847000

total prices:
5640289
Deep Neural Network
hidden layers sizes: (13, 13, 13)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
                    calculation_date    spot_price  strike_price  \
count                        5640289 5640289.00000 5640289.00000   
mean   2008-03-16 13:14:18.769825280    1298.15988    1297.31330   
min              2007-01-03 00:00:00     676.03000     608.42700   
25%              2007-09-18 00:00:00    1249.51000    1210.73622   
50%              2008-03-12 00:00:00    1372.41000    1362.55500   
75%              2008-09-03 00:00:00    1477.65000    1472.97257   
max              2009-03-25 00:00:00    1565.18000    1721.69800   
std                              NaN     240.03559     251.74258   

            barrier  days_to_maturity  barrier_price        rebate  \
count 5640289.00000     5640289.00000  5640289.00000 5640289.00000   
mean     1298.10594         329.49872       54.36977       0.00000   
min       338.01500          60.00000        0.00000       0.00000   
25%       912.80287          90.00000        3.32892       0.00000   
50%      1275.70070         360.00000       33.90378       0.00000   
75%      1668.83625         540.00000       94.00657       0.00000   
max      2347.77000         720.00000      293.09806       0.00000   
std       473.43775         241.57537       57.19289       0.00000   

       dividend_rate  risk_free_rate         theta         kappa  \
count  5640289.00000   5640289.00000 5640289.00000 5640289.00000   
mean         0.02277         0.04000       0.06651       2.81756   
min          0.01780         0.04000       0.01992       0.03970   
25%          0.01897         0.04000       0.04503       1.41958   
50%          0.02132         0.04000       0.05583       1.98457   
75%          0.02329         0.04000       0.06271       3.45914   
max          0.03560         0.04000       0.40505      12.32603   
std          0.00504         0.00000       0.03809       2.33147   

                rho           eta            v0  \
count 5640289.00000 5640289.00000 5640289.00000   
mean       -0.94816       0.23038       0.07272   
min        -1.00000       0.08818       0.00524   
25%        -1.00000       0.16244       0.03053   
50%        -1.00000       0.19060       0.04799   
75%        -0.99998       0.23002       0.07466   
max        -0.24433       1.52388       0.38708   
std         0.15354       0.17419       0.07084   

                     expiration_date     moneyness  observed_price  
count                        5640289 5640289.00000   5640289.00000  
mean   2009-02-09 01:12:28.393353728       3.20792        54.37619  
min              2007-03-04 00:00:00      -0.96515         0.00000  
25%              2008-06-13 00:00:00      -0.77519         3.33151  
50%              2009-02-05 00:00:00      -0.10072        33.90271  
75%              2009-09-08 00:00:00       3.26094        94.00879  
max              2011-03-15 00:00:00      27.69497       293.17652  
std                              NaN       6.54428        57.18699  
#############
# test data #
#############
                    calculation_date    spot_price  strike_price  \
count                        1071973 1071973.00000 1071973.00000   
mean   2009-05-31 07:38:53.439741696     902.61139     902.37588   
min              2009-03-26 00:00:00     787.62000     708.85800   
25%              2009-04-28 00:00:00     869.57000     850.25261   
50%              2009-06-01 00:00:00     906.67000     900.49653   
75%              2009-07-02 00:00:00     939.09000     953.52043   
max              2009-08-05 00:00:00    1005.38000    1105.91800   
std                              NaN      48.37048      71.68792   

            barrier  days_to_maturity  barrier_price        rebate  \
count 1071973.00000     1071973.00000  1071973.00000 1071973.00000   
mean      903.47715         326.59024       47.56622       0.00000   
min       393.81000          60.00000        0.00000       0.00000   
25%       673.01810          90.00000        4.52670       0.00000   
50%       902.67045         360.00000       31.95183       0.00000   
75%      1138.59285         540.00000       82.23192       0.00000   
max      1508.07000         720.00000      210.76771       0.00000   
std       285.23774         241.39909       48.15583       0.00000   

       dividend_rate  risk_free_rate         theta         kappa  \
count  1071973.00000   1071973.00000 1071973.00000 1071973.00000   
mean         0.02543         0.04000       0.09749       5.63177   
min          0.02262         0.04000       0.06951       2.05280   
25%          0.02421         0.04000       0.08075       4.98874   
50%          0.02514         0.04000       0.08698       5.54557   
75%          0.02652         0.04000       0.12124       5.98426   
max          0.02983         0.04000       0.15119       8.79712   
std          0.00167         0.00000       0.02389       1.03795   

                rho           eta            v0  \
count 1071973.00000 1071973.00000 1071973.00000   
mean       -0.99570       0.20217       0.07706   
min        -1.00000       0.15451       0.03432   
25%        -1.00000       0.18488       0.05176   
50%        -0.99999       0.19700       0.06805   
75%        -0.99995       0.22056       0.10292   
max        -0.92557       0.26985       0.17432   
std         0.01238       0.02645       0.03313   

                     expiration_date     moneyness  observed_price  
count                        1071973 1071973.00000   1071973.00000  
mean   2010-04-22 21:48:50.228653312       2.08573        47.57189  
min              2009-05-25 00:00:00      -0.94575         0.00000  
25%              2009-09-18 00:00:00      -0.75021         4.52525  
50%              2010-03-22 00:00:00      -0.05699        31.95609  
75%              2010-11-24 00:00:00       1.86218        82.23981  
max              2011-07-26 00:00:00      17.43197       210.71109  
std                              NaN       4.47396        48.15043  

calculation_date     datetime64[ns]
spot_price                  float64
strike_price                float64
barrier                     float64
days_to_maturity              int64
barrier_price               float64
updown                       object
outin                        object
w                            object
barrier_type_name            object
rebate                      float64
dividend_rate               float64
risk_free_rate              float64
theta                       float64
kappa                       float64
rho                         float64
eta                         float64
v0                          float64
expiration_date      datetime64[ns]
moneyness                   float64
observed_price              float64
dtype: object
in sample results:
     RMSE: 4.895752747825027
     MAE: 3.421006643540218

out of sample results:
     RMSE: 6.866558350365198
     MAE: 5.150720789712467

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     barrier
     barrier_type_name
     w

target: observed_price

cpu: 1014.2439494132996
Fri Oct 11 17:10:51 2024