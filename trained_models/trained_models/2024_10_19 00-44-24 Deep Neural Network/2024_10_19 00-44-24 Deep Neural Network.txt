Sat Oct 19 00:41:32 2024
spot(s):
[ 676.03  682.43  683.09 ... 1561.58 1562.09 1565.18]

strikes:
[ 338  341  348 ... 2342 2343 2347]

maturities:
[   1    5    7   10   30   35   70  150  180  300  360  900 1800 3600]

types:
['call' 'put']
['arithmetic' 'geometric'][  1   7  30 180 360][0][ 1  5 10]
number of calls, puts:
654840,654840

total prices:
1309680
Deep Neural Network
hidden layers sizes: (15, 15, 15)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
         spot_price  strike_price  risk_free_rate  dividend_rate  \
count 1309680.00000 1309680.00000   1309680.00000  1309680.00000   
mean     1212.11414    1211.61797         0.04000        0.02195   
std       202.01177     427.05207         0.00000        0.00387   
min       676.03000     338.00000         0.04000        0.01780   
25%      1088.77000     862.00000         0.04000        0.01946   
50%      1236.06500    1175.00000         0.04000        0.02098   
75%      1359.91000    1529.00000         0.04000        0.02262   
max      1565.18000    2347.00000         0.04000        0.03773   

       fixing_frequency     n_fixings  past_fixings         kappa  \
count     1309680.00000 1309680.00000 1309680.00000 1309680.00000   
mean          115.60000       5.33333       0.00000       3.35407   
std           138.66021       3.68179       0.00000       2.24130   
min             1.00000       1.00000       0.00000       0.03970   
25%             7.00000       1.00000       0.00000       1.75855   
50%            30.00000       5.00000       0.00000       2.76180   
75%           180.00000      10.00000       0.00000       4.53863   
max           360.00000      10.00000       0.00000      15.99144   

              theta           rho           eta            v0  \
count 1309680.00000 1309680.00000 1309680.00000 1309680.00000   
mean        0.06829      -0.90437       0.22038       0.06211   
std         0.03493       0.16810       0.13643       0.07841   
min         0.01992      -1.00000       0.08818       0.00524   
25%         0.05127      -1.00000       0.16472       0.02136   
50%         0.06121      -0.99998       0.18952       0.03716   
75%         0.07459      -0.86080       0.22991       0.06386   
max         0.40505      -0.18176       1.52882       0.69402   

       days_to_maturity   asian_price  observed_price  
count     1309680.00000 1309680.00000   1309680.00000  
mean          616.53333       0.00000         0.05979  
std           994.31756       0.00000         0.08751  
min             1.00000       0.00000         0.00000  
25%            10.00000       0.00000         0.00000  
50%           150.00000       0.00000         0.00000  
75%           900.00000       0.00000         0.10106  
max          3600.00000       0.00000         0.75716  
#############
# test data #
#############
        spot_price  strike_price  risk_free_rate  dividend_rate  \
count 230520.00000  230520.00000    230520.00000   230520.00000   
mean    1387.17611    1386.67595         0.04000        0.02247   
std       41.60567     426.95919         0.00000        0.00064   
min     1276.90000     638.00000         0.04000        0.02112   
25%     1357.67000    1018.00000         0.04000        0.02207   
50%     1393.51500    1389.50000         0.04000        0.02236   
75%     1414.97000    1756.00000         0.04000        0.02285   
max     1465.27000    2197.00000         0.04000        0.02436   

       fixing_frequency    n_fixings  past_fixings        kappa        theta  \
count      230520.00000 230520.00000  230520.00000 230520.00000 230520.00000   
mean          115.60000      5.33333       0.00000      1.32924      0.07078   
std           138.66046      3.68179       0.00000      0.62281      0.03507   
min             1.00000      1.00000       0.00000      0.08326      0.04174   
25%             7.00000      1.00000       0.00000      0.91495      0.05510   
50%            30.00000      5.00000       0.00000      1.24392      0.06355   
75%           180.00000     10.00000       0.00000      1.75270      0.07159   
max           360.00000     10.00000       0.00000      3.25590      0.31150   

               rho          eta           v0  days_to_maturity  asian_price  \
count 230520.00000 230520.00000 230520.00000      230520.00000 230520.00000   
mean      -0.81903      0.19055      0.02042         616.53333      0.00000   
std        0.21610      0.08495      0.00767         994.31933      0.00000   
min       -1.00000      0.11461      0.00739           1.00000      0.00000   
25%       -1.00000      0.13566      0.01552          10.00000      0.00000   
50%       -0.91291      0.15397      0.01869         150.00000      0.00000   
75%       -0.67757      0.20861      0.02417         900.00000      0.00000   
max       -0.30144      0.55532      0.05110        3600.00000      0.00000   

       observed_price  
count    230520.00000  
mean          0.05973  
std           0.08765  
min           0.00000  
25%           0.00000  
50%           0.00000  
75%           0.10085  
max           0.66776  

spot_price          float64
strike_price          int64
risk_free_rate      float64
dividend_rate       float64
w                    object
averaging_type       object
fixing_frequency      int64
n_fixings             int64
past_fixings          int64
kappa               float64
theta               float64
rho                 float64
eta                 float64
v0                  float64
calculation_date     object
days_to_maturity      int64
asian_price         float64
observed_price      float64
dtype: object
in sample results:
     RMSE: 0.08751394246071964
     MAE: 0.06917578850297242

out of sample results:
     RMSE: 0.08765081043424156
     MAE: 0.06926313929867974

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     fixing_frequency
     n_fixings
     past_fixings
     averaging_type
     w

target: observed_price

cpu: 171.70778131484985
Sat Oct 19 00:44:24 2024