Fri Oct 11 12:44:49 2024
spot(s):
[1274.24 1276.84 1288.77 1293.41 1298.46 1304.46 1308.8  1311.13 1314.51
 1314.81 1315.19 1317.94 1318.45 1320.45 1322.21 1322.24 1325.42 1325.9
 1326.38 1326.79 1328.62 1329.65 1329.75 1330.53 1330.91 1331.14 1331.49
 1333.24 1333.44 1333.8  1334.79 1335.63 1336.97 1337.24 1338.18 1338.73
 1339.01 1340.15 1340.92 1342.48 1342.83 1348.8  1348.82 1348.83 1349.69
 1349.91 1350.78 1351.52 1352.69 1353.69 1353.73 1354.63 1354.95 1358.24
 1359.88 1360.   1360.03 1360.47 1360.48 1362.14 1363.84 1365.56 1365.65
 1366.54 1367.41 1367.69 1369.22 1369.79 1370.68 1371.44 1372.41 1372.91
 1374.2  1376.17 1376.18 1376.5  1377.07 1377.59 1377.99 1379.83 1380.11
 1380.72 1380.79 1381.38 1385.23 1385.42 1385.74 1386.77 1386.98 1387.16
 1388.04 1388.3  1388.63 1390.08 1390.45 1390.84 1391.01 1391.18 1391.82
 1392.05 1392.46 1394.07 1395.   1395.15 1396.31 1397.45 1398.   1398.05
 1399.4  1399.96 1401.2  1401.5  1401.77 1402.74 1403.05 1403.12 1403.51
 1403.52 1406.48 1406.58 1406.64 1406.77 1407.53 1408.06 1409.11 1409.14
 1409.82 1410.74 1411.59 1412.12 1412.71 1413.18 1413.53 1413.8  1414.71
 1416.12 1416.34 1416.4  1416.59 1416.97 1418.28 1418.38 1419.95 1420.46
 1420.83 1422.42 1422.43 1423.07 1423.24 1423.8  1424.27 1424.44 1425.15
 1426.09 1426.43 1426.6  1428.02 1428.35 1428.7  1428.81 1430.36 1430.59
 1430.69 1431.78 1433.18 1433.19 1433.55 1433.65 1434.56 1434.69 1436.11
 1437.38 1437.45 1438.07 1438.45 1438.91 1438.99 1439.15 1439.53 1439.88
 1439.97 1443.66 1444.24 1444.47 1445.28 1445.5  1445.71 1446.04 1446.9
 1447.03 1447.04 1447.54 1447.77 1447.89 1448.38 1448.46 1449.6  1449.93
 1451.21 1451.23 1451.6  1452.52 1452.78 1452.95 1452.96 1453.53 1453.85
 1454.4  1454.47 1454.78 1455.05 1455.51 1456.3  1456.93 1457.51 1457.85
 1458.35 1459.18 1459.53 1460.37 1462.63 1462.85 1463.59 1463.78 1466.35
 1466.84 1467.25 1467.54 1467.95 1468.23 1469.04 1469.89 1470.07 1470.62
 1471.33 1471.43 1471.49 1471.93 1471.99 1472.32 1472.58 1472.83 1473.51
 1474.26 1475.44 1476.23 1476.68 1476.91 1477.65 1477.88 1478.45 1479.09
 1480.49 1480.57 1481.12 1481.25 1482.47 1483.7  1484.16 1484.4  1484.51
 1484.68 1484.86 1486.09 1486.9  1488.85 1489.28 1489.55 1491.66 1492.47
 1493.24 1494.22 1494.32 1495.27 1496.   1496.9  1497.37 1497.42 1497.46
 1500.66 1501.4  1502.13 1502.3  1502.37 1503.06 1503.36 1504.31 1505.36
 1505.49 1506.   1506.03 1506.09 1506.44 1507.3  1507.68 1507.84 1507.94
 1508.33 1509.13 1510.2  1510.29 1511.77 1512.26 1512.52 1512.61 1513.95
 1514.24 1515.42 1515.75 1515.9  1516.16 1516.28 1517.65 1517.78 1517.93
 1518.08 1518.59 1518.8  1519.26 1519.38 1519.66 1520.45 1521.61 1522.16
 1522.51 1522.95 1523.96 1524.76 1524.84 1525.35 1525.39 1525.5  1526.61
 1528.78 1529.95 1530.14 1530.37 1530.69 1531.05 1531.08 1531.44 1531.83
 1532.93 1533.31 1534.08 1535.14 1536.18 1538.87 1539.04 1539.62 1539.7
 1540.86 1541.15 1542.85 1544.83 1546.47 1546.48 1547.66 1548.82 1549.07
 1549.66 1549.68 1552.26 1552.65 1552.8  1554.55 1557.09 1561.58 1562.09
 1565.18]

strikes:
[1146.816      1149.156      1152.01697959 ... 1717.738      1718.299
 1721.698     ]

maturities:
[ 60  90 180 360 540 720]

types:
['call' 'put']

['DownOut' 'DownIn' 'UpOut' 'UpIn']
number of calls, puts:
1807204,1853576

total prices:
3660780
Deep Neural Network
hidden layers sizes: (13, 13, 13)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
                    calculation_date    spot_price  strike_price  \
count                        3660780 3660780.00000 3660780.00000   
mean   2007-11-10 03:16:40.173734400    1441.72409    1440.59862   
min              2007-01-03 00:00:00    1274.24000    1146.81600   
25%              2007-07-26 00:00:00    1377.59000    1360.87194   
50%              2007-11-08 00:00:00    1454.40000    1437.35827   
75%              2008-03-05 00:00:00    1506.09000    1521.89959   
max              2008-06-25 00:00:00    1565.18000    1721.69800   
std                              NaN      73.24830     111.68422   

            barrier  days_to_maturity  barrier_price        rebate  \
count 3660780.00000     3660780.00000  3660780.00000 3660780.00000   
mean     1441.29462         331.01316       53.89428       0.00000   
min       637.12000          60.00000        0.00000       0.00000   
25%      1081.44200          90.00000        2.15827       0.00000   
50%      1453.92530         360.00000       31.36056       0.00000   
75%      1816.02265         540.00000       93.68057       0.00000   
max      2347.77000         720.00000      293.09806       0.00000   
std       451.77035         241.63290       58.34113       0.00000   

       dividend_rate  risk_free_rate         theta         kappa  \
count  3660780.00000   3660780.00000 3660780.00000 3660780.00000   
mean         0.01984         0.04000       0.04775       2.16571   
min          0.01780         0.04000       0.01992       0.03970   
25%          0.01861         0.04000       0.03806       1.11711   
50%          0.01927         0.04000       0.05241       1.74756   
75%          0.02125         0.04000       0.05680       2.34093   
max          0.02308         0.04000       0.40505      12.32603   
std          0.00142         0.00000       0.01528       1.78328   

                rho           eta            v0  \
count 3660780.00000 3660780.00000 3660780.00000   
mean       -0.95694       0.20214       0.03959   
min        -1.00000       0.08818       0.00524   
25%        -1.00000       0.14990       0.02303   
50%        -1.00000       0.17809       0.03741   
75%        -1.00000       0.20514       0.05356   
max        -0.27661       1.45769       0.13501   
std         0.13745       0.13775       0.02050   

                     expiration_date     moneyness  observed_price  
count                        3660780 3660780.00000   3660780.00000  
mean   2008-10-06 03:35:37.295331328       3.60235        53.90153  
min              2007-03-04 00:00:00      -0.96515         0.00000  
25%              2008-03-04 00:00:00      -0.78576         2.16243  
50%              2008-08-31 00:00:00      -0.43572        31.35932  
75%              2009-05-09 00:00:00       3.37001        93.68292  
max              2010-06-15 00:00:00      27.69497       293.12053  
std                              NaN       7.10849        58.33463  
#############
# test data #
#############
                    calculation_date   spot_price  strike_price      barrier  \
count                         913085 913085.00000  913085.00000 913085.00000   
mean   2008-08-17 05:03:34.509274112   1252.80987    1252.13338   1253.99412   
min              2008-06-26 00:00:00   1156.65000    1040.98500    578.32500   
25%              2008-07-24 00:00:00   1235.03000    1188.08957    937.09825   
50%              2008-08-21 00:00:00   1260.39000    1250.91592   1261.45970   
75%              2008-09-10 00:00:00   1277.54000    1315.82500   1583.49625   
max              2008-09-26 00:00:00   1305.09000    1435.59900   1957.63500   
std                              NaN     32.57439      80.12204    389.93002   

       days_to_maturity  barrier_price       rebate  dividend_rate  \
count      913085.00000   913085.00000 913085.00000   913085.00000   
mean          328.54880       52.86510      0.00000        0.02322   
min            60.00000        0.00000      0.00000        0.02227   
25%            90.00000        3.66500      0.00000        0.02273   
50%           360.00000       34.25014      0.00000        0.02306   
75%           540.00000       92.26735      0.00000        0.02356   
max           720.00000      248.35434      0.00000        0.02592   
std           241.36998       54.37937      0.00000        0.00065   

       risk_free_rate        theta        kappa          rho          eta  \
count    913085.00000 913085.00000 913085.00000 913085.00000 913085.00000   
mean          0.04000      0.05759      3.74344     -0.85435      0.32175   
min           0.04000      0.05135      0.67288     -1.00000      0.15083   
25%           0.04000      0.05439      1.83124     -1.00000      0.16659   
50%           0.04000      0.05666      2.14364     -1.00000      0.17287   
75%           0.04000      0.06114      4.16711     -0.73534      0.28683   
max           0.04000      0.06635     11.87783     -0.24433      1.52388   
std           0.00000      0.00399      3.00481      0.24019      0.31108   

                v0                expiration_date    moneyness  observed_price  
count 913085.00000                         913085 913085.00000    913085.00000  
mean       0.06025  2009-07-11 18:13:50.730106880      3.09107        52.87142  
min        0.02683            2008-08-25 00:00:00     -0.95821         0.00000  
25%        0.03836            2008-11-25 00:00:00     -0.83017         3.66736  
50%        0.04883            2009-06-26 00:00:00     -0.35947        34.24443  
75%        0.06022            2010-02-16 00:00:00      2.79723        92.26122  
max        0.14821            2010-09-16 00:00:00     22.92665       248.38382  
std        0.03172                            NaN      6.20123        54.37334  

calculation_date     datetime64[ns]
spot_price                  float64
strike_price                float64
barrier                     float64
days_to_maturity              int64
barrier_price               float64
updown                       object
outin                        object
w                            object
barrier_type_name            object
rebate                      float64
dividend_rate               float64
risk_free_rate              float64
theta                       float64
kappa                       float64
rho                         float64
eta                         float64
v0                          float64
expiration_date      datetime64[ns]
moneyness                   float64
observed_price              float64
dtype: object
in sample results:
     RMSE: 10.063285780508355
     MAE: 7.258405852525395

out of sample results:
     RMSE: 13.945552122781631
     MAE: 8.874649346521528

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     barrier
     barrier_type_name
     w

target: observed_price

cpu: 63.1969530582428
Fri Oct 11 12:45:52 2024