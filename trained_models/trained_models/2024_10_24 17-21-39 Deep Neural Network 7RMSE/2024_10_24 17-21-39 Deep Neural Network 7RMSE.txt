Thu Oct 24 17:09:25 2024
spot(s):
[ 676.03  682.43  683.09 ... 1561.58 1562.09 1565.18]

strikes:
[ 608.427  614.187  614.781 ... 1717.738 1718.299 1721.698]

maturities:
[ 60  90 180 360 540 720]

types:
['call' 'put']

['DownOut' 'DownIn' 'UpOut' 'UpIn']
averaging_type:
number of calls, puts:
1369260,1369260

total prices:
2738520
Deep Neural Network
hidden layers sizes: (13, 13, 13)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
         spot_price  strike_price       barrier  days_to_maturity  \
count 2738520.00000 2738520.00000 2738520.00000     2738520.00000   
mean     1215.63126    1215.63126    1215.63126         323.05311   
min       676.03000     608.42700     338.01500          60.00000   
25%      1091.94000    1069.57800     872.24018          90.00000   
50%      1240.30000    1224.51200    1186.20810         180.00000   
75%      1360.48000    1374.46100    1514.11853         540.00000   
max      1565.18000    1721.69800    2347.77000         720.00000   
std       200.57095     215.76297     429.52828         241.28414   

             rebate  dividend_rate  risk_free_rate         theta  \
count 2738520.00000  2738520.00000   2738520.00000 2738520.00000   
mean        0.00000        0.02184         0.04000       0.06781   
min         0.00000        0.01780         0.04000       0.01992   
25%         0.00000        0.01942         0.04000       0.05104   
50%         0.00000        0.02096         0.04000       0.06059   
75%         0.00000        0.02252         0.04000       0.07413   
max         0.00000        0.03773         0.04000       0.40505   
std         0.00000        0.00375         0.00000       0.03468   

              kappa           rho           eta            v0  \
count 2738520.00000 2738520.00000 2738520.00000 2738520.00000   
mean        3.31189      -0.90325       0.21853       0.05732   
min         0.03970      -1.00000       0.08818       0.00524   
25%         1.74789      -1.00000       0.16424       0.02119   
50%         2.72324      -0.99999       0.18863       0.03664   
75%         4.48610      -0.85432       0.22752       0.06127   
max        15.99144      -0.18176       1.52882       0.69402   
std         2.20254       0.16883       0.13615       0.06473   

                 calculation_date  barrier_price  observed_price  
count                     2738520  2738520.00000   2738520.00000  
mean   2009-07-23 10:24:07.193376       49.04504        49.04575  
min           2007-01-03 00:00:00        0.00000         0.00000  
25%           2008-04-07 00:00:00        1.22662         1.22786  
50%           2009-07-31 00:00:00       26.04646        26.04666  
75%           2010-11-02 00:00:00       85.85395        85.85415  
max           2012-02-06 00:00:00      293.09806       293.08864  
std                           NaN       54.91846        54.91784  
#############
# test data #
#############
        spot_price  strike_price      barrier  days_to_maturity       rebate  \
count 488160.00000  488160.00000 488160.00000      488160.00000 488160.00000   
mean    1387.17611    1387.17611   1387.17611         325.00000      0.00000   
min     1276.90000    1149.21000    638.45000          60.00000      0.00000   
25%     1357.67000    1308.07025   1038.37541          90.00000      0.00000   
50%     1393.51500    1385.64625   1389.67290         270.00000      0.00000   
75%     1414.97000    1465.10675   1748.51306         540.00000      0.00000   
max     1465.27000    1611.79700   2197.90500         720.00000      0.00000   
std       41.60562      98.77245    429.85177         241.50594      0.00000   

       dividend_rate  risk_free_rate        theta        kappa          rho  \
count   488160.00000    488160.00000 488160.00000 488160.00000 488160.00000   
mean         0.02247         0.04000      0.07078      1.32924     -0.81903   
min          0.02112         0.04000      0.04174      0.08326     -1.00000   
25%          0.02207         0.04000      0.05510      0.91495     -1.00000   
50%          0.02236         0.04000      0.06355      1.24392     -0.91291   
75%          0.02285         0.04000      0.07159      1.75270     -0.67757   
max          0.02436         0.04000      0.31150      3.25590     -0.30144   
std          0.00064         0.00000      0.03507      0.62281      0.21610   

               eta           v0               calculation_date  barrier_price  \
count 488160.00000 488160.00000                         488160   488160.00000   
mean       0.19055      0.02042  2012-07-18 11:09:01.592920832       48.52591   
min        0.11461      0.00739            2012-02-07 00:00:00        0.00000   
25%        0.13566      0.01552            2012-04-27 00:00:00        0.56773   
50%        0.15397      0.01869            2012-07-18 12:00:00       21.76970   
75%        0.20861      0.02417            2012-10-08 00:00:00       85.31489   
max        0.55532      0.05110            2012-12-31 00:00:00      280.85321   
std        0.08495      0.00767                            NaN       56.68094   

       observed_price  
count    488160.00000  
mean         48.52670  
min           0.00000  
25%           0.56865  
50%          21.77274  
75%          85.31603  
max         280.85623  
std          56.68023  

spot_price                  float64
strike_price                float64
barrier                     float64
days_to_maturity              int64
updown                       object
outin                        object
w                            object
barrier_type_name            object
rebate                      float64
dividend_rate               float64
risk_free_rate              float64
theta                       float64
kappa                       float64
rho                         float64
eta                         float64
v0                          float64
calculation_date     datetime64[ns]
barrier_price               float64
observed_price              float64
dtype: object
in sample results:
     RMSE: 6.074449441404342
     MAE: 3.970218442925101

out of sample results:
     RMSE: 7.779563831106827
     MAE: 4.998618167063606

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     barrier
     barrier_type_name
     w

target: observed_price

cpu: 734.1901371479034
Thu Oct 24 17:21:39 2024