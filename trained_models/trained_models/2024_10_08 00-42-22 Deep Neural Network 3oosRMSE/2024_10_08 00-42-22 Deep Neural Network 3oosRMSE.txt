Tue Oct  8 00:29:10 2024
spot(s):
[1304.46 1311.13 1325.42 1326.38 1326.79 1330.53 1330.91 1331.14 1331.49
 1333.44 1333.8  1336.97 1337.24 1338.73 1339.01 1342.48 1348.8  1348.82
 1348.83 1349.91 1351.52 1353.69 1353.73 1354.95 1360.03 1362.14 1366.54
 1367.69 1371.44 1372.91 1374.2  1376.18 1377.99 1379.83 1380.72 1380.79
 1381.38 1386.77 1386.98 1387.16 1390.08 1391.82 1392.05 1395.   1395.15
 1399.96 1401.2  1401.5  1401.77 1402.74 1403.05 1406.48 1406.58 1406.64
 1406.77 1409.11 1409.82 1410.74 1411.59 1412.12 1412.71 1413.18 1414.71
 1416.12 1416.34 1416.4  1416.59 1416.97 1418.28 1419.95 1420.46 1420.83
 1422.42 1422.43 1423.07 1423.8  1424.27 1424.44 1426.09 1426.6  1428.02
 1428.35 1428.7  1428.81 1430.36 1430.59 1430.69 1431.78 1433.18 1433.19
 1433.55 1433.65 1434.56 1434.69 1436.11 1437.38 1437.45 1438.07 1438.45
 1438.91 1438.99 1439.15 1439.53 1439.88 1439.97 1443.66 1444.24 1444.47
 1445.28 1445.5  1445.71 1446.04 1446.9  1447.03 1447.04 1447.54 1447.77
 1447.89 1448.38 1448.46 1449.6  1449.93 1451.21 1451.23 1451.6  1452.52
 1452.78 1452.95 1452.96 1453.53 1453.85 1454.4  1454.47 1454.78 1455.05
 1455.51 1456.3  1456.93 1457.51 1457.85 1458.35 1459.18 1459.53 1460.37
 1462.63 1462.85 1463.59 1463.78 1466.35 1466.84 1467.25 1467.54 1467.95
 1468.23 1469.04 1469.89 1470.07 1470.62 1471.33 1471.43 1471.49 1471.93
 1471.99 1472.32 1472.58 1472.83 1473.51 1474.26 1475.44 1476.23 1476.68
 1476.91 1477.65 1477.88 1478.45 1479.09 1480.49 1480.57 1481.12 1481.25
 1482.47 1483.7  1484.16 1484.4  1484.51 1484.68 1484.86 1486.09 1486.9
 1488.85 1489.28 1489.55 1491.66 1492.47 1493.24 1494.22 1494.32 1495.27
 1496.   1496.9  1497.37 1497.42 1497.46 1500.66 1501.4  1502.13 1502.3
 1502.37 1503.06 1503.36 1504.31 1505.36 1505.49 1506.   1506.03 1506.09
 1506.44 1507.3  1507.68 1507.84 1507.94 1508.33 1509.13 1510.2  1510.29
 1511.77 1512.26 1512.52 1512.61 1513.95 1514.24 1515.42 1515.75 1515.9
 1516.16 1516.28 1517.65 1517.78 1517.93 1518.08 1518.59 1518.8  1519.26
 1519.38 1519.66 1520.45 1521.61 1522.16 1522.51 1522.95 1523.96 1524.76
 1524.84 1525.35 1525.39 1525.5  1526.61 1528.78 1529.95 1530.14 1530.37
 1530.69 1531.05 1531.08 1531.44 1531.83 1532.93 1533.31 1534.08 1535.14
 1536.18 1538.87 1539.04 1539.62 1539.7  1540.86 1541.15 1542.85 1544.83
 1546.47 1546.48 1547.66 1548.82 1549.07 1549.66 1549.68 1552.26 1552.65
 1552.8  1554.55 1557.09 1561.58 1562.09 1565.18]

strikes:
[1174.014      1179.33832653 1180.017      ... 1717.738      1718.299
 1721.698     ]

maturities:
[ 60  90 180 360 540 720]

types:
['call' 'put']

['DownOut' 'DownIn' 'UpOut' 'UpIn']
number of calls, puts:
1369282,1406837

total prices:
2776119
Deep Neural Network
hidden layers sizes: (26, 26, 26)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
         spot_price  strike_price       barrier  days_to_maturity  \
count  2.776119e+06  2.776119e+06  2.776119e+06      2.776119e+06   
mean   1.466755e+03  1.465568e+03  1.466018e+03      3.313401e+02   
min    1.304460e+03  1.174014e+03  6.522300e+02      6.000000e+01   
25%    1.433650e+03  1.388896e+03  1.100127e+03      9.000000e+01   
50%    1.478450e+03  1.463475e+03  1.481040e+03      3.600000e+02   
75%    1.516280e+03  1.547290e+03  1.846720e+03      5.400000e+02   
max    1.565180e+03  1.721698e+03  2.347770e+03      7.200000e+02   
std    6.360914e+01  1.068519e+02  4.575747e+02      2.417208e+02   

       barrier_price     rebate  dividend_rate  risk_free_rate         theta  \
count   2.776119e+06  2776119.0   2.776119e+06    2.776119e+06  2.776119e+06   
mean    5.345683e+01        0.0   1.928366e-02    4.000000e-02  4.462571e-02   
min     2.593117e-08        0.0   1.779800e-02    4.000000e-02  1.992058e-02   
25%     1.928665e+00        0.0   1.851400e-02    4.000000e-02  3.479258e-02   
50%     3.052977e+01        0.0   1.893000e-02    4.000000e-02  4.484455e-02   
75%     9.271891e+01        0.0   1.952400e-02    4.000000e-02  5.577830e-02   
max     2.930981e+02        0.0   2.256300e-02    4.000000e-02  4.050494e-01   
std     5.841685e+01        0.0   1.104935e-03    3.330670e-16  1.619632e-02   

              kappa           rho           eta            v0  \
count  2.776119e+06  2.776119e+06  2.776119e+06  2.776119e+06   
mean   2.173710e+00 -9.487755e-01  2.066569e-01  3.887234e-02   
min    3.970018e-02 -1.000000e+00  8.817807e-02  5.244166e-03   
25%    1.024640e+00 -1.000000e+00  1.304430e-01  1.913510e-02   
50%    1.713453e+00 -9.999999e-01  1.833806e-01  3.720878e-02   
75%    2.512319e+00 -9.999997e-01  2.069649e-01  5.463662e-02   
max    1.232603e+01 -2.766103e-01  1.457690e+00  1.350097e-01   
std    1.957682e+00  1.505938e-01  1.557505e-01  2.152722e-02   

                    calculation_date                expiration_date  \
count                        2776119                        2776119   
mean   2007-09-15 21:25:41.217649920  2008-08-12 05:35:27.504909056   
min              2007-01-03 00:00:00            2007-03-04 00:00:00   
25%              2007-06-27 00:00:00            2008-01-12 00:00:00   
50%              2007-09-17 00:00:00            2008-06-27 00:00:00   
75%              2007-12-10 00:00:00            2009-03-10 00:00:00   
max              2008-03-06 00:00:00            2010-02-24 00:00:00   
std                              NaN                            NaN   

       observed_price  
count    2.776119e+06  
mean     5.346419e+01  
min      0.000000e+00  
25%      1.930602e+00  
50%      3.052615e+01  
75%      9.272341e+01  
max      2.929748e+02  
std      5.841021e+01  
#############
# test data #
#############
          spot_price   strike_price        barrier  days_to_maturity  \
count  369817.000000  369817.000000  369817.000000     369817.000000   
mean     1339.001533    1338.166283    1339.739863        328.561883   
min      1274.240000    1146.816000     637.120000         60.000000   
25%      1315.190000    1269.653490     994.418550         90.000000   
50%      1334.790000    1337.790714    1342.946500        360.000000   
75%      1365.650000    1404.524000    1693.860950        540.000000   
max      1390.450000    1529.495000    2085.675000        720.000000   
std        31.530753      84.352289     416.390583        241.380520   

       barrier_price    rebate  dividend_rate  risk_free_rate          theta  \
count   3.698170e+05  369817.0  369817.000000    3.698170e+05  369817.000000   
mean    5.730766e+01       0.0       0.022093    4.000000e-02       0.059997   
min     5.513854e-07       0.0       0.021270    4.000000e-02       0.055390   
25%     3.703025e+00       0.0       0.021726    4.000000e-02       0.057094   
50%     3.748403e+01       0.0       0.022120    4.000000e-02       0.059634   
75%     9.995045e+01       0.0       0.022437    4.000000e-02       0.063154   
max     2.670748e+02       0.0       0.023081    4.000000e-02       0.066282   
std     5.899443e+01       0.0       0.000469    2.081671e-17       0.003285   

               kappa            rho            eta             v0  \
count  369817.000000  369817.000000  369817.000000  369817.000000   
mean        2.397746      -0.995142       0.198769       0.055137   
min         1.422458      -1.000000       0.152241       0.030735   
25%         1.670871      -1.000000       0.180106       0.043979   
50%         1.797846      -1.000000       0.186465       0.054682   
75%         2.703328      -1.000000       0.212413       0.062100   
max         7.463275      -0.846222       0.361838       0.104066   
std         1.392331       0.026878       0.038972       0.016673   

                    calculation_date                expiration_date  \
count                         369817                         369817   
mean   2008-03-30 10:25:26.902224640  2009-02-21 23:54:33.620196352   
min              2008-03-07 00:00:00            2008-05-06 00:00:00   
25%              2008-03-18 00:00:00            2008-07-01 00:00:00   
50%              2008-03-31 00:00:00            2009-03-05 00:00:00   
75%              2008-04-10 00:00:00            2009-09-23 00:00:00   
max              2008-04-22 00:00:00            2010-04-12 00:00:00   
std                              NaN                            NaN   

       observed_price  
count   369817.000000  
mean        57.314272  
min          0.000000  
25%          3.708631  
50%         37.465716  
75%         99.947600  
max        267.078991  
std         58.988300  

spot_price                  float64
strike_price                float64
barrier                     float64
days_to_maturity              int64
barrier_price               float64
updown                       object
outin                        object
w                            object
barrier_type_name            object
rebate                      float64
dividend_rate               float64
risk_free_rate              float64
theta                       float64
kappa                       float64
rho                         float64
eta                         float64
v0                          float64
calculation_date     datetime64[ns]
expiration_date      datetime64[ns]
observed_price              float64
dtype: object
in sample results:
     RMSE: 2.988783775943185
     MAE: 2.0540554508093956

out of sample results:
     RMSE: 3.101569682358493
     MAE: 2.1869458839213385

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     barrier
     barrier_type_name
     w

target: observed_price

cpu: 791.7858889102936
Tue Oct  8 00:42:22 2024