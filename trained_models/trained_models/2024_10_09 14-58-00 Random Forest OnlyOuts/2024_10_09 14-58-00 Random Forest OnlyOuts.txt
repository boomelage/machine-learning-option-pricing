Wed Oct  9 14:54:21 2024
spot(s):
[1214.91 1228.34 1235.03 1240.01 1244.81 1245.64 1248.97 1251.98 1253.33
 1253.75 1257.85 1259.82 1260.39 1260.44 1260.47 1261.75 1263.07 1263.23
 1267.3  1273.68 1274.24 1276.78 1276.84 1279.06 1279.51 1281.9  1283.57
 1284.14 1284.21 1285.13 1288.77 1293.41 1298.46 1304.46 1308.8  1311.13
 1314.51 1314.81 1315.19 1317.94 1318.45 1320.45 1322.21 1322.24 1325.42
 1325.9  1326.38 1326.79 1328.62 1329.65 1329.75 1330.53 1330.91 1331.14
 1331.49 1333.24 1333.44 1333.8  1334.79 1335.63 1336.97 1337.24 1338.18
 1338.73 1339.01 1340.15 1340.92 1342.48 1342.83 1348.8  1348.82 1348.83
 1349.69 1349.91 1350.78 1351.52 1352.69 1353.69 1353.73 1354.63 1354.95
 1358.24 1359.88 1360.   1360.03 1360.47 1360.48 1362.14 1363.84 1365.56
 1365.65 1366.54 1367.41 1367.69 1369.22 1369.79 1370.68 1371.44 1372.41
 1372.91 1374.2  1376.17 1376.18 1376.5  1377.07 1377.59 1377.99 1379.83
 1380.11 1380.72 1380.79 1381.38 1385.23 1385.42 1385.74 1386.77 1386.98
 1387.16 1388.04 1388.3  1388.63 1390.08 1390.45 1390.84 1391.01 1391.18
 1391.82 1392.05 1392.46 1394.07 1395.   1395.15 1396.31 1397.45 1398.
 1398.05 1399.4  1399.96 1401.2  1401.5  1401.77 1402.74 1403.05 1403.12
 1403.51 1403.52 1406.48 1406.58 1406.64 1406.77 1407.53 1408.06 1409.11
 1409.14 1409.82 1410.74 1411.59 1412.12 1412.71 1413.18 1413.53 1413.8
 1414.71 1416.12 1416.34 1416.4  1416.59 1416.97 1418.28 1418.38 1419.95
 1420.46 1420.83 1422.42 1422.43 1423.07 1423.24 1423.8  1424.27 1424.44
 1425.15 1426.09 1426.43 1426.6  1428.02 1428.35 1428.7  1428.81 1430.36
 1430.59 1430.69 1431.78 1433.18 1433.19 1433.55 1433.65 1434.56 1434.69
 1436.11 1437.38 1437.45 1438.07 1438.45 1438.91 1438.99 1439.15 1439.53
 1439.88 1439.97 1443.66 1444.24 1444.47 1445.28 1445.5  1445.71 1446.04
 1446.9  1447.03 1447.04 1447.54 1447.77 1447.89 1448.38 1448.46 1449.6
 1449.93 1451.21 1451.23 1451.6  1452.52 1452.78 1452.95 1452.96 1453.53
 1453.85 1454.4  1454.47 1454.78 1455.05 1455.51 1456.3  1456.93 1457.51
 1457.85 1458.35 1459.18 1459.53 1460.37 1462.63 1462.85 1463.59 1463.78
 1466.35 1466.84 1467.25 1467.54 1467.95 1468.23 1469.04 1469.89 1470.07
 1470.62 1471.33 1471.43 1471.49 1471.93 1471.99 1472.32 1472.58 1472.83
 1473.51 1474.26 1475.44 1476.23 1476.68 1476.91 1477.65 1477.88 1478.45
 1479.09 1480.49 1480.57 1481.12 1481.25 1482.47 1483.7  1484.16 1484.4
 1484.51 1484.68 1484.86 1486.09 1486.9  1488.85 1489.28 1489.55 1491.66
 1492.47 1493.24 1494.22 1494.32 1495.27 1496.   1496.9  1497.37 1497.42
 1497.46 1500.66 1501.4  1502.13 1502.3  1502.37 1503.06 1503.36 1504.31
 1505.36 1505.49 1506.   1506.03 1506.09 1506.44 1507.3  1507.68 1507.84
 1507.94 1508.33 1509.13 1510.2  1510.29 1511.77 1512.26 1512.52 1512.61
 1513.95 1514.24 1515.42 1515.75 1515.9  1516.16 1516.28 1517.65 1517.78
 1517.93 1518.08 1518.59 1518.8  1519.26 1519.38 1519.66 1520.45 1521.61
 1522.16 1522.51 1522.95 1523.96 1524.76 1524.84 1525.35 1525.39 1525.5
 1526.61 1528.78 1529.95 1530.14 1530.37 1530.69 1531.05 1531.08 1531.44
 1531.83 1532.93 1533.31 1534.08 1535.14 1536.18 1538.87 1539.04 1539.62
 1539.7  1540.86 1541.15 1542.85 1544.83 1546.47 1546.48 1547.66 1548.82
 1549.07 1549.66 1549.68 1552.26 1552.65 1552.8  1554.55 1557.09 1561.58
 1562.09 1565.18]

strikes:
[1093.419      1098.37781633 1103.33663265 ... 1717.738      1718.299
 1721.698     ]

maturities:
[ 60  90 180 360 540 720]

types:
['call' 'put']

['DownOut' 'UpOut']
number of calls, puts:
998984,998984

total prices:
1997968
Random Forest
number of estimators: 50
minimum samples per leaf: 2000
#################
# training data #
#################
         spot_price  strike_price       barrier  days_to_maturity  \
count  1.997968e+06  1.997968e+06  1.997968e+06      1.997968e+06   
mean   1.427872e+03  1.427872e+03  1.427876e+03      3.249135e+02   
min    1.214910e+03  1.093419e+03  6.074550e+02      6.000000e+01   
25%    1.360480e+03  1.342997e+03  1.045041e+03      9.000000e+01   
50%    1.446040e+03  1.426145e+03  1.431045e+03      1.800000e+02   
75%    1.503360e+03  1.516051e+03  1.814780e+03      5.400000e+02   
max    1.565180e+03  1.721698e+03  2.347770e+03      7.200000e+02   
std    8.594840e+01  1.204648e+02  4.596263e+02      2.415138e+02   

       barrier_price     rebate  dividend_rate  risk_free_rate         theta  \
count   1.997968e+06  1997968.0   1.997968e+06    1.997968e+06  1.997968e+06   
mean    6.586020e+01        0.0   2.009576e-02    4.000000e-02  4.813086e-02   
min     2.262237e-04        0.0   1.779800e-02    4.000000e-02  1.992058e-02   
25%     1.481933e+01        0.0   1.864200e-02    4.000000e-02  3.818928e-02   
50%     5.336433e+01        0.0   1.941200e-02    4.000000e-02  5.267531e-02   
75%     1.070225e+02        0.0   2.154000e-02    4.000000e-02  5.669418e-02   
max     2.929718e+02        0.0   2.406300e-02    4.000000e-02  4.050494e-01   
std     5.696310e+01        0.0   1.634459e-03    1.318390e-16  1.496361e-02   

              kappa           rho           eta            v0  \
count  1.997968e+06  1.997968e+06  1.997968e+06  1.997968e+06   
mean   2.139080e+00 -9.607500e-01  1.987921e-01  4.017350e-02   
min    3.970018e-02 -1.000000e+00  8.817807e-02  5.244166e-03   
25%    1.130705e+00 -1.000000e+00  1.527382e-01  2.399189e-02   
50%    1.748429e+00 -9.999999e-01  1.743948e-01  3.886123e-02   
75%    2.308585e+00 -9.999998e-01  2.023692e-01  5.335600e-02   
max    1.232603e+01 -2.766103e-01  1.457690e+00  1.350097e-01   
std    1.718234e+00  1.316528e-01  1.314763e-01  2.008118e-02   

                    calculation_date                expiration_date  \
count                        1997968                        1997968   
mean   2007-11-28 15:28:27.357074432  2008-10-18 13:23:55.669841152   
min              2007-01-03 00:00:00            2007-03-04 00:00:00   
25%              2007-08-02 00:00:00            2008-03-12 00:00:00   
50%              2007-11-27 00:00:00            2008-09-16 00:00:00   
75%              2008-04-02 00:00:00            2009-05-23 00:00:00   
max              2008-08-05 00:00:00            2010-07-26 00:00:00   
std                              NaN                            NaN   

       observed_price  
count    1.997968e+06  
mean     6.586178e+01  
min      0.000000e+00  
25%      1.482538e+01  
50%      5.336315e+01  
75%      1.070280e+02  
max      2.929060e+02  
std      5.696114e+01  
#############
# test data #
#############
          spot_price   strike_price        barrier  days_to_maturity  \
count  349164.000000  349164.000000  349164.000000     349164.000000   
mean     1216.503279    1216.503279    1216.503279        325.000000   
min       952.690000     857.421000     476.345000         60.000000   
25%      1195.660000    1156.507592     896.458500         90.000000   
50%      1242.380000    1227.570143    1225.897600        270.000000   
75%      1275.250000    1299.939000    1545.808600        540.000000   
max      1305.090000    1435.599000    1957.635000        720.000000   
std        88.794354     114.125248     395.080793        241.506039   

       barrier_price    rebate  dividend_rate  risk_free_rate          theta  \
count  349164.000000  349164.0  349164.000000    3.491640e+05  349164.000000   
mean       61.908031       0.0       0.023883    4.000000e-02       0.065428   
min         0.000102       0.0       0.022270    4.000000e-02       0.053922   
25%        12.993745       0.0       0.022701    4.000000e-02       0.058336   
50%        51.183872       0.0       0.023355    4.000000e-02       0.060409   
75%       101.262575       0.0       0.024103    4.000000e-02       0.063513   
max       248.254676       0.0       0.029843    4.000000e-02       0.129897   
std        53.227673       0.0       0.001859    2.081671e-17       0.017320   

               kappa            rho            eta             v0  \
count  349164.000000  349164.000000  349164.000000  349164.000000   
mean        4.758420      -0.810611       0.385943       0.089919   
min         1.521139      -1.000000       0.158199       0.026830   
25%         2.129509      -1.000000       0.170760       0.038360   
50%         3.459919      -0.999927       0.264501       0.057985   
75%         7.893371      -0.634693       0.396469       0.137638   
max        11.877831      -0.244331       1.523884       0.299631   
std         3.185806       0.256066       0.331869       0.067359   

                    calculation_date                expiration_date  \
count                         349164                         349164   
mean   2008-09-10 19:16:43.278688256  2009-08-01 19:16:43.278688256   
min              2008-08-06 00:00:00            2008-10-05 00:00:00   
25%              2008-08-27 00:00:00            2008-12-14 00:00:00   
50%              2008-09-10 00:00:00            2009-06-17 12:00:00   
75%              2008-09-19 00:00:00            2010-03-04 00:00:00   
max              2008-11-05 00:00:00            2010-10-26 00:00:00   
std                              NaN                            NaN   

       observed_price  
count   349164.000000  
mean        61.910327  
min          0.000000  
25%         13.005623  
50%         51.174704  
75%        101.262824  
max        248.265625  
std         53.225516  

spot_price                  float64
strike_price                float64
barrier                     float64
days_to_maturity              int64
barrier_price               float64
updown                       object
outin                        object
w                            object
barrier_type_name            object
rebate                      float64
dividend_rate               float64
risk_free_rate              float64
theta                       float64
kappa                       float64
rho                         float64
eta                         float64
v0                          float64
calculation_date     datetime64[ns]
expiration_date      datetime64[ns]
observed_price              float64
dtype: object
in sample results:
     RMSE: 16.956206615359655
     MAE: 11.727691242919093

out of sample results:
     RMSE: 36.573337425018735
     MAE: 23.439296409810268

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     barrier
     barrier_type_name
     w

target: observed_price

cpu: 218.64953088760376
Wed Oct  9 14:58:00 2024