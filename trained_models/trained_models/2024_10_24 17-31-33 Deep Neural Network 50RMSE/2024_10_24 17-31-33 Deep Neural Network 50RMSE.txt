Thu Oct 24 17:26:41 2024
spot(s):
[1374.2  1377.99 1386.77 1386.98 1387.16 1391.82 1392.05 1395.15 1399.96
 1401.5  1401.77 1402.74 1403.05 1406.48 1406.64 1409.82 1410.74 1412.12
 1412.71 1414.71 1416.59 1416.97 1418.28 1420.46 1420.83 1422.42 1422.43
 1423.07 1423.8  1424.27 1424.44 1426.09 1428.02 1428.7  1428.81 1430.36
 1430.59 1430.69 1431.78 1433.55 1434.56 1434.69 1436.11 1437.38 1437.45
 1438.07 1438.45 1438.91 1439.15 1439.97 1443.66 1444.24 1444.47 1445.71
 1447.04 1447.77 1447.89 1448.38 1448.46 1449.6  1449.93 1451.23 1452.78
 1455.05 1455.51 1456.3  1456.93 1457.51 1459.53 1468.23 1470.62 1471.33
 1472.32 1480.49 1481.12 1482.47 1484.4  1486.09 1491.66 1494.22 1494.32
 1495.27 1496.   1501.4  1502.3  1503.36 1505.49 1506.   1507.68 1507.84
 1509.13 1512.52 1512.61 1513.95 1515.75 1522.16 1522.51 1523.96 1524.84]

strikes:
[1236.78    1240.191   1248.093   1248.282   1248.444   1252.638
 1252.845   1255.635   1259.964   1261.35    1261.593   1262.466
 1262.745   1265.832   1265.976   1268.838   1269.666   1270.908
 1271.135   1271.439   1273.239   1274.64075 1274.931   1275.273
 1276.452   1278.414   1278.747   1280.178   1280.187   1280.763
 1281.42    1281.843   1281.996   1282.76225 1282.9565  1283.123
 1283.481   1285.218   1285.83    1285.929   1287.324   1287.4335
 1287.531   1287.621   1287.64625 1288.602   1290.195   1290.51375
 1291.104   1291.221   1292.499   1293.642   1293.705   1294.263
 1294.605   1294.963   1295.019   1295.235   1295.973   1296.3875
 1296.63725 1297.5345  1297.82125 1299.294   1299.816   1300.023
 1300.994   1301.139   1301.142   1302.336   1302.993   1303.101
 1303.542   1303.614   1304.0835  1304.64    1304.9345  1304.937
 1305.49    1306.107   1306.211   1306.75675 1307.502   1308.60675
 1309.0905  1309.545   1309.959   1310.34575 1310.67    1310.69725
 1311.237   1311.759   1311.909   1313.577   1313.9255  1314.26775
 1315.7385  1315.74775 1316.33975 1317.015   1317.4315  1317.44975
 1317.607   1317.631   1317.802   1319.13325 1320.9185  1321.407
 1321.5475  1321.64925 1322.229   1322.4475  1323.083   1323.29575
 1323.38825 1323.558   1324.197   1324.3965  1325.088   1325.3925
 1326.03375 1326.968   1327.08825 1328.40175 1329.5765  1329.64125
 1329.962   1330.21475 1330.56625 1330.99175 1331.21375 1331.425
 1331.6815  1331.97225 1332.441   1332.603   1332.8975  1333.008
 1334.223   1335.3855  1335.922   1335.96    1336.13475 1336.156
 1336.308   1337.28175 1337.481   1338.512   1339.18725 1339.29825
 1339.329   1339.7515  1339.8255  1339.845   1340.203   1340.88
 1341.18525 1341.514   1342.0745  1342.38775 1342.494   1343.54025
 1343.8215  1343.9745  1344.798   1344.888   1345.743   1345.7605
 1345.92125 1346.1215  1346.34675 1346.4     1347.0775  1347.366
 1347.66025 1348.19675 1349.437   1349.7885  1350.06525 1351.26
 1351.299   1351.3085  1351.9165  1352.07    1352.10075 1352.3055
 1352.481   1352.61    1353.024   1353.0565  1353.218   1354.7855
 1354.941   1355.4     1356.619   1356.912   1357.0245  1357.056
 1357.24875 1357.265   1357.3695  1358.11275 1358.217   1358.842
 1359.0605  1359.1555  1360.191   1360.27125 1360.3235  1360.98025
 1361.268   1361.349   1361.8725  1361.896   1362.555   1362.832
 1362.9555  1364.175   1364.3045  1364.961   1365.511   1365.5775
 1366.1665  1366.4625  1366.5275  1366.72575 1366.9645  1367.1925
 1367.6715  1367.9715  1367.97375 1369.45325 1369.944   1370.036
 1370.259   1371.28475 1371.318   1371.474   1371.477   1371.564
 1372.028   1372.2465  1372.356   1373.07    1373.4245  1374.2
 1374.5745  1374.63325 1374.688   1375.3815  1375.4715  1375.4955
 1375.961   1376.037   1376.817   1377.12    1377.39225 1377.4335
 1377.99    1378.6685  1379.34225 1379.7855  1380.141   1381.17525
 1381.54575 1382.1535  1382.246   1382.2975  1382.7345  1382.823
 1383.12475 1383.485   1383.8     1384.0835  1384.6345  1384.9485
 1385.30925 1386.5535  1386.77    1386.8595  1386.86925 1386.98
 1387.16    1387.49325 1388.205   1388.66325 1388.795   1388.829
 1389.6275  1390.43775 1390.608   1391.82    1392.05    1392.3195
 1392.57825 1392.9825  1393.05    1393.08975 1394.601   1394.604
 1394.752   1394.8185  1394.82525 1394.92275 1395.15    1395.94525
 1395.9855  1397.089   1397.71125 1397.7635  1398.696   1398.704
 1398.82275 1399.081   1399.16425 1399.96    1400.20725 1400.40375
 1401.4455  1401.5     1401.51375 1401.77    1402.06875 1402.11825
 1402.48875 1402.74    1402.93725 1403.05    1403.17125 1403.97075
 1406.4655  1406.48    1406.64    1407.064   1407.5685  1407.998
 1408.134   1408.32175 1408.3465  1408.35825 1408.555   1409.56725
 1409.663   1409.82    1410.18    1410.477   1410.74    1410.864
 1411.57575 1411.69275 1411.7855  1412.12    1412.1705  1412.2485
 1412.43975 1412.71    1413.36    1413.68175 1414.71    1414.94925
 1416.4605  1416.59    1416.97    1417.077   1418.28    1418.67375
 1419.12225 1419.509   1419.604   1419.8925  1420.46    1420.5065
 1420.50675 1420.83    1421.07225 1421.2     1421.43925 1421.6545
 1421.839   1422.42    1422.43    1423.04175 1423.07    1423.8
 1424.27    1424.44    1426.09    1426.33    1426.6155  1426.85125
 1427.185   1428.02    1428.192   1428.7     1428.81    1430.02875
 1430.2155  1430.36    1430.59    1430.69    1430.7     1431.52425
 1431.78    1432.296   1432.448   1433.55    1433.6735  1433.8545
 1434.54675 1434.56    1434.69    1434.959   1435.512   1436.11
 1436.5375  1436.81425 1436.894   1436.9795  1437.38    1437.45
 1437.8085  1438.07    1438.12625 1438.2525  1438.45    1438.91
 1439.15    1439.9625  1439.97    1441.642   1441.806   1442.91
 1443.47775 1443.66    1444.092   1444.24    1444.47    1445.0655
 1445.40825 1445.71    1446.0085  1446.052   1446.3845  1446.8895
 1447.04    1447.29    1447.423   1447.762   1447.77    1447.89
 1448.02775 1448.38    1448.46    1448.598   1448.93775 1449.6
 1449.93    1450.07775 1451.23    1452.00475 1452.39425 1452.78
 1453.737   1454.3685  1455.05    1455.51    1455.9715  1456.1085
 1456.3     1456.329   1456.35075 1456.518   1456.8645  1456.93
 1456.962   1457.51    1457.88825 1457.9805  1457.99075 1458.6
 1458.64675 1459.395   1459.53    1459.87675 1460.051   1461.411
 1461.6525  1461.74225 1463.7205  1463.865   1464.4175  1464.53025
 1464.7425  1464.9075  1465.776   1466.119   1466.35475 1466.45725
 1467.5745  1467.85275 1468.23    1468.35    1469.38875 1469.958
 1469.988   1470.144   1470.424   1470.55725 1470.62    1471.33
 1471.40175 1471.575   1471.8585  1472.01275 1472.32    1472.877
 1473.2025  1473.3145  1473.38625 1474.02175 1474.41125 1474.707
 1474.79475 1474.88275 1475.12875 1475.96925 1476.10125 1476.804
 1476.972   1477.265   1477.85625 1479.7515  1480.311   1480.346
 1480.49    1480.58175 1481.12    1481.277   1481.33925 1481.85275
 1482.47    1482.726   1483.216   1483.3455  1483.96425 1484.08725
 1484.106   1484.4     1484.44725 1484.5895  1484.6715  1485.4455
 1485.84    1485.861   1486.09    1486.17825 1486.719   1487.4195
 1487.51075 1487.8185  1489.0995  1489.194   1490.77775 1491.0035
 1491.197   1491.42625 1491.483   1491.66    1491.8715  1491.89775
 1492.7075  1493.35325 1493.541   1493.5515  1493.94775 1494.22
 1494.2235  1494.32    1494.99    1495.27    1495.4835  1495.662
 1496.      1496.01825 1496.2065  1496.45375 1497.3945  1499.421
 1499.78625 1500.135   1500.2505  1501.4     1501.878   1502.1195
 1502.2245  1502.3     1503.36    1503.369   1504.93575 1504.957
 1505.2275  1505.49    1506.      1506.288   1506.4245  1506.6125
 1506.90275 1507.3855  1507.68    1507.84    1507.9155  1507.9455
 1508.11325 1508.27875 1509.128   1509.13    1509.249   1509.3225
 1509.9735  1510.3725  1510.8555  1511.1075  1511.62    1511.966
 1511.9685  1512.138   1512.52    1512.61    1513.95    1515.5565
 1515.75    1515.789   1515.843   1516.452   1516.5455  1516.6935
 1517.50225 1517.9955  1518.029   1518.148   1518.66325 1519.392
 1519.53175 1520.1585  1520.2845  1520.799   1520.81325 1520.883
 1521.51    1522.08    1522.16    1522.4265  1522.51    1522.83425
 1523.24225 1523.24275 1523.7915  1523.96    1524.651   1524.84
 1525.419   1525.447   1525.678   1525.876   1526.9945  1527.39225
 1527.8025  1528.2855  1528.9515  1529.1015  1529.11225 1529.115
 1529.7765  1529.80025 1530.3855  1530.585   1531.002   1531.09025
 1531.255   1531.273   1531.5755  1531.678   1532.5065  1532.65175
 1533.04675 1533.4     1534.665   1535.1215  1535.8525  1535.97075
 1537.637   1537.88425 1537.99175 1538.935   1539.1635  1539.8575
 1539.956   1540.944   1541.06625 1541.6415  1541.65    1541.947
 1542.152   1542.29175 1543.014   1543.12725 1543.355   1543.65
 1543.81825 1544.151   1544.8965  1545.1835  1545.25875 1545.372
 1545.536   1545.92525 1545.936   1546.33375 1546.82825 1546.85825
 1547.08625 1547.128   1547.304   1547.96775 1550.333   1550.42525
 1550.802   1551.79875 1551.814   1551.9345  1552.558   1552.80525
 1553.332   1553.64375 1553.981   1554.13825 1554.5145  1555.176
 1555.568   1556.181   1556.35275 1556.48175 1556.5935  1557.0085
 1557.0945  1558.249   1558.32    1558.62    1558.667   1558.67475
 1560.07225 1560.108   1560.214   1560.3945  1560.57275 1561.7385
 1562.059   1562.506   1562.913   1562.961   1564.17875 1564.662
 1564.673   1564.67325 1565.377   1565.5225  1566.18    1566.19975
 1566.243   1566.697   1566.82325 1566.884   1568.699   1568.931
 1568.99475 1569.036   1570.0335  1570.8     1570.822   1571.57
 1571.691   1573.396   1573.649   1573.759   1574.958   1576.47
 1576.905   1577.415   1578.016   1578.159   1578.34725 1578.528
 1579.721   1580.7645  1580.9165  1581.118   1581.195   1581.3
 1581.67975 1581.877   1582.295   1582.744   1582.801   1583.064
 1583.065   1583.232   1583.967   1584.5865  1588.026   1588.146
 1588.2405  1588.664   1588.917   1589.6475  1590.281   1591.52675
 1591.5375  1591.744   1592.204   1592.547   1592.679   1593.218
 1593.306   1593.65525 1594.56    1594.923   1595.73    1596.353
 1597.54675 1598.058   1598.268   1598.6355  1600.158   1600.555
 1601.061   1601.082   1601.93    1602.623   1603.261   1603.5345
 1605.483   1606.2865  1606.394   1607.41525 1608.2     1614.005
 1614.9725  1615.053   1616.112   1617.682   1618.40175 1618.463
 1618.95    1619.552   1620.756   1620.928   1622.31475 1625.959
 1626.05575 1627.49625 1628.539   1629.232   1629.43125 1630.717
 1632.84    1634.699   1636.322   1636.69825 1638.257   1639.203
 1640.826   1643.642   1643.752   1644.797   1645.6     1651.54
 1652.53    1653.696   1656.039   1656.6     1658.448   1658.624
 1660.043   1663.772   1663.871   1665.345   1667.325   1674.376
 1674.761   1676.356   1677.324  ]

maturities:
[ 60  90 180 360 540 720]

types:
['call' 'put']

['DownOut' 'DownIn' 'UpOut' 'UpIn']
averaging_type:
number of calls, puts:
108000,108000

total prices:
216000
Deep Neural Network
hidden layers sizes: (13, 13, 13)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
        spot_price  strike_price      barrier  days_to_maturity       rebate  \
count 216000.00000  216000.00000 216000.00000      216000.00000 216000.00000   
mean    1448.21660    1448.21660   1448.21660         325.00000      0.00000   
min     1374.20000    1236.78000    687.10000          60.00000      0.00000   
25%     1422.02250    1366.38850   1074.83944          90.00000      0.00000   
50%     1441.81500    1447.35650   1442.33045         270.00000      0.00000   
75%     1480.64750    1528.45200   1808.32009         540.00000      0.00000   
max     1524.84000    1677.32400   2287.26000         720.00000      0.00000   
std       38.62485     101.17814    448.28530         241.50625      0.00000   

       dividend_rate  risk_free_rate        theta        kappa          rho  \
count   216000.00000    216000.00000 216000.00000 216000.00000 216000.00000   
mean         0.01864         0.04000      0.03449      1.54806     -0.91300   
min          0.01780         0.04000      0.01992      0.03970     -1.00000   
25%          0.01813         0.04000      0.02178      0.67606     -1.00000   
50%          0.01859         0.04000      0.02431      1.05762     -1.00000   
75%          0.01915         0.04000      0.03114      2.11859     -0.77610   
max          0.01974         0.04000      0.40505     12.32603     -0.34710   
std          0.00055         0.00000      0.04006      1.64163      0.15717   

               eta           v0               calculation_date  barrier_price  \
count 216000.00000 216000.00000                         216000   216000.00000   
mean       0.12996      0.01205  2007-03-16 00:14:23.999999744       38.30084   
min        0.08818      0.00524            2007-01-03 00:00:00        0.00000   
25%        0.10263      0.00830            2007-02-07 18:00:00        0.07799   
50%        0.10901      0.01198            2007-03-15 12:00:00       12.69709   
75%        0.12649      0.01380            2007-04-20 18:00:00       64.15642   
max        0.70802      0.03170            2007-05-25 00:00:00      252.11701   
std        0.08240      0.00497                            NaN       50.26165   

       observed_price  
count    216000.00000  
mean         38.30200  
min           0.00000  
25%           0.08296  
50%          12.69626  
75%          64.14229  
max         252.15892  
std          50.26077  
#############
# test data #
#############
         spot_price  strike_price       barrier  days_to_maturity  \
count 3010680.00000 3010680.00000 3010680.00000     3010680.00000   
mean     1226.75927    1226.75927    1226.75927         323.22910   
min       676.03000     608.42700     338.01500          60.00000   
25%      1099.45000    1089.29000     877.77080          90.00000   
50%      1267.76000    1246.53775    1204.33448         180.00000   
75%      1370.20000    1380.93150    1528.77308         540.00000   
max      1565.18000    1721.69800    2347.77000         720.00000   
std       193.73254     209.66463     429.09777         241.30482   

             rebate  dividend_rate  risk_free_rate         theta  \
count 3010680.00000  3010680.00000   3010680.00000 3010680.00000   
mean        0.00000        0.02217         0.04000       0.07068   
min         0.00000        0.01791         0.04000       0.02342   
25%         0.00000        0.01993         0.04000       0.05322   
50%         0.00000        0.02159         0.04000       0.06273   
75%         0.00000        0.02276         0.04000       0.07490   
max         0.00000        0.03773         0.04000       0.35610   
std         0.00000        0.00347         0.00000       0.03304   

              kappa           rho           eta            v0  \
count 3010680.00000 3010680.00000 3010680.00000 3010680.00000   
mean        3.11697      -0.88889       0.22035       0.05459   
min         0.08326      -1.00000       0.10989       0.00739   
25%         1.62844      -1.00000       0.16426       0.02066   
50%         2.41118      -0.99997       0.18868       0.03432   
75%         4.22586      -0.83105       0.22930       0.05839   
max        15.99144      -0.18176       1.52882       0.69402   
std         2.15832       0.18073       0.13079       0.06233   

                    calculation_date  barrier_price  observed_price  
count                        3010680  3010680.00000   3010680.00000  
mean   2010-03-19 01:36:25.483678208       49.73170        49.73239  
min              2007-05-29 00:00:00        0.00000         0.00000  
25%              2008-10-28 00:00:00        1.34306         1.34290  
50%              2010-03-25 00:00:00       26.55503        26.55704  
75%              2011-08-11 00:00:00       87.11860        87.11947  
max              2012-12-31 00:00:00      293.09806       293.07380  
std                              NaN       55.44691        55.44633  

spot_price                  float64
strike_price                float64
barrier                     float64
days_to_maturity              int64
updown                       object
outin                        object
w                            object
barrier_type_name            object
rebate                      float64
dividend_rate               float64
risk_free_rate              float64
theta                       float64
kappa                       float64
rho                         float64
eta                         float64
v0                          float64
calculation_date     datetime64[ns]
barrier_price               float64
observed_price              float64
dtype: object
in sample results:
     RMSE: 4.698364674058325
     MAE: 3.0770484563643716

out of sample results:
     RMSE: 50.080127438029955
     MAE: 20.2497888745519

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     barrier
     barrier_type_name
     w

target: observed_price

cpu: 291.321035861969
Thu Oct 24 17:31:33 2024