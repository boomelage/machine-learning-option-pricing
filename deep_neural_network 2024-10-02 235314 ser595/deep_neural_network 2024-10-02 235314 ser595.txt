
        spot_price  strike_price   barrier  days_to_maturity updown outin  \
1          1416.59      1274.931   708.295                30   Down   Out   
3          1416.59      1274.931   708.295                30   Down    In   
5          1416.59      1274.931   708.295                60   Down   Out   
7          1416.59      1274.931   708.295                60   Down    In   
9          1416.59      1274.931   708.295                90   Down   Out   
...            ...           ...       ...               ...    ...   ...   
109811     1503.36      1428.192  2255.040                90     Up    In   
109813     1503.36      1428.192  2255.040               180     Up   Out   
109815     1503.36      1428.192  2255.040               180     Up    In   
109817     1503.36      1428.192  2255.040               360     Up   Out   
109819     1503.36      1428.192  2255.040               360     Up    In   

          w barrier_type_name  rebate  dividend_rate  risk_free_rate  \
1       put           DownOut     0.0       0.018125            0.04   
3       put            DownIn     0.0       0.018125            0.04   
5       put           DownOut     0.0       0.018125            0.04   
7       put            DownIn     0.0       0.018125            0.04   
9       put           DownOut     0.0       0.018125            0.04   
...     ...               ...     ...            ...             ...   
109811  put              UpIn     0.0       0.018591            0.04   
109813  put             UpOut     0.0       0.018591            0.04   
109815  put              UpIn     0.0       0.018591            0.04   
109817  put             UpOut     0.0       0.018591            0.04   
109819  put              UpIn     0.0       0.018591            0.04   

           theta     kappa  rho       eta        v0   calculation_date  \
1       0.082956  0.233438 -1.0  0.098497  0.010662  January 3rd, 2007   
3       0.082956  0.233438 -1.0  0.098497  0.010662  January 3rd, 2007   
5       0.082956  0.233438 -1.0  0.098497  0.010662  January 3rd, 2007   
7       0.082956  0.233438 -1.0  0.098497  0.010662  January 3rd, 2007   
9       0.082956  0.233438 -1.0  0.098497  0.010662  January 3rd, 2007   
...          ...       ...  ...       ...       ...                ...   
109811  0.025177  1.040589 -1.0  0.114790  0.015250     May 14th, 2007   
109813  0.025177  1.040589 -1.0  0.114790  0.015250     May 14th, 2007   
109815  0.025177  1.040589 -1.0  0.114790  0.015250     May 14th, 2007   
109817  0.025177  1.040589 -1.0  0.114790  0.015250     May 14th, 2007   
109819  0.025177  1.040589 -1.0  0.114790  0.015250     May 14th, 2007   

        barrier_price  moneyness moneyness_tag  observed_price  
1            0.026056      -0.10           otm        0.051730  
3           -0.003565      -0.10           otm        0.065151  
5            0.485092      -0.10           otm        0.485092  
7           -0.011447      -0.10           otm        0.032515  
9            1.603317      -0.10           otm        1.647068  
...               ...        ...           ...             ...  
109811       0.001155      -0.05           otm        0.230272  
109813      22.913833      -0.05           otm       22.913833  
109815       0.007933      -0.05           otm        0.033829  
109817      40.006981      -0.05           otm       40.066527  
109819       0.014560      -0.05           otm        0.014560  

[21180 rows x 21 columns]

         spot_price  strike_price       barrier  days_to_maturity   rebate  \
count  21180.000000  21180.000000  21180.000000      21180.000000  21180.0   
mean    1436.617479   1338.191324   1436.617479        155.552408      0.0   
std       31.880807     46.470825    444.147798        116.391403      0.0   
min     1374.200000   1240.191000    687.100000         30.000000      0.0   
25%     1416.590000   1303.101000   1063.874900         60.000000      0.0   
50%     1428.020000   1339.329000   1430.755900         90.000000      0.0   
75%     1452.780000   1369.370333   1792.165100        219.000000      0.0   
max     1512.520000   1436.894000   2268.780000        360.000000      0.0   

       dividend_rate  risk_free_rate         theta         kappa  \
count   21180.000000    2.118000e+04  21180.000000  21180.000000   
mean        0.018533    4.000000e-02      0.045647      1.306448   
std         0.000538    8.999958e-15      0.043429      1.611777   
min         0.017798    4.000000e-02      0.019921      0.039700   
25%         0.018125    4.000000e-02      0.022321      0.233438   
50%         0.018430    4.000000e-02      0.026405      0.905913   
75%         0.019091    4.000000e-02      0.073710      1.879964   
max         0.019742    4.000000e-02      0.405049     12.326035   

                rho           eta            v0  barrier_price     moneyness  \
count  21180.000000  21180.000000  21180.000000   21180.000000  21180.000000   
mean      -0.928805      0.123481      0.011565       6.242704     -0.068445   
std        0.145252      0.077677      0.004495      10.009401      0.027385   
min       -1.000000      0.088178      0.005244      -0.036880     -0.100000   
25%       -1.000000      0.098497      0.009033       0.001892     -0.100000   
50%       -1.000000      0.104794      0.010662       0.916313     -0.050000   
75%       -1.000000      0.116201      0.012767       7.979742     -0.050000   
max       -0.347098      0.708018      0.031695      53.923880     -0.011111   

       observed_price  
count    21180.000000  
mean         6.302867  
std         10.008414  
min         -0.036880  
25%          0.069959  
50%          0.994708  
75%          8.067469  
max         54.051361  

spot(s):
[1374.2  1377.99 1386.77 1386.98 1387.16 1391.82 1392.05 1395.15 1399.96
 1401.5  1401.77 1402.74 1403.05 1406.48 1406.64 1409.82 1410.74 1412.12
 1412.71 1414.71 1416.59 1416.97 1418.28 1420.46 1420.83 1422.42 1422.43
 1423.07 1423.8  1424.27 1424.44 1426.09 1428.02 1428.7  1428.81 1430.36
 1430.59 1430.69 1431.78 1433.55 1434.56 1434.69 1436.11 1437.38 1437.45
 1438.07 1438.45 1438.91 1439.15 1439.97 1443.66 1444.24 1444.47 1445.71
 1447.04 1447.77 1447.89 1448.38 1448.46 1449.6  1449.93 1451.23 1452.78
 1455.05 1455.51 1456.3  1456.93 1457.51 1459.53 1468.23 1470.62 1471.33
 1472.32 1480.49 1481.12 1482.47 1484.4  1486.09 1491.66 1494.22 1494.32
 1495.27 1496.   1502.3  1503.36 1505.49 1506.   1507.84 1509.13 1512.52]

strikes:
[1240.191      1248.093      1248.282      1248.444      1252.638
 1252.845      1255.635      1259.964      1261.593      1265.832
 1265.976      1268.838      1270.908      1271.439      1273.239
 1274.931      1276.452      1278.414      1278.747      1280.178
 1280.763      1281.42       1281.843      1281.996      1283.481
 1285.218      1285.83       1285.929      1287.531      1287.621
 1288.602      1290.195      1291.104      1291.221      1292.499
 1293.642      1293.705      1294.263      1294.605      1299.294
 1299.816      1302.336      1302.993      1303.101      1303.614
 1304.64       1305.49       1306.107      1306.41077778 1307.502
 1309.0905     1309.545      1309.959      1310.67       1311.237
 1311.759      1313.577      1317.4315     1317.631      1317.802
 1321.407      1322.229      1322.4475     1323.558      1324.197
 1325.088      1325.3925     1329.962      1331.425      1331.6815
 1332.441      1332.603      1332.8975     1333.008      1335.96
 1336.156      1336.308      1337.481      1337.89055556 1339.329
 1340.203      1341.514      1342.0745     1343.9745     1344.798
 1344.888      1345.743      1345.7605     1346.1215     1346.4
 1347.366      1349.437      1349.7885     1351.299      1351.3085
 1351.9165     1352.07       1352.61       1353.024      1353.0565
 1353.218      1354.7855     1354.941      1355.4        1356.619
 1357.056      1357.265      1357.3695     1358.217      1358.842
 1359.0605     1359.1555     1360.191      1361.268      1361.8725
 1362.832      1362.9555     1364.3045     1365.511      1365.5775
 1366.1665     1366.5275     1366.9645     1367.1925     1367.9715
 1369.37033333 1371.477      1372.028      1372.2465     1373.4245
 1374.688      1375.3815     1375.4955     1375.961      1376.037
 1377.12       1377.4335     1378.6685     1380.141      1382.2975
 1382.7345     1383.485      1384.0835     1384.6345     1386.5535
 1394.8185     1397.089      1397.7635     1398.704      1400.85011111
 1406.4655     1407.064      1408.3465     1410.18       1411.7855
 1417.077      1419.509      1419.604      1420.5065     1421.2
 1427.185      1428.192      1430.2155     1430.7        1432.448
 1433.6735     1436.894     ]

maturities:
[ 30  37  44  51  58  60  65  72  79  86  90  93 100 107 114 121 128 135
 142 149 156 163 170 177 180 184 191 198 205 212 219 226 233 240 247 254
 261 268 275 282 289 296 303 310 317 324 331 338 345 352 359 360]

types:
['put']

['otm']

['DownOut' 'DownIn' 'UpOut' 'UpIn']
moneyness:
[-0.1        -0.1        -0.07777778 -0.05555556 -0.05       -0.05
 -0.05       -0.05       -0.03333333 -0.01111111]

number of calls, puts:
{train_contracts.n_calls},{train_contracts.n_puts}

initial count:
110120

total prices:
21180

        spot_price  strike_price  days_to_maturity  risk_free_rate  \
count   212.000000    212.000000        212.000000    2.120000e+02   
mean   1439.427123   1341.377794        155.287736    4.000000e-02   
std      33.227838     48.466494        115.581642    2.086595e-17   
min    1374.200000   1248.093000         30.000000    4.000000e-02   
25%    1416.590000   1305.277500         60.000000    4.000000e-02   
50%    1429.700000   1346.121500        117.500000    4.000000e-02   
75%    1456.300000   1373.424500        205.000000    4.000000e-02   
max    1512.520000   1436.894000        360.000000    4.000000e-02   

       dividend_rate   moneyness      target  prediciton  abs_relative_error  
count     212.000000  212.000000  212.000000  212.000000          212.000000  
mean        0.018526   -0.068056    7.388600    6.678819                 inf  
std         0.000518    0.028151   10.981071    7.621530                 NaN  
min         0.017798   -0.100000   -0.011955   -0.515600            0.008325  
25%         0.018125   -0.100000    0.064505    0.877986            0.328399  
50%         0.018467   -0.050000    1.747844    3.509888            0.770736  
75%         0.018861   -0.050000   10.890171    9.874328           23.200159  
max         0.019742   -0.011111   52.262268   33.649042                 inf  


Deep Neural Network
hidden layers sizes: (10, 10, 10)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001