
        spot_price  strike_price      barrier  days_to_maturity  \
0          1416.59      1274.931   708.295000                60   
1          1416.59      1274.931   708.295000                60   
2          1416.59      1274.931   881.827275                60   
4          1416.59      1274.931  1055.359550                60   
6          1416.59      1274.931  1228.891825                60   
...            ...           ...          ...               ...   
308393     1420.46      1562.506  2130.690000               180   
308394     1420.46      1562.506  2130.690000               360   
308396     1420.46      1562.506  2130.690000               540   
308398     1420.46      1562.506  2130.690000               720   
308399     1420.46      1562.506  2130.690000               720   

        barrier_price updown outin     w barrier_type_name  rebate  \
0            0.485092   Down   Out   put           DownOut     0.0   
1           -0.011447   Down    In   put            DownIn     0.0   
2            0.479647   Down   Out   put           DownOut     0.0   
4            0.475925   Down   Out   put           DownOut     0.0   
6            0.154411   Down   Out   put           DownOut     0.0   
...               ...    ...   ...   ...               ...     ...   
308393      -0.024262     Up    In  call              UpIn     0.0   
308394      28.668573     Up   Out  call             UpOut     0.0   
308396      49.251003     Up   Out  call             UpOut     0.0   
308398      67.930067     Up   Out  call             UpOut     0.0   
308399       0.881593     Up    In  call              UpIn     0.0   

        dividend_rate  risk_free_rate     theta     kappa  rho       eta  \
0            0.018125            0.04  0.082956  0.233438 -1.0  0.098497   
1            0.018125            0.04  0.082956  0.233438 -1.0  0.098497   
2            0.018125            0.04  0.082956  0.233438 -1.0  0.098497   
4            0.018125            0.04  0.082956  0.233438 -1.0  0.098497   
6            0.018125            0.04  0.082956  0.233438 -1.0  0.098497   
...               ...             ...       ...       ...  ...       ...   
308393       0.019297            0.04  0.023575  0.798784 -1.0  0.109318   
308394       0.019297            0.04  0.023575  0.798784 -1.0  0.109318   
308396       0.019297            0.04  0.023575  0.798784 -1.0  0.109318   
308398       0.019297            0.04  0.023575  0.798784 -1.0  0.109318   
308399       0.019297            0.04  0.023575  0.798784 -1.0  0.109318   

              v0 calculation_date expiration_date  observed_price  moneyness  
0       0.010662       2007-01-03      2007-03-04        0.536276  -0.100000  
1       0.010662       2007-01-03      2007-03-04        0.118147  -0.100000  
2       0.010662       2007-01-03      2007-03-04        0.385551  -0.100000  
4       0.010662       2007-01-03      2007-03-04        0.677766  -0.100000  
6       0.010662       2007-01-03      2007-03-04        0.064777  -0.100000  
...          ...              ...             ...             ...        ...  
308393  0.016910       2007-03-30      2007-09-26        0.067297  -0.090909  
308394  0.016910       2007-03-30      2008-03-24       28.687431  -0.090909  
308396  0.016910       2007-03-30      2008-09-20       49.289928  -0.090909  
308398  0.016910       2007-03-30      2009-03-19       68.105070  -0.090909  
308399  0.016910       2007-03-30      2009-03-19        0.735294  -0.090909  

[114947 rows x 21 columns]
          spot_price   strike_price        barrier  days_to_maturity  \
count  114947.000000  114947.000000  114947.000000     114947.000000   
mean     1424.164027    1423.803102    1418.907634        336.362932   
min      1374.200000    1240.191000     687.100000         60.000000   
25%      1409.820000    1352.236667    1065.618200         90.000000   
50%      1426.090000    1422.107556    1423.006200        360.000000   
75%      1439.970000    1495.274667    1777.820450        540.000000   
max      1459.530000    1605.483000    2189.295000        720.000000   
std        21.747394      85.034264     428.896681        242.956014   

       barrier_price    rebate  dividend_rate  risk_free_rate          theta  \
count  114947.000000  114947.0  114947.000000    1.149470e+05  114947.000000   
mean       37.584737       0.0       0.018600    4.000000e-02       0.035703   
min        -0.227968       0.0       0.017798    4.000000e-02       0.019921   
25%         1.053570       0.0       0.017948    4.000000e-02       0.021034   
50%        18.300131       0.0       0.018566    4.000000e-02       0.022782   
75%        63.414000       0.0       0.019288    4.000000e-02       0.028666   
max       215.972553       0.0       0.019742    4.000000e-02       0.405049   
std        44.084531       0.0       0.000660    3.133618e-14       0.050069   

               kappa            rho            eta             v0  \
count  114947.000000  114947.000000  114947.000000  114947.000000   
mean        1.989752      -0.857557       0.144501       0.011665   
min         0.039700      -1.000000       0.088178       0.005244   
25%         0.759625      -1.000000       0.100282       0.006898   
50%         1.680576      -1.000000       0.115760       0.009265   
75%         2.502446      -0.753981       0.130876       0.015451   
max        12.326035      -0.347098       0.708018       0.031695   
std         1.976896       0.181159       0.103980       0.006236   

                    calculation_date                expiration_date  \
count                         114947                         114947   
mean   2007-02-15 16:24:06.677164288  2008-01-18 01:06:44.043602688   
min              2007-01-03 00:00:00            2007-03-04 00:00:00   
25%              2007-01-25 00:00:00            2007-05-28 00:00:00   
50%              2007-02-15 00:00:00            2008-01-11 00:00:00   
75%              2007-03-09 00:00:00            2008-08-16 00:00:00   
max              2007-03-30 00:00:00            2009-03-19 00:00:00   
std                              NaN                            NaN   

       observed_price      moneyness  
count   114947.000000  114947.000000  
mean        37.604064      -0.007171  
min          0.000017      -0.100000  
25%          1.047397      -0.055556  
50%         18.308799      -0.010989  
75%         63.445261       0.034483  
max        216.054110       0.084337  
std         44.068975       0.056803  

spot(s):
[1374.2  1377.99 1386.77 1386.98 1387.16 1391.82 1392.05 1395.15 1399.96
 1401.5  1401.77 1402.74 1403.05 1406.48 1406.64 1409.82 1410.74 1412.12
 1412.71 1414.71 1416.59 1416.97 1418.28 1420.46 1420.83 1422.42 1422.43
 1423.07 1423.8  1424.27 1426.09 1428.02 1428.7  1428.81 1430.36 1430.59
 1430.69 1431.78 1433.55 1434.56 1434.69 1436.11 1437.38 1438.07 1438.45
 1439.97 1444.24 1445.71 1447.04 1447.89 1448.38 1448.46 1449.6  1449.93
 1451.23 1455.05 1455.51 1456.3  1456.93 1457.51 1459.53]

strikes:
[1240.191      1248.093      1248.282      1248.444      1252.638
 1252.845      1255.635      1259.964      1261.35       1261.593
 1262.466      1265.832      1265.976      1267.31777778 1268.838
 1270.813      1270.908      1271.439      1273.239      1274.931
 1275.273      1276.452      1278.414      1278.747      1278.91011111
 1279.10377778 1279.26977778 1280.178      1280.187      1280.763
 1281.42       1281.843      1283.481      1283.56733333 1283.77944444
 1285.218      1285.83       1285.929      1286.63833333 1287.531
 1287.621      1288.602      1290.195      1291.07422222 1291.104
 1291.221      1292.49444444 1292.499      1292.74344444 1293.638
 1293.642      1293.92388889 1294.263      1294.605      1297.08711111
 1297.23466667 1297.85555556 1299.816      1300.16733333 1301.01577778
 1301.139      1301.435      1302.28844444 1302.336      1302.83255556
 1303.101      1303.542      1303.614      1304.64       1304.677
 1304.937      1306.107      1306.41077778 1306.76122222 1307.96933333
 1309.545      1309.72722222 1309.92555556 1309.959      1309.97977778
 1310.09555556 1310.321      1310.67       1311.237      1311.759
 1311.78733333 1311.79655556 1312.38677778 1313.06       1313.49344444
 1313.577      1314.49666667 1314.71388889 1315.17188889 1316.95177778
 1317.57888889 1317.64166667 1317.68033333 1319.10977778 1319.32188889
 1319.41411111 1320.41933333 1322.05166667 1322.18444444 1322.98311111
 1323.103      1323.63888889 1323.89388889 1324.41255556 1324.81
 1325.10277778 1325.58377778 1326.22011111 1326.57055556 1327.97233333
 1328.34222222 1328.39333333 1328.49333333 1331.49666667 1331.91022222
 1332.057      1332.36555556 1333.26588889 1333.66888889 1334.22611111
 1334.49244444 1335.27633333 1335.72822222 1335.802      1336.115
 1336.85333333 1337.15766667 1337.89055556 1338.24944444 1338.35655556
 1339.329      1339.48666667 1340.54433333 1340.74733333 1340.92133333
 1341.514      1341.54555556 1341.87944444 1341.895      1342.0745
 1342.30366667 1343.03222222 1343.39666667 1343.40611111 1343.61322222
 1343.9745     1344.01055556 1344.14811111 1344.7        1345.14388889
 1345.426      1345.64833333 1345.7605     1346.011      1346.86277778
 1347.366      1348.645      1348.68555556 1349.32777778 1349.43166667
 1350.89555556 1351.11277778 1351.20722222 1352.23666667 1353.29466667
 1353.90833333 1354.78333333 1354.86222222 1354.985      1355.04433333
 1355.982      1356.28166667 1356.32611111 1357.52555556 1358.17722222
 1358.53611111 1358.93111111 1359.59733333 1359.752      1359.97166667
 1362.679      1362.826      1363.71533333 1364.00444444 1365.04933333
 1365.39277778 1365.61966667 1366.64888889 1367.45166667 1367.553
 1367.91444444 1367.99       1369.06666667 1369.37033333 1369.37833333
 1369.73766667 1370.60611111 1371.004      1371.36144444 1371.56911111
 1371.74711111 1373.11133333 1373.469      1374.21388889 1374.64833333
 1375.006      1375.01566667 1375.39444444 1375.63433333 1375.98944444
 1376.34       1376.35533333 1376.53722222 1376.58277778 1376.79433333
 1378.445      1378.55366667 1379.64833333 1380.41933333 1381.07666667
 1381.183      1382.68133333 1382.90366667 1383.00033333 1384.054
 1384.40488889 1385.765      1385.92777778 1386.19477778 1386.74133333
 1386.867      1387.154      1387.46055556 1388.23966667 1389.46733333
 1389.46888889 1390.13433333 1390.50166667 1390.85244444 1391.01066667
 1391.971      1393.301      1394.15533333 1395.06511111 1396.09866667
 1396.42977778 1397.01322222 1397.51966667 1398.80533333 1398.991
 1399.627      1400.10066667 1400.178      1400.85011111 1401.22588889
 1401.28       1401.599      1402.17855556 1402.39088889 1402.52133333
 1402.57288889 1402.85566667 1404.67711111 1405.043      1406.54833333
 1406.61533333 1406.62522222 1406.993      1407.25811111 1407.28466667
 1407.51722222 1407.75666667 1407.98       1408.36566667 1408.44477778
 1408.92633333 1409.82       1410.24455556 1410.65166667 1410.879
 1412.12       1412.15311111 1412.71       1412.82555556 1412.93433333
 1414.46711111 1414.69455556 1414.71       1414.79344444 1415.51511111
 1415.87133333 1416.59       1417.07222222 1417.34522222 1417.62166667
 1418.28       1418.326      1418.62044444 1418.63944444 1418.749
 1420.00666667 1420.15322222 1421.40911111 1422.09144444 1422.10755556
 1422.26933333 1422.46722222 1423.923      1423.97033333 1425.48466667
 1426.41488889 1427.81022222 1428.19288889 1428.40677778 1429.64655556
 1430.429      1430.96177778 1431.80233333 1432.28688889 1432.32988889
 1432.366      1432.71411111 1432.99566667 1433.21266667 1433.39866667
 1433.49333333 1433.81966667 1434.03866667 1435.10522222 1436.24288889
 1436.617      1438.214      1438.22466667 1438.23477778 1438.45166667
 1438.88188889 1438.88277778 1439.33766667 1439.62       1440.09522222
 1440.11888889 1440.74188889 1441.31544444 1441.655      1441.93544444
 1443.313      1443.88688889 1444.57444444 1444.68566667 1446.25288889
 1446.48544444 1446.58655556 1446.62533333 1447.68866667 1448.21666667
 1448.49566667 1449.47833333 1449.498      1449.81833333 1450.49955556
 1450.54444444 1450.631      1452.06677778 1453.35088889 1453.36266667
 1453.528      1454.04855556 1454.43277778 1454.545      1455.96966667
 1456.814      1457.76466667 1459.19066667 1459.80033333 1460.28711111
 1461.77344444 1461.867      1463.11822222 1463.80966667 1463.81277778
 1463.97766667 1464.03444444 1464.20233333 1464.22444444 1464.47311111
 1464.554      1465.556      1465.70666667 1466.04033333 1467.35477778
 1467.80866667 1468.191      1469.14333333 1469.38611111 1469.834
 1469.84433333 1470.50566667 1471.21722222 1471.26       1471.68233333
 1471.74566667 1472.48111111 1472.65833333 1473.11811111 1473.62633333
 1473.70455556 1475.62066667 1475.747      1476.32333333 1476.437
 1477.73555556 1478.03866667 1478.27633333 1478.37966667 1479.36111111
 1479.506      1479.64611111 1480.311      1480.67       1480.99722222
 1481.08222222 1481.335      1482.37866667 1482.513      1482.726
 1483.3455     1483.98033333 1484.61777778 1484.78666667 1485.167
 1485.29266667 1485.4455     1486.00566667 1486.39833333 1487.4195
 1487.969      1488.14333333 1489.11444444 1489.194      1490.57111111
 1491.19388889 1492.38133333 1493.305      1493.90033333 1494.62988889
 1494.85622222 1495.05022222 1495.27466667 1495.28944444 1495.69055556
 1496.153      1496.65933333 1496.742      1497.07333333 1497.92
 1498.261      1499.37444444 1499.60433333 1499.765      1500.07266667
 1500.32055556 1501.44333333 1501.45388889 1502.12944444 1502.9
 1503.39611111 1503.55166667 1503.66166667 1504.027      1504.84333333
 1505.31722222 1505.49433333 1506.09366667 1507.35444444 1508.07222222
 1508.181      1508.18833333 1508.84577778 1509.82444444 1510.06722222
 1510.17277778 1510.50555556 1510.79655556 1511.32333333 1511.62
 1511.842      1512.17611111 1513.19166667 1514.25777778 1514.395
 1515.789      1515.87288889 1515.89388889 1516.04533333 1517.23444444
 1517.96277778 1518.36388889 1519.47266667 1519.96833333 1520.46422222
 1521.95155556 1522.58744444 1524.47555556 1524.743      1525.447
 1525.678      1525.876      1526.02722222 1526.76922222 1527.17877778
 1527.43111111 1528.32833333 1528.59066667 1528.84555556 1528.93
 1530.13333333 1530.48166667 1530.94022222 1531.002      1531.255
 1531.339      1531.85388889 1533.05266667 1533.06344444 1533.75322222
 1534.54       1534.665      1535.04655556 1535.88611111 1536.37166667
 1537.00811111 1537.20555556 1537.87055556 1538.48277778 1539.08822222
 1539.82111111 1539.93966667 1539.956      1540.615      1541.61022222
 1541.65       1541.85811111 1541.947      1541.96588889 1543.014
 1543.14066667 1543.355      1545.04833333 1546.13688889 1546.277
 1547.128      1547.304      1547.80744444 1549.17622222 1549.91988889
 1550.32944444 1550.802      1551.814      1551.96766667 1553.332
 1553.981      1556.181      1556.56977778 1558.15411111 1558.249
 1558.667      1559.58755556 1560.108      1560.50366667 1561.03177778
 1561.118      1562.34666667 1562.506      1562.70233333 1562.913
 1564.10344444 1564.662      1564.673      1565.377      1566.18
 1566.697      1568.22055556 1568.699      1568.71633333 1569.56777778
 1570.24677778 1570.822      1570.87188889 1571.57       1571.691
 1573.049      1573.396      1573.649      1573.759      1574.958
 1576.905      1578.016      1578.159      1579.721      1581.118
 1581.877      1582.295      1583.967      1588.664      1590.281
 1591.744      1592.679      1593.218      1593.306      1594.56
 1594.923      1596.353      1600.555      1601.061      1601.93
 1602.623      1603.261      1605.483     ]

maturities:
[ 60  90 180 360 540 720]

types:
['call' 'put']

['DownOut' 'DownIn' 'UpOut' 'UpIn']

moneyness:
[-1.00000000e-01 -1.00000000e-01 -9.09090909e-02 -9.09090909e-02
 -7.77777778e-02 -7.77777778e-02 -7.77777778e-02 -7.21649485e-02
 -7.21649485e-02 -7.21649485e-02 -5.55555556e-02 -5.55555556e-02
 -5.55555556e-02 -5.26315789e-02 -5.26315789e-02 -5.26315789e-02
 -5.00000000e-02 -5.00000000e-02 -4.76190476e-02 -4.76190476e-02
 -3.33333333e-02 -3.33333333e-02 -3.33333333e-02 -3.22580645e-02
 -3.22580645e-02 -3.22580645e-02 -1.11111111e-02 -1.11111111e-02
 -1.11111111e-02 -1.09890110e-02 -1.09890110e-02 -1.09890110e-02
 -1.11022302e-16  0.00000000e+00  2.22044605e-16  1.11111111e-02
  1.11111111e-02  1.12359551e-02  1.12359551e-02  3.33333333e-02
  3.33333333e-02  3.44827586e-02  3.44827586e-02  5.00000000e-02
  5.00000000e-02  5.26315789e-02  5.55555556e-02  5.55555556e-02
  5.88235294e-02  5.88235294e-02  7.77777778e-02  7.77777778e-02
  8.43373494e-02  8.43373494e-02  8.43373494e-02]

number of calls, puts:
57390,57557

total prices:
114947

Deep Neural Network
hidden layers sizes: (10, 10, 10)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
          spot_price   strike_price        barrier  days_to_maturity  \
count  114947.000000  114947.000000  114947.000000     114947.000000   
mean     1424.164027    1423.803102    1418.907634        336.362932   
min      1374.200000    1240.191000     687.100000         60.000000   
25%      1409.820000    1352.236667    1065.618200         90.000000   
50%      1426.090000    1422.107556    1423.006200        360.000000   
75%      1439.970000    1495.274667    1777.820450        540.000000   
max      1459.530000    1605.483000    2189.295000        720.000000   
std        21.747394      85.034264     428.896681        242.956014   

       barrier_price    rebate  dividend_rate  risk_free_rate          theta  \
count  114947.000000  114947.0  114947.000000    1.149470e+05  114947.000000   
mean       37.584737       0.0       0.018600    4.000000e-02       0.035703   
min        -0.227968       0.0       0.017798    4.000000e-02       0.019921   
25%         1.053570       0.0       0.017948    4.000000e-02       0.021034   
50%        18.300131       0.0       0.018566    4.000000e-02       0.022782   
75%        63.414000       0.0       0.019288    4.000000e-02       0.028666   
max       215.972553       0.0       0.019742    4.000000e-02       0.405049   
std        44.084531       0.0       0.000660    3.133618e-14       0.050069   

               kappa            rho            eta             v0  \
count  114947.000000  114947.000000  114947.000000  114947.000000   
mean        1.989752      -0.857557       0.144501       0.011665   
min         0.039700      -1.000000       0.088178       0.005244   
25%         0.759625      -1.000000       0.100282       0.006898   
50%         1.680576      -1.000000       0.115760       0.009265   
75%         2.502446      -0.753981       0.130876       0.015451   
max        12.326035      -0.347098       0.708018       0.031695   
std         1.976896       0.181159       0.103980       0.006236   

                    calculation_date                expiration_date  \
count                         114947                         114947   
mean   2007-02-15 16:24:06.677164288  2008-01-18 01:06:44.043602688   
min              2007-01-03 00:00:00            2007-03-04 00:00:00   
25%              2007-01-25 00:00:00            2007-05-28 00:00:00   
50%              2007-02-15 00:00:00            2008-01-11 00:00:00   
75%              2007-03-09 00:00:00            2008-08-16 00:00:00   
max              2007-03-30 00:00:00            2009-03-19 00:00:00   
std                              NaN                            NaN   

       observed_price      moneyness  
count   114947.000000  114947.000000  
mean        37.604064      -0.007171  
min          0.000017      -0.100000  
25%          1.047397      -0.055556  
50%         18.308799      -0.010989  
75%         63.445261       0.034483  
max        216.054110       0.084337  
std         44.068975       0.056803  
#############
# test data #
#############
          spot_price   strike_price        barrier  days_to_maturity  \
count  267379.000000  267379.000000  267379.000000     267379.000000   
mean     1498.962142    1501.068496    1489.436963        337.562187   
min      1424.440000    1281.996000     712.220000         60.000000   
25%      1491.660000    1427.546204    1121.590050         90.000000   
50%      1502.300000    1500.414857    1497.394800        360.000000   
75%      1512.610000    1574.823510    1875.246100        540.000000   
max      1524.840000    1677.324000    2287.260000        720.000000   
std        20.616639      87.697785     450.529994        243.119326   

       barrier_price    rebate  dividend_rate  risk_free_rate          theta  \
count  267379.000000  267379.0  267379.000000    2.673790e+05  267379.000000   
mean       42.152806       0.0       0.018563    4.000000e-02       0.031379   
min        -0.291066       0.0       0.018269    4.000000e-02       0.021918   
25%         1.571642       0.0       0.018406    4.000000e-02       0.024053   
50%        22.017118       0.0       0.018564    4.000000e-02       0.025177   
75%        72.033966       0.0       0.018669    4.000000e-02       0.030926   
max       239.296089       0.0       0.019378    4.000000e-02       0.073563   
std        48.271415       0.0       0.000224    1.786560e-13       0.013176   

               kappa           rho            eta             v0  \
count  267379.000000  2.673790e+05  267379.000000  267379.000000   
mean        0.921953 -1.000000e+00       0.108957       0.012861   
min         0.184968 -1.000000e+00       0.099420       0.009710   
25%         0.684101 -1.000000e+00       0.106819       0.012158   
50%         1.040825 -1.000000e+00       0.108546       0.012531   
75%         1.173714 -1.000000e+00       0.110947       0.013296   
max         1.337983 -9.999998e-01       0.115768       0.016359   
std         0.330623  3.303062e-08       0.003340       0.001230   

                    calculation_date                expiration_date  \
count                         267379                         267379   
mean   2007-05-05 15:13:42.100464384  2008-04-07 04:43:15.057951744   
min              2007-04-02 00:00:00            2007-06-01 00:00:00   
25%              2007-04-27 00:00:00            2007-08-08 00:00:00   
50%              2007-05-07 00:00:00            2008-04-18 00:00:00   
75%              2007-05-16 00:00:00            2008-10-31 00:00:00   
max              2007-05-23 00:00:00            2009-05-12 00:00:00   
std                              NaN                            NaN   

       observed_price      moneyness  
count   267379.000000  267379.000000  
mean        42.172222      -0.001356  
min          0.000005      -0.100000  
25%          1.567559      -0.051020  
50%         22.019991      -0.002041  
75%         72.024615       0.046939  
max        239.478665       0.096197  
std         48.254993       0.056586  

in sample results:
     RMSE: 35.958675924269805
     MAE: 28.159880791004134

out of sample results:
     RMSE: 40.59048151535792
     MAE: 32.529159835620966
