
        spot_price  strike_price      barrier  days_to_maturity  \
0          1416.59      1274.931   708.295000                60   
1          1416.59      1274.931   881.827275                60   
2          1416.59      1274.931  1055.359550                60   
3          1416.59      1274.931  1228.891825                60   
4          1416.59      1274.931  1228.891825                60   
...            ...           ...          ...               ...   
917953     1492.47      1641.717  2238.705000               360   
917954     1492.47      1641.717  2238.705000               540   
917955     1492.47      1641.717  2238.705000               540   
917956     1492.47      1641.717  2238.705000               720   
917957     1492.47      1641.717  2238.705000               720   

        barrier_price updown outin     w barrier_type_name  rebate  \
0            0.485092   Down   Out   put           DownOut     0.0   
1            0.479647   Down   Out   put           DownOut     0.0   
2            0.475925   Down   Out   put           DownOut     0.0   
3            0.154411   Down   Out   put           DownOut     0.0   
4            0.319234   Down    In   put            DownIn     0.0   
...               ...    ...   ...   ...               ...     ...   
917953       3.346976     Up    In  call              UpIn     0.0   
917954      56.525604     Up   Out  call             UpOut     0.0   
917955      15.461891     Up    In  call              UpIn     0.0   
917956      59.224314     Up   Out  call             UpOut     0.0   
917957      35.150648     Up    In  call              UpIn     0.0   

        dividend_rate  risk_free_rate     theta     kappa       rho       eta  \
0            0.018125            0.04  0.082956  0.233438 -1.000000  0.098497   
1            0.018125            0.04  0.082956  0.233438 -1.000000  0.098497   
2            0.018125            0.04  0.082956  0.233438 -1.000000  0.098497   
3            0.018125            0.04  0.082956  0.233438 -1.000000  0.098497   
4            0.018125            0.04  0.082956  0.233438 -1.000000  0.098497   
...               ...             ...       ...       ...       ...       ...   
917953       0.019032            0.04  0.026229  6.804987 -0.433354  0.486135   
917954       0.019032            0.04  0.026229  6.804987 -0.433354  0.486135   
917955       0.019032            0.04  0.026229  6.804987 -0.433354  0.486135   
917956       0.019032            0.04  0.026229  6.804987 -0.433354  0.486135   
917957       0.019032            0.04  0.026229  6.804987 -0.433354  0.486135   

              v0 calculation_date expiration_date  observed_price  moneyness  
0       0.010662       2007-01-03      2007-03-04        0.722130  -0.100000  
1       0.010662       2007-01-03      2007-03-04        0.544200  -0.100000  
2       0.010662       2007-01-03      2007-03-04        0.319289  -0.100000  
3       0.010662       2007-01-03      2007-03-04        0.060630  -0.100000  
4       0.010662       2007-01-03      2007-03-04        0.182661  -0.100000  
...          ...              ...             ...             ...        ...  
917953  0.031430       2007-06-26      2008-06-20        3.586757  -0.090909  
917954  0.031430       2007-06-26      2008-12-17       56.291872  -0.090909  
917955  0.031430       2007-06-26      2008-12-17       15.576195  -0.090909  
917956  0.031430       2007-06-26      2009-06-15       59.307193  -0.090909  
917957  0.031430       2007-06-26      2009-06-15       35.093191  -0.090909  

[687101 rows x 21 columns]
          spot_price   strike_price        barrier  days_to_maturity  \
count  687101.000000  687101.000000  687101.000000     687101.000000   
mean     1490.669161    1489.199910    1488.549502        335.925155   
min      1374.200000    1236.780000     687.100000         60.000000   
25%      1480.490000    1413.567347    1120.003200         90.000000   
50%      1503.360000    1489.114444    1498.810500        360.000000   
75%      1518.080000    1565.451184    1884.257000        540.000000   
max      1539.040000    1692.944000    2308.560000        720.000000   
std        38.877496      96.442429     459.366164        242.220309   

       barrier_price    rebate  dividend_rate  risk_free_rate          theta  \
count   6.871010e+05  687101.0  687101.000000    6.871010e+05  687101.000000   
mean    4.316188e+01       0.0       0.018565    4.000000e-02       0.032357   
min     2.593117e-08       0.0       0.017798    4.000000e-02       0.019921   
25%     5.662541e-01       0.0       0.018338    4.000000e-02       0.024081   
50%     1.996005e+01       0.0       0.018516    4.000000e-02       0.027540   
75%     7.396771e+01       0.0       0.018745    4.000000e-02       0.032299   
max     2.563887e+02       0.0       0.019742    4.000000e-02       0.405049   
std     5.153336e+01       0.0       0.000362    6.028654e-13       0.024067   

               kappa            rho            eta             v0  \
count  687101.000000  687101.000000  687101.000000  687101.000000   
mean        1.293949      -0.948219       0.130946       0.014116   
min         0.039700      -1.000000       0.088178       0.005244   
25%         0.684101      -1.000000       0.107568       0.012124   
50%         1.040825      -1.000000       0.112957       0.012899   
75%         1.199354      -1.000000       0.122165       0.015451   
max        12.326035      -0.347098       0.708018       0.031695   
std         1.320324       0.139182       0.071770       0.004574   

                    calculation_date                expiration_date  \
count                         687101                         687101   
mean   2007-05-03 06:33:19.576772352  2008-04-03 04:45:32.978120704   
min              2007-01-03 00:00:00            2007-03-04 00:00:00   
25%              2007-04-23 00:00:00            2007-08-19 00:00:00   
50%              2007-05-15 00:00:00            2008-02-24 00:00:00   
75%              2007-06-05 00:00:00            2008-11-11 00:00:00   
max              2007-06-26 00:00:00            2009-06-15 00:00:00   
std                              NaN                            NaN   

       observed_price      moneyness  
count   687101.000000  687101.000000  
mean        43.171151       0.006600  
min          0.000000      -0.100000  
25%          0.588107      -0.042857  
50%         19.963646       0.010204  
75%         73.971174       0.058315  
max        256.654351       0.111111  
std         51.525731       0.059515  

spot(s):
[1374.2  1377.99 1386.77 1386.98 1387.16 1391.82 1392.05 1395.15 1399.96
 1401.5  1401.77 1402.74 1403.05 1406.48 1406.64 1409.82 1410.74 1412.12
 1412.71 1414.71 1416.59 1416.97 1418.28 1420.46 1420.83 1422.42 1422.43
 1423.07 1423.8  1424.27 1424.44 1426.09 1428.02 1428.7  1428.81 1430.36
 1430.59 1430.69 1431.78 1433.55 1434.56 1434.69 1436.11 1437.38 1437.45
 1438.07 1438.45 1438.91 1439.15 1439.97 1443.66 1444.24 1444.47 1445.71
 1447.04 1447.77 1447.89 1448.38 1448.46 1449.6  1449.93 1451.23 1452.78
 1455.05 1455.51 1456.3  1456.93 1457.51 1459.53 1468.23 1470.62 1471.33
 1472.32 1480.49 1481.12 1482.47 1484.4  1486.09 1489.55 1491.66 1492.47
 1493.24 1494.22 1494.32 1495.27 1496.   1497.37 1501.4  1502.3  1503.06
 1503.36 1505.49 1506.   1506.03 1507.68 1507.84 1507.94 1509.13 1512.26
 1512.52 1512.61 1513.95 1515.42 1515.75 1516.28 1518.08 1521.61 1522.16
 1522.51 1522.95 1523.96 1524.84 1529.95 1530.14 1530.69 1531.08 1532.93
 1533.31 1536.18 1539.04]

strikes:
[1236.78       1240.191      1248.093      ... 1686.66220408 1689.798
 1692.944     ]

maturities:
[ 60  90 180 360 540 720]

types:
['call' 'put']

['DownOut' 'DownIn' 'UpOut' 'UpIn']
number of calls, puts:
337231,349870

total prices:
687101

Deep Neural Network
hidden layers sizes: (10, 10, 10)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
          spot_price   strike_price        barrier  days_to_maturity  \
count  687101.000000  687101.000000  687101.000000     687101.000000   
mean     1490.669161    1489.199910    1488.549502        335.925155   
min      1374.200000    1236.780000     687.100000         60.000000   
25%      1480.490000    1413.567347    1120.003200         90.000000   
50%      1503.360000    1489.114444    1498.810500        360.000000   
75%      1518.080000    1565.451184    1884.257000        540.000000   
max      1539.040000    1692.944000    2308.560000        720.000000   
std        38.877496      96.442429     459.366164        242.220309   

       barrier_price    rebate  dividend_rate  risk_free_rate          theta  \
count   6.871010e+05  687101.0  687101.000000    6.871010e+05  687101.000000   
mean    4.316188e+01       0.0       0.018565    4.000000e-02       0.032357   
min     2.593117e-08       0.0       0.017798    4.000000e-02       0.019921   
25%     5.662541e-01       0.0       0.018338    4.000000e-02       0.024081   
50%     1.996005e+01       0.0       0.018516    4.000000e-02       0.027540   
75%     7.396771e+01       0.0       0.018745    4.000000e-02       0.032299   
max     2.563887e+02       0.0       0.019742    4.000000e-02       0.405049   
std     5.153336e+01       0.0       0.000362    6.028654e-13       0.024067   

               kappa            rho            eta             v0  \
count  687101.000000  687101.000000  687101.000000  687101.000000   
mean        1.293949      -0.948219       0.130946       0.014116   
min         0.039700      -1.000000       0.088178       0.005244   
25%         0.684101      -1.000000       0.107568       0.012124   
50%         1.040825      -1.000000       0.112957       0.012899   
75%         1.199354      -1.000000       0.122165       0.015451   
max        12.326035      -0.347098       0.708018       0.031695   
std         1.320324       0.139182       0.071770       0.004574   

                    calculation_date                expiration_date  \
count                         687101                         687101   
mean   2007-05-03 06:33:19.576772352  2008-04-03 04:45:32.978120704   
min              2007-01-03 00:00:00            2007-03-04 00:00:00   
25%              2007-04-23 00:00:00            2007-08-19 00:00:00   
50%              2007-05-15 00:00:00            2008-02-24 00:00:00   
75%              2007-06-05 00:00:00            2008-11-11 00:00:00   
max              2007-06-26 00:00:00            2009-06-15 00:00:00   
std                              NaN                            NaN   

       observed_price      moneyness  
count   687101.000000  687101.000000  
mean        43.171151       0.006600  
min          0.000000      -0.100000  
25%          0.588107      -0.042857  
50%         19.963646       0.010204  
75%         73.971174       0.058315  
max        256.654351       0.111111  
std         51.525731       0.059515  
#############
# test data #
#############
          spot_price   strike_price        barrier  days_to_maturity  \
count  455299.000000  455299.000000  455299.000000     455299.000000   
mean     1491.243276    1489.987770    1490.504539        331.356361   
min      1406.580000    1265.922000     703.290000         60.000000   
25%      1454.470000    1414.545653    1115.607700         90.000000   
50%      1497.460000    1488.714429    1490.992300        360.000000   
75%      1525.350000    1564.219163    1879.312300        540.000000   
max      1552.800000    1708.080000    2329.200000        720.000000   
std        42.026979      96.447513     462.332779        241.636138   

       barrier_price    rebate  dividend_rate  risk_free_rate          theta  \
count  455299.000000  455299.0  455299.000000    4.552990e+05  455299.000000   
mean       52.124808       0.0       0.019029    4.000000e-02       0.040101   
min         0.000003       0.0       0.018315    4.000000e-02       0.028217   
25%         1.736132       0.0       0.018575    4.000000e-02       0.034603   
50%        29.342627       0.0       0.018896    4.000000e-02       0.038505   
75%        90.256495       0.0       0.019463    4.000000e-02       0.041721   
max       274.740929       0.0       0.020098    4.000000e-02       0.093661   
std        56.963362       0.0       0.000500    4.652811e-13       0.010925   

               kappa            rho            eta             v0  \
count  455299.000000  455299.000000  455299.000000  455299.000000   
mean        2.391569      -0.936194       0.212738       0.039021   
min         0.228540      -1.000000       0.120850       0.017218   
25%         0.864166      -1.000000       0.133595       0.020318   
50%         1.280115      -1.000000       0.163899       0.035903   
75%         3.339927      -0.999949       0.213243       0.053559   
max        12.260215      -0.423011       0.956678       0.135010   
std         2.457129       0.165084       0.151855       0.023956   

                    calculation_date                expiration_date  \
count                         455299                         455299   
mean   2007-07-25 17:27:32.390187520  2008-06-21 02:00:42.017223424   
min              2007-06-27 00:00:00            2007-08-26 00:00:00   
25%              2007-07-12 00:00:00            2007-10-29 00:00:00   
50%              2007-07-26 00:00:00            2008-06-26 00:00:00   
75%              2007-08-09 00:00:00            2009-01-17 00:00:00   
max              2007-08-22 00:00:00            2009-08-11 00:00:00   
std                              NaN                            NaN   

       observed_price      moneyness  
count   455299.000000  455299.000000  
mean        52.132717       0.005011  
min          0.000000      -0.100000  
25%          1.738961      -0.044834  
50%         29.323582       0.006122  
75%         90.262363       0.055102  
max        274.789520       0.111111  
std         56.957193       0.058550  

in sample results:
     RMSE: 5.036821546652104
     MAE: 3.594988931426179

out of sample results:
     RMSE: 13.825289117237011
     MAE: 8.26889794044601
features:
spot_price
target: observed_pricestrike_price
target: observed_pricedays_to_maturity
target: observed_pricerisk_free_rate
target: observed_pricedividend_rate
target: observed_pricekappa
target: observed_pricetheta
target: observed_pricerho
target: observed_priceeta
target: observed_pricev0
target: observed_pricebarrier
target: observed_pricebarrier_type_name
target: observed_pricew
target: observed_price