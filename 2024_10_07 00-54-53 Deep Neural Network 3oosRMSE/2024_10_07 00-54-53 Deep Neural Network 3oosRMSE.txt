Mon Oct  7 00:48:26 2024
         spot_price  strike_price     w  heston_price  days_to_maturity  \
0           1416.59      1133.272   put  2.230437e-07                30   
1           1416.59      1133.272   put  5.165085e-06                37   
2           1416.59      1133.272   put  4.585039e-05                44   
3           1416.59      1133.272   put  2.301454e-04                51   
4           1416.59      1133.272   put  8.031175e-04                58   
...             ...           ...   ...           ...               ...   
6885249     1322.39      1586.868  call  3.057719e+01               331   
6885250     1322.39      1586.868  call  3.173136e+01               338   
6885251     1322.39      1586.868  call  3.288738e+01               345   
6885252     1322.39      1586.868  call  3.404476e+01               352   
6885253     1322.39      1586.868  call  3.520303e+01               359   

         risk_free_rate  dividend_rate     kappa     theta  rho       eta  \
0                  0.04       0.018125  0.233438  0.082956 -1.0  0.098497   
1                  0.04       0.018125  0.233438  0.082956 -1.0  0.098497   
2                  0.04       0.018125  0.233438  0.082956 -1.0  0.098497   
3                  0.04       0.018125  0.233438  0.082956 -1.0  0.098497   
4                  0.04       0.018125  0.233438  0.082956 -1.0  0.098497   
...                 ...            ...       ...       ...  ...       ...   
6885249            0.04       0.023570  2.373575  0.067254 -1.0  0.177488   
6885250            0.04       0.023570  2.373575  0.067254 -1.0  0.177488   
6885251            0.04       0.023570  2.373575  0.067254 -1.0  0.177488   
6885252            0.04       0.023570  2.373575  0.067254 -1.0  0.177488   
6885253            0.04       0.023570  2.373575  0.067254 -1.0  0.177488   

               v0 calculation_date expiration_date  observed_price  
0        0.010662       2007-01-03      2007-02-02        0.029833  
1        0.010662       2007-01-03      2007-02-09        0.000000  
2        0.010662       2007-01-03      2007-02-16        0.149774  
3        0.010662       2007-01-03      2007-02-23        0.284005  
4        0.010662       2007-01-03      2007-03-02        0.126121  
...           ...              ...             ...             ...  
6885249  0.031000       2012-05-24      2013-04-20       30.662292  
6885250  0.031000       2012-05-24      2013-04-27       31.856544  
6885251  0.031000       2012-05-24      2013-05-04       33.084357  
6885252  0.031000       2012-05-24      2013-05-11       34.098552  
6885253  0.031000       2012-05-24      2013-05-18       35.184087  

[6525254 rows x 15 columns]
         spot_price  strike_price  heston_price  days_to_maturity  \
count  6.525254e+06  6.525254e+06  6.525254e+06      6.525254e+06   
mean   1.220927e+03  1.220817e+03  9.606718e+01      1.945565e+02   
min    6.760300e+02  5.408240e+02  2.389303e-16      3.000000e+01   
25%    1.093030e+03  1.044264e+03  2.924644e+01      1.140000e+02   
50%    1.254990e+03  1.220361e+03  7.827606e+01      1.980000e+02   
75%    1.370430e+03  1.396947e+03  1.529622e+02      2.820000e+02   
max    1.565180e+03  1.878216e+03  3.501414e+02      3.590000e+02   
std    1.997654e+02  2.471357e+02  7.694236e+01      9.695347e+01   

       risk_free_rate  dividend_rate         kappa         theta  \
count    6.525254e+06   6.525254e+06  6.525254e+06  6.525254e+06   
mean     4.000000e-02   2.196938e-02  3.262916e+00  6.786170e-02   
min      4.000000e-02   1.779800e-02  3.970018e-02  1.992058e-02   
25%      4.000000e-02   1.953300e-02  1.717940e+00  5.157374e-02   
50%      4.000000e-02   2.112600e-02  2.620567e+00  6.116538e-02   
75%      4.000000e-02   2.258900e-02  4.445361e+00  7.394833e-02   
max      4.000000e-02   3.773500e-02  1.599144e+01  4.050494e-01   
std      2.639937e-12   3.762211e-03  2.214906e+00  3.404594e-02   

                rho           eta            v0  \
count  6.525254e+06  6.525254e+06  6.525254e+06   
mean  -9.031047e-01  2.179461e-01  5.981584e-02   
min   -1.000000e+00  8.817807e-02  5.244166e-03   
25%   -1.000000e+00  1.613809e-01  2.044831e-02   
50%   -9.999864e-01  1.881897e-01  3.553821e-02   
75%   -8.531281e-01  2.278556e-01  6.087944e-02   
max   -1.817638e-01  1.528820e+00  6.940162e-01   
std    1.686477e-01  1.337773e-01  7.682455e-02   

                    calculation_date                expiration_date  \
count                        6525254                        6525254   
mean   2009-09-13 18:38:45.367135232  2010-03-27 08:00:05.658261248   
min              2007-01-03 00:00:00            2007-02-02 00:00:00   
25%              2008-05-09 00:00:00            2008-11-20 00:00:00   
50%              2009-09-15 00:00:00            2010-03-27 00:00:00   
75%              2011-01-20 00:00:00            2011-07-31 00:00:00   
max              2012-05-24 00:00:00            2013-05-18 00:00:00   
std                              NaN                            NaN   

       observed_price  
count    6.525254e+06  
mean     9.606781e+01  
min      0.000000e+00  
25%      2.924534e+01  
50%      7.827518e+01  
75%      1.529595e+02  
max      3.502297e+02  
std      7.694164e+01  

spot(s):
[ 676.03  682.43  683.09 ... 1561.58 1562.09 1565.18]

strikes:
[ 540.824       545.944       546.34261224 ... 1873.896      1874.508
 1878.216     ]

maturities:
[ 30  37  44  51  58  65  72  79  86  93 100 107 114 121 128 135 142 149
 156 163 170 177 184 191 198 205 212 219 226 233 240 247 254 261 268 275
 282 289 296 303 310 317 324 331 338 345 352 359]

types:
['call' 'put']

number of calls, puts:
3261254,3264000

total prices:
6525254
Deep Neural Network
hidden layers sizes: (10, 10, 10)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
         spot_price  strike_price  heston_price  days_to_maturity  \
count  6.525254e+06  6.525254e+06  6.525254e+06      6.525254e+06   
mean   1.220927e+03  1.220817e+03  9.606718e+01      1.945565e+02   
min    6.760300e+02  5.408240e+02  2.389303e-16      3.000000e+01   
25%    1.093030e+03  1.044264e+03  2.924644e+01      1.140000e+02   
50%    1.254990e+03  1.220361e+03  7.827606e+01      1.980000e+02   
75%    1.370430e+03  1.396947e+03  1.529622e+02      2.820000e+02   
max    1.565180e+03  1.878216e+03  3.501414e+02      3.590000e+02   
std    1.997654e+02  2.471357e+02  7.694236e+01      9.695347e+01   

       risk_free_rate  dividend_rate         kappa         theta  \
count    6.525254e+06   6.525254e+06  6.525254e+06  6.525254e+06   
mean     4.000000e-02   2.196938e-02  3.262916e+00  6.786170e-02   
min      4.000000e-02   1.779800e-02  3.970018e-02  1.992058e-02   
25%      4.000000e-02   1.953300e-02  1.717940e+00  5.157374e-02   
50%      4.000000e-02   2.112600e-02  2.620567e+00  6.116538e-02   
75%      4.000000e-02   2.258900e-02  4.445361e+00  7.394833e-02   
max      4.000000e-02   3.773500e-02  1.599144e+01  4.050494e-01   
std      2.639937e-12   3.762211e-03  2.214906e+00  3.404594e-02   

                rho           eta            v0  \
count  6.525254e+06  6.525254e+06  6.525254e+06   
mean  -9.031047e-01  2.179461e-01  5.981584e-02   
min   -1.000000e+00  8.817807e-02  5.244166e-03   
25%   -1.000000e+00  1.613809e-01  2.044831e-02   
50%   -9.999864e-01  1.881897e-01  3.553821e-02   
75%   -8.531281e-01  2.278556e-01  6.087944e-02   
max   -1.817638e-01  1.528820e+00  6.940162e-01   
std    1.686477e-01  1.337773e-01  7.682455e-02   

                    calculation_date                expiration_date  \
count                        6525254                        6525254   
mean   2009-09-13 18:38:45.367135232  2010-03-27 08:00:05.658261248   
min              2007-01-03 00:00:00            2007-02-02 00:00:00   
25%              2008-05-09 00:00:00            2008-11-20 00:00:00   
50%              2009-09-15 00:00:00            2010-03-27 00:00:00   
75%              2011-01-20 00:00:00            2011-07-31 00:00:00   
max              2012-05-24 00:00:00            2013-05-18 00:00:00   
std                              NaN                            NaN   

       observed_price  
count    6.525254e+06  
mean     9.606781e+01  
min      0.000000e+00  
25%      2.924534e+01  
50%      7.827518e+01  
75%      1.529595e+02  
max      3.502297e+02  
std      7.694164e+01  
#############
# test data #
#############
          spot_price   strike_price  heston_price  days_to_maturity  \
count  719729.000000  719729.000000  7.197290e+05     719729.000000   
mean     1395.036137    1394.933553  9.587578e+01        194.558098   
min      1276.900000    1021.520000  7.572610e-16         30.000000   
25%      1360.330000    1251.329714  1.973694e+01        114.000000   
50%      1406.680000    1393.462041  6.933221e+01        198.000000   
75%      1429.160000    1535.528163  1.621385e+02        282.000000   
max      1465.270000    1758.324000  3.211077e+02        359.000000   
std        44.953517     170.392101  8.587565e+01         96.945621   

       risk_free_rate  dividend_rate          kappa          theta  \
count    7.197290e+05  719729.000000  719729.000000  719729.000000   
mean     4.000000e-02       0.022564       1.139894       0.076031   
min      4.000000e-02       0.021419       0.083258       0.042979   
25%      4.000000e-02       0.022128       0.787623       0.055572   
50%      4.000000e-02       0.022402       1.109004       0.065713   
75%      4.000000e-02       0.022977       1.434936       0.078125   
max      4.000000e-02       0.024360       2.804943       0.311501   
std      6.151195e-13       0.000641       0.548549       0.041563   

                 rho            eta             v0  \
count  719729.000000  719729.000000  719729.000000   
mean       -0.786812       0.197944       0.020308   
min        -1.000000       0.114615       0.007385   
25%        -1.000000       0.133487       0.015199   
50%        -0.876898       0.156175       0.018989   
75%        -0.618829       0.225340       0.022686   
max        -0.301439       0.555322       0.051103   
std         0.227160       0.093536       0.007903   

                    calculation_date                expiration_date  \
count                         719729                         719729   
mean   2012-09-11 10:27:32.772084992  2013-03-24 23:51:12.401416960   
min              2012-05-25 00:00:00            2012-06-24 00:00:00   
25%              2012-07-19 00:00:00            2012-12-29 00:00:00   
50%              2012-09-12 00:00:00            2013-03-24 00:00:00   
75%              2012-11-06 00:00:00            2013-06-19 00:00:00   
max              2012-12-31 00:00:00            2013-12-25 00:00:00   
std                              NaN                            NaN   

       observed_price  
count   719729.000000  
mean        95.877197  
min          0.000000  
25%         19.732568  
50%         69.325124  
75%        162.141574  
max        321.219924  
std         85.874299  

in sample results:
     RMSE: 3.4852138270029727
     MAE: 2.477148658721942

out of sample results:
     RMSE: 3.3145200064951346
     MAE: 2.383239229533958

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     w

target: observed_price

cpu: 386.78918170928955
Mon Oct  7 00:54:53 2024