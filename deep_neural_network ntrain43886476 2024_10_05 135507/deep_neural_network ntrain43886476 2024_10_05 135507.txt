
          spot_price  strike_price     w  heston_price  days_to_maturity  \
157      1416.590000   1275.000000   put     51.382052                30   
158      1416.590000   1275.000000   put     56.933000                31   
159      1416.590000   1275.000000   put     62.557228                32   
160      1416.590000   1275.000000   put     68.229444                33   
161      1416.590000   1275.000000   put     73.929128                34   
...              ...           ...   ...           ...               ...   
95995386 1425.770000   1584.114731  call     23.896387               226   
95995387 1425.770000   1584.114731  call     28.347215               254   
95995388 1425.770000   1584.114731  call     32.847074               282   
95995389 1425.770000   1584.114731  call     37.372609               310   
95995390 1425.770000   1584.114731  call     41.906036               338   

          risk_free_rate  dividend_rate    kappa    theta       rho      eta  \
157             0.040000       1.812500 0.233438 0.082956 -1.000000 0.098497   
158             0.040000       1.812500 0.233438 0.082956 -1.000000 0.098497   
159             0.040000       1.812500 0.233438 0.082956 -1.000000 0.098497   
160             0.040000       1.812500 0.233438 0.082956 -1.000000 0.098497   
161             0.040000       1.812500 0.233438 0.082956 -1.000000 0.098497   
...                  ...            ...      ...      ...       ...      ...   
95995386        0.040000       0.022233 0.898211 0.056212 -0.418973 0.324868   
95995387        0.040000       0.022233 0.898211 0.056212 -0.418973 0.324868   
95995388        0.040000       0.022233 0.898211 0.056212 -0.418973 0.324868   
95995389        0.040000       0.022233 0.898211 0.056212 -0.418973 0.324868   
95995390        0.040000       0.022233 0.898211 0.056212 -0.418973 0.324868   

               v0 calculation_date expiration_date  observed_price  moneyness  
157      0.010662       2007-01-03      2007-02-02       51.537836  -0.099951  
158      0.010662       2007-01-03      2007-02-03       56.970740  -0.099951  
159      0.010662       2007-01-03      2007-02-04       62.483424  -0.099951  
160      0.010662       2007-01-03      2007-02-05       68.458781  -0.099951  
161      0.010662       2007-01-03      2007-02-06       74.003021  -0.099951  
...           ...              ...             ...             ...        ...  
95995386 0.024660       2012-12-31      2013-08-14       24.106722  -0.099958  
95995387 0.024660       2012-12-31      2013-09-11       28.197026  -0.099958  
95995388 0.024660       2012-12-31      2013-10-09       32.727861  -0.099958  
95995389 0.024660       2012-12-31      2013-11-06       37.447000  -0.099958  
95995390 0.024660       2012-12-31      2013-12-04       41.767805  -0.099958  

[77003317 rows x 16 columns]
           spot_price    strike_price    heston_price  days_to_maturity  \
count 77003317.000000 77003317.000000 77003317.000000   77003317.000000   
mean      1282.388323     1284.648026      433.053148        122.336298   
min        676.030000      609.000000       -0.000091         30.000000   
25%       1164.820000     1160.308473      161.592064         72.000000   
50%       1325.900000     1313.323774      462.418942        114.000000   
75%       1420.300000     1431.000000      655.653007        159.000000   
max       1565.180000     1738.792401     1089.374314        359.000000   
std        185.142862      200.144193      275.646652         65.645957   

       risk_free_rate   dividend_rate           kappa           theta  \
count 77003317.000000 77003317.000000 77003317.000000 77003317.000000   
mean         0.040000        1.746052        2.760817        0.064052   
min          0.040000        0.017798        0.039700        0.019921   
25%          0.040000        1.838500        1.283163        0.048995   
50%          0.040000        2.002500        2.075036        0.058609   
75%          0.040000        2.213500        3.657994        0.070973   
max          0.040000        3.773500       15.991443        0.405049   
std          0.000000        0.873405        2.147939        0.034204   

                  rho             eta              v0  \
count 77003317.000000 77003317.000000 77003317.000000   
mean        -0.891535        0.208643        0.047271   
min         -1.000000        0.088178        0.005244   
25%         -1.000000        0.143205        0.017258   
50%         -0.999997        0.181252        0.028620   
75%         -0.827626        0.219084        0.050554   
max         -0.181764        1.528820        0.694016   
std          0.180460        0.131877        0.062790   

                    calculation_date                expiration_date  \
count                       77003317                       77003317   
mean   2009-10-24 10:40:16.455180288  2010-02-23 18:44:32.614175488   
min              2007-01-03 00:00:00            2007-02-02 00:00:00   
25%              2007-12-31 00:00:00            2008-05-03 00:00:00   
50%              2009-10-28 00:00:00            2010-02-26 00:00:00   
75%              2011-07-01 00:00:00            2011-11-03 00:00:00   
max              2012-12-31 00:00:00            2013-12-04 00:00:00   
std                              NaN                            NaN   

       observed_price       moneyness  
count 77003317.000000 77003317.000000  
mean       433.059635       -0.001541  
min          0.000000       -0.100000  
25%        161.591851       -0.051438  
50%        462.418917       -0.002304  
75%        655.653691        0.048008  
max       1089.193934        0.100000  
std        275.636530        0.057418  

spot(s):
[ 676.03  682.43  683.09 ... 1561.58 1562.09 1565.18]

strikes:
[ 609.          610.          611.         ... 1738.12530208 1738.45885136
 1738.79240064]

maturities:
[ 30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47
  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65
  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83
  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101
 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119
 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137
 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155
 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173
 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191
 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209
 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227
 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245
 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263
 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281
 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299
 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317
 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335
 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353
 354 355 356 357 358 359]

types:
['call' 'put']

moneyness:
[-0.1        -0.1        -0.1        ...  0.09999272  0.1
  0.1       ]

number of calls, puts:
18569330,58433987

total prices:
77003317

Deep Neural Network
hidden layers sizes: (10, 10, 10)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001

train data:
           spot_price    strike_price    heston_price  days_to_maturity  \
count 43886476.000000 43886476.000000 43886476.000000   43886476.000000   
mean      1227.280002     1229.179802      449.825723        122.375428   
min        814.960000      734.000000        0.000000         30.000000   
25%       1114.870000     1115.000000      241.650704         72.000000   
50%       1253.870000     1238.000000      476.234298        114.000000   
75%       1343.910000     1352.000000      648.126271        159.000000   
max       1465.270000     1627.892453     1089.374314        338.000000   
std        147.262832      163.891987      255.072182         65.668270   

       risk_free_rate   dividend_rate           kappa           theta  \
count 43886476.000000 43886476.000000 43886476.000000 43886476.000000   
mean         0.040000        1.746817        3.014731        0.069256   
min          0.040000        0.017912        0.083258        0.037838   
25%          0.040000        1.920400        1.562670        0.054002   
50%          0.040000        2.096700        2.374336        0.065236   
75%          0.040000        2.223600        4.115097        0.074280   
max          0.040000        2.876400       15.991443        0.356100   
std          0.000000        0.845700        2.070848        0.030623   

                  rho             eta              v0  \
count 43886476.000000 43886476.000000 43886476.000000   
mean        -0.849589        0.212920        0.036190   
min         -1.000000        0.110964        0.007385   
25%         -1.000000        0.151463        0.017676   
50%         -0.929113        0.185837        0.025733   
75%         -0.750842        0.225340        0.042328   
max         -0.181764        1.528820        0.224798   
std          0.192245        0.118996        0.029007   

                    calculation_date                expiration_date  \
count                       43886476                       43886476   
mean   2011-03-31 11:01:39.719721728  2011-07-31 20:02:16.726658816   
min              2009-04-02 00:00:00            2009-05-02 00:00:00   
25%              2010-05-05 00:00:00            2010-09-05 00:00:00   
50%              2011-04-15 00:00:00            2011-08-17 00:00:00   
75%              2012-03-08 00:00:00            2012-07-06 00:00:00   
max              2012-12-31 00:00:00            2013-12-04 00:00:00   
std                              NaN                            NaN   

       observed_price       moneyness  
count 43886476.000000 43886476.000000  
mean       449.825789       -0.001558  
min          0.000007       -0.100000  
25%        241.649449       -0.051556  
50%        476.235554       -0.002193  
75%        648.125991        0.048134  
max       1089.193934        0.100000  
std        255.072142        0.057546  


test data:            
spot_price    strike_price    heston_price  days_to_maturity  \
count 17558363.000000 17558363.000000 17558363.000000   17558363.000000   
mean      1254.714125     1256.694989      477.066542        122.291034   
min        676.030000      609.000000       -0.000000         30.000000   
25%       1188.420000     1147.000000      263.118113         72.000000   
50%       1333.240000     1320.000000      507.849115        114.000000   
75%       1409.140000     1431.000000      686.993458        159.000000   
max       1565.180000     1738.792401     1060.817174        338.000000   
std        234.737980      246.490241      261.594279         65.623994   

       risk_free_rate   dividend_rate           kappa           theta  \
count 17558363.000000 17558363.000000 17558363.000000 17558363.000000   
mean         0.040000        1.926064        3.114767        0.073921   
min          0.040000        0.018031        0.628024        0.040727   
25%          0.040000        1.858800        1.691350        0.054300   
50%          0.040000        2.141200        2.070256        0.057638   
75%          0.040000        2.322700        3.934227        0.066003   
max          0.040000        3.773500       13.250228        0.195593   
std          0.000000        1.017233        2.324395        0.034882   

                  rho             eta              v0  \
count 17558363.000000 17558363.000000 17558363.000000   
mean        -0.955977        0.246630        0.097263   
min         -1.000000        0.148044        0.019440   
25%         -1.000000        0.171346        0.036929   
50%         -1.000000        0.196554        0.051664   
75%         -0.999975        0.256227        0.115621   
max         -0.244331        1.523884        0.694016   
std          0.144328        0.166832        0.107377   

                    calculation_date                expiration_date  \
count                       17558363                       17558363   
mean   2008-05-29 05:23:13.953389056  2008-09-28 12:22:19.253503232   
min              2007-10-01 00:00:00            2007-10-31 00:00:00   
25%              2008-01-18 00:00:00            2008-05-17 00:00:00   
50%              2008-05-19 00:00:00            2008-09-20 00:00:00   
75%              2008-09-24 00:00:00            2009-01-31 00:00:00   
max              2009-04-01 00:00:00            2010-03-05 00:00:00   
std                              NaN                            NaN   

       observed_price       moneyness  
count 17558363.000000 17558363.000000  
mean       477.066876       -0.001598  
min          0.000010       -0.100000  
25%        263.120209       -0.051616  
50%        507.848966       -0.002224  
75%        686.994214        0.048108  
max       1060.717866        0.100000  
std        261.593767        0.057555  