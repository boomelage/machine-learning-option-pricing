Mon Oct  7 09:02:09 2024
spot(s):
[1374.2  1377.99 1386.77 1386.98 1387.16 1391.82 1392.05 1395.15 1399.96
 1401.5  1401.77 1402.74 1403.05 1406.48 1406.58 1406.64 1406.77 1409.82
 1410.74 1412.12 1412.71 1413.18 1414.71 1416.4  1416.59 1416.97 1418.28
 1420.46 1420.83 1422.42 1422.43 1423.07 1423.8  1424.27 1424.44 1426.09
 1426.6  1428.02 1428.35 1428.7  1428.81 1430.36 1430.59 1430.69 1431.78
 1433.18 1433.19 1433.55 1433.65 1434.56 1434.69 1436.11 1437.38 1437.45
 1438.07 1438.45 1438.91 1438.99 1439.15 1439.53 1439.88 1439.97 1443.66
 1444.24 1444.47 1445.28 1445.5  1445.71 1447.03 1447.04 1447.77 1447.89
 1448.38 1448.46 1449.6  1449.93 1451.21 1451.23 1451.6  1452.78 1452.95
 1452.96 1453.53 1453.85 1454.47 1454.78 1455.05 1455.51 1456.3  1456.93
 1457.51 1457.85 1458.35 1459.18 1459.53 1462.63 1462.85 1463.59 1463.78
 1466.35 1466.84 1467.25 1468.23 1469.04 1469.89 1470.07 1470.62 1471.33
 1471.43 1471.49 1471.93 1471.99 1472.32 1472.58 1472.83 1473.51 1474.26
 1475.44 1476.23 1476.68 1477.65 1478.45 1479.09 1480.49 1480.57 1481.12
 1481.25 1482.47 1483.7  1484.16 1484.4  1484.51 1484.86 1486.09 1486.9
 1488.85 1489.28 1489.55 1491.66 1492.47 1493.24 1494.22 1494.32 1495.27
 1496.   1497.37 1497.46 1500.66 1501.4  1502.13 1502.3  1502.37 1503.06
 1503.36 1504.31 1505.36 1505.49 1506.   1506.03 1506.09 1506.44 1507.3
 1507.68 1507.84 1507.94 1508.33 1509.13 1510.2  1510.29 1511.77 1512.26
 1512.52 1512.61 1513.95 1514.24 1515.42 1515.75 1515.9  1516.16 1516.28
 1517.65 1517.78 1517.93 1518.08 1518.59 1518.8  1519.26 1519.38 1519.66
 1520.45 1521.61 1522.16 1522.51 1522.95 1523.96 1524.76 1524.84 1525.35
 1525.39 1525.5  1526.61 1528.78 1529.95 1530.14 1530.37 1530.69 1531.05
 1531.08 1531.44 1531.83 1532.93 1533.31 1534.08 1535.14 1536.18 1538.87
 1539.04 1539.62 1539.7  1540.86 1541.15 1542.85 1544.83 1546.47 1546.48
 1547.66 1548.82 1549.07 1549.66 1549.68 1552.26 1552.65 1552.8  1554.55
 1557.09 1561.58 1562.09 1565.18]

strikes:
[1236.78  1240.191 1248.093 ... 1717.738 1718.299 1721.698]

maturities:
[ 60  90 180 360 540 720]

types:
['call' 'put']

['DownOut' 'DownIn' 'UpOut' 'UpIn']
number of calls, puts:
1042841,1074351

total prices:
2117192
Deep Neural Network
hidden layers sizes: (10, 10, 10)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
         spot_price  strike_price       barrier  days_to_maturity  \
count  2.117192e+06  2.117192e+06  2.117192e+06      2.117192e+06   
mean   1.492905e+03  1.491630e+03  1.491757e+03      3.322395e+02   
min    1.374200e+03  1.236780e+03  6.871000e+02      6.000000e+01   
25%    1.467250e+03  1.415700e+03  1.114520e+03      9.000000e+01   
50%    1.497460e+03  1.490666e+03  1.495931e+03      3.600000e+02   
75%    1.522510e+03  1.566310e+03  1.879199e+03      5.400000e+02   
max    1.565180e+03  1.721698e+03  2.347770e+03      7.200000e+02   
std    3.907739e+01  9.581119e+01  4.621889e+02      2.418082e+02   

       barrier_price     rebate  dividend_rate  risk_free_rate         theta  \
count   2.117192e+06  2117192.0   2.117192e+06    2.117192e+06  2.117192e+06   
mean    5.190004e+01        0.0   1.879650e-02    4.000000e-02  4.111801e-02   
min     2.593117e-08        0.0   1.779800e-02    4.000000e-02  1.992058e-02   
25%     1.576976e+00        0.0   1.843000e-02    4.000000e-02  3.123731e-02   
50%     2.824441e+01        0.0   1.869100e-02    4.000000e-02  3.893240e-02   
75%     8.972724e+01        0.0   1.913000e-02    4.000000e-02  4.944584e-02   
max     2.930981e+02        0.0   2.009800e-02    4.000000e-02  4.050494e-01   
std     5.776009e+01        0.0   4.745405e-04    8.600137e-13  1.702851e-02   

              kappa           rho           eta            v0  \
count  2.117192e+06  2.117192e+06  2.117192e+06  2.117192e+06   
mean   2.064731e+00 -9.406480e-01  2.030233e-01  3.349331e-02   
min    3.970018e-02 -1.000000e+00  8.817807e-02  5.244166e-03   
25%    9.645340e-01 -1.000000e+00  1.220301e-01  1.596244e-02   
50%    1.250748e+00 -9.999999e-01  1.594369e-01  2.822116e-02   
75%    2.348951e+00 -9.999992e-01  2.056080e-01  4.849839e-02   
max    1.232603e+01 -2.766103e-01  1.457690e+00  1.350097e-01   
std    2.098541e+00  1.630841e-01  1.732193e-01  2.048658e-02   

                    calculation_date                expiration_date  \
count                        2117192                        2117192   
mean   2007-08-05 14:50:59.936746240  2008-07-02 20:35:54.716625152   
min              2007-01-03 00:00:00            2007-03-04 00:00:00   
25%              2007-06-06 00:00:00            2007-12-04 00:00:00   
50%              2007-08-13 00:00:00            2008-05-14 00:00:00   
75%              2007-10-09 00:00:00            2009-02-05 00:00:00   
max              2007-12-13 00:00:00            2009-12-02 00:00:00   
std                              NaN                            NaN   

       observed_price  
count    2.117192e+06  
mean     5.190772e+01  
min      0.000000e+00  
25%      1.580286e+00  
50%      2.824933e+01  
75%      8.972234e+01  
max      2.929989e+02  
std      5.775344e+01  
#############
# test data #
#############
         spot_price   strike_price        barrier  days_to_maturity  \
count  299753.00000  299753.000000  299753.000000     299753.000000   
mean     1422.93687    1421.916170    1423.073410        329.079942   
min      1311.13000    1180.017000     655.565000         60.000000   
25%      1390.08000    1348.188490    1057.862750         90.000000   
50%      1419.95000    1420.232388    1432.431000        360.000000   
75%      1467.54000    1497.760776    1806.081575        540.000000   
max      1497.42000    1647.162000    2246.130000        720.000000   
std        53.09342      98.602821     444.121659        241.426861   

       barrier_price    rebate  dividend_rate  risk_free_rate          theta  \
count   2.997530e+05  299753.0  299753.000000    2.997530e+05  299753.000000   
mean    5.952795e+01       0.0       0.019863    4.000000e-02       0.057460   
min     5.479303e-07       0.0       0.018832    4.000000e-02       0.052883   
25%     3.658073e+00       0.0       0.019217    4.000000e-02       0.055780   
50%     3.827886e+01       0.0       0.019897    4.000000e-02       0.057191   
75%     1.036019e+02       0.0       0.020309    4.000000e-02       0.059229   
max     2.896199e+02       0.0       0.021637    4.000000e-02       0.061622   
std     6.183653e+01       0.0       0.000815    2.536586e-13       0.002126   

               kappa            rho            eta             v0  \
count  299753.000000  299753.000000  299753.000000  299753.000000   
mean        2.480897      -0.963712       0.227765       0.050785   
min         1.272383      -1.000000       0.182017       0.025719   
25%         1.748429      -1.000000       0.191475       0.042079   
50%         1.965236      -1.000000       0.198897       0.048883   
75%         2.176720      -1.000000       0.204499       0.055172   
max         8.984402      -0.484084       0.670358       0.100623   
std         1.640458       0.125712       0.103010       0.017007   

                    calculation_date                expiration_date  \
count                         299753                         299753   
mean   2008-01-03 05:51:17.641925120  2008-11-27 07:46:24.672713728   
min              2007-12-14 00:00:00            2008-02-12 00:00:00   
25%              2007-12-24 00:00:00            2008-04-06 00:00:00   
50%              2008-01-04 00:00:00            2008-12-11 00:00:00   
75%              2008-01-14 00:00:00            2009-06-27 00:00:00   
max              2008-01-23 00:00:00            2010-01-12 00:00:00   
std                              NaN                            NaN   

       observed_price  
count   299753.000000  
mean        59.534337  
min          0.000000  
25%          3.659733  
50%         38.275981  
75%        103.603754  
max        289.808802  
std         61.830493  

spot_price                  float64
strike_price                float64
barrier                     float64
days_to_maturity              int64
barrier_price               float64
updown                       object
outin                        object
w                            object
barrier_type_name            object
rebate                      float64
dividend_rate               float64
risk_free_rate              float64
theta                       float64
kappa                       float64
rho                         float64
eta                         float64
v0                          float64
calculation_date     datetime64[ns]
expiration_date      datetime64[ns]
observed_price              float64
dtype: object
in sample results:
     RMSE: 6.42911570023009
     MAE: 4.3620467706189565

out of sample results:
     RMSE: 10.991141421627658
     MAE: 6.976518499939128

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     barrier
     barrier_type_name
     w

target: observed_price

cpu: 150.67371940612793
Mon Oct  7 09:04:40 2024