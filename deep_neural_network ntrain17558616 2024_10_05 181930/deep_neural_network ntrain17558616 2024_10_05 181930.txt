
          spot_price  strike_price     w  heston_price  days_to_maturity  \
8635785      1544.83   1391.000000   put     62.266615                30   
8635786      1544.83   1391.000000   put     67.851440                31   
8635787      1544.83   1391.000000   put     73.541220                32   
8635788      1544.83   1391.000000   put     79.319320                33   
8635789      1544.83   1391.000000   put     85.170453                34   
...              ...           ...   ...           ...               ...   
79620310      810.12    900.059172  call     62.577746               226   
79620311      810.12    900.059172  call     68.336422               254   
79620312      810.12    900.059172  call     73.798308               282   
79620313      810.12    900.059172  call     78.998474               310   
79620314      810.12    900.059172  call     83.965375               338   

          risk_free_rate  dividend_rate   kappa     theta       rho       eta  \
8635785             0.04       1.828700  1.0487  0.040727 -1.000000  0.153756   
8635786             0.04       1.828700  1.0487  0.040727 -1.000000  0.153756   
8635787             0.04       1.828700  1.0487  0.040727 -1.000000  0.153756   
8635788             0.04       1.828700  1.0487  0.040727 -1.000000  0.153756   
8635789             0.04       1.828700  1.0487  0.040727 -1.000000  0.153756   
...                  ...            ...     ...       ...       ...       ...   
79620310            0.04       0.029022  5.3909  0.149124 -0.999991  0.240896   
79620311            0.04       0.029022  5.3909  0.149124 -0.999991  0.240896   
79620312            0.04       0.029022  5.3909  0.149124 -0.999991  0.240896   
79620313            0.04       0.029022  5.3909  0.149124 -0.999991  0.240896   
79620314            0.04       0.029022  5.3909  0.149124 -0.999991  0.240896   

                v0 calculation_date expiration_date  observed_price  moneyness  
8635785   0.025336       2007-10-01      2007-10-31       62.159955  -0.099577  
8635786   0.025336       2007-10-01      2007-11-01       67.934539  -0.099577  
8635787   0.025336       2007-10-01      2007-11-02       73.523823  -0.099577  
8635788   0.025336       2007-10-01      2007-11-03       79.327413  -0.099577  
8635789   0.025336       2007-10-01      2007-11-04       85.103673  -0.099577  
...            ...              ...             ...             ...        ...  
79620310  0.149821       2009-04-01      2009-11-13       62.607968  -0.099926  
79620311  0.149821       2009-04-01      2009-12-11       68.113312  -0.099926  
79620312  0.149821       2009-04-01      2010-01-08       73.968863  -0.099926  
79620313  0.149821       2009-04-01      2010-02-05       78.997409  -0.099926  
79620314  0.149821       2009-04-01      2010-03-05       84.015065  -0.099926  

[17558616 rows x 16 columns]
         spot_price  strike_price  heston_price  days_to_maturity  \
count  1.755862e+07  1.755862e+07  1.755862e+07      1.755862e+07   
mean   1.254718e+03  1.256698e+03  4.770597e+02      1.222921e+02   
min    6.760300e+02  6.090000e+02 -1.676217e-07      3.000000e+01   
25%    1.188420e+03  1.147000e+03  2.631014e+02      7.200000e+01   
50%    1.333240e+03  1.320000e+03  5.078439e+02      1.140000e+02   
75%    1.409140e+03  1.431000e+03  6.869910e+02      1.590000e+02   
max    1.565180e+03  1.738792e+03  1.060817e+03      3.380000e+02   
std    2.347389e+02  2.464902e+02  2.615987e+02      6.562377e+01   

       risk_free_rate  dividend_rate         kappa         theta  \
count    1.755862e+07   1.755862e+07  1.755862e+07  1.755862e+07   
mean     4.000000e-02   1.926064e+00  3.114736e+00  7.392048e-02   
min      4.000000e-02   1.803100e-02  6.280245e-01  4.072687e-02   
25%      4.000000e-02   1.858800e+00  1.691350e+00  5.429967e-02   
50%      4.000000e-02   2.141200e+00  2.070256e+00  5.763813e-02   
75%      4.000000e-02   2.322700e+00  3.934227e+00  6.600293e-02   
max      4.000000e-02   3.773500e+00  1.325023e+01  1.955930e-01   
std      2.617302e-12   1.017225e+00  2.324392e+00  3.488189e-02   

                rho           eta            v0  \
count  1.755862e+07  1.755862e+07  1.755862e+07   
mean  -9.559775e-01  2.466284e-01  9.726245e-02   
min   -1.000000e+00  1.480442e-01  1.944033e-02   
25%   -1.000000e+00  1.713457e-01  3.692898e-02   
50%   -9.999999e-01  1.965543e-01  5.166429e-02   
75%   -9.999747e-01  2.562272e-01  1.156208e-01   
max   -2.443310e-01  1.523884e+00  6.940162e-01   
std    1.443272e-01  1.668307e-01  1.073768e-01   

                    calculation_date                expiration_date  \
count                       17558616                       17558616   
mean   2008-05-29 05:18:15.806640640  2008-09-28 12:18:49.788726272   
min              2007-10-01 00:00:00            2007-10-31 00:00:00   
25%              2008-01-18 00:00:00            2008-05-17 00:00:00   
50%              2008-05-19 00:00:00            2008-09-20 00:00:00   
75%              2008-09-24 00:00:00            2009-01-31 00:00:00   
max              2009-04-01 00:00:00            2010-03-05 00:00:00   
std                              NaN                            NaN   

       observed_price     moneyness  
count    1.755862e+07  1.755862e+07  
mean     4.770599e+02 -1.597383e-03  
min      3.405384e-06 -1.000000e-01  
25%      2.631075e+02 -5.161373e-02  
50%      5.078472e+02 -2.223616e-03  
75%      6.869894e+02  4.810897e-02  
max      1.060682e+03  1.000000e-01  
std      2.615981e+02  5.755525e-02  

spot(s):
[ 676.03  682.43  683.09  696.44  701.13  712.8   718.09  720.76  735.18
  743.63  750.18  752.69  753.13  753.6   755.88  764.87  768.06  770.19
  772.72  777.66  778.97  783.62  787.62  788.25  789.34  793.89  797.06
  800.21  805.28  805.9   806.82  810.12  813.65  815.66  816.49  822.61
  825.26  826.08  826.55  827.3   827.32  831.68  832.16  833.74  835.12
  836.44  838.11  840.13  842.82  843.98  845.19  845.22  845.62  845.68
  848.38  849.36  849.62  849.89  850.47  853.02  857.33  858.88  863.39
  865.    868.15  868.97  869.08  869.78  870.18  870.82  871.38  871.64
  871.84  872.49  873.75  873.87  875.89  876.65  879.73  885.33  887.22
  888.94  890.17  890.47  895.24  898.8   898.85  899.16  901.72  903.41
  904.15  904.78  906.79  906.83  908.6   908.76  909.78  911.39  913.19
  913.75  919.06  926.64  927.54  930.68  931.03  934.45  940.16  940.49
  946.14  952.69  954.21  954.68  966.34  969.87  984.53  985.17  997.28
  997.9  1004.44 1005.42 1059.85 1099.45 1114.28 1114.4  1156.65 1161.63
 1165.72 1187.4  1188.42 1195.66 1203.3  1207.56 1210.16 1213.76 1214.59
 1214.91 1225.07 1228.34 1231.72 1235.03 1236.81 1240.01 1242.38 1244.81
 1245.64 1248.97 1249.51 1251.98 1252.02 1253.1  1253.33 1253.75 1257.85
 1259.82 1260.39 1260.44 1260.47 1261.75 1263.07 1263.23 1266.66 1267.13
 1267.3  1267.4  1267.76 1271.47 1273.68 1274.24 1274.77 1275.25 1276.78
 1276.84 1277.53 1277.54 1279.06 1279.22 1279.51 1281.63 1281.9  1283.32
 1283.57 1284.14 1284.21 1285.13 1285.9  1288.77 1289.26 1289.99 1292.07
 1292.95 1293.41 1295.65 1298.15 1298.46 1299.97 1304.46 1305.09 1308.8
 1311.13 1314.51 1314.81 1315.19 1317.94 1318.45 1320.45 1322.21 1322.24
 1325.42 1325.9  1326.38 1326.79 1328.62 1329.65 1329.75 1330.53 1330.91
 1331.14 1331.49 1333.24 1333.44 1333.8  1334.79 1335.63 1336.97 1337.24
 1338.18 1338.73 1339.01 1340.15 1340.92 1342.48 1342.83 1348.8  1348.82
 1348.83 1349.69 1349.91 1350.78 1351.52 1352.69 1353.69 1353.73 1354.63
 1354.95 1358.24 1359.88 1360.   1360.03 1360.47 1360.48 1362.14 1363.84
 1365.56 1365.65 1366.54 1367.41 1367.69 1369.22 1369.79 1370.68 1371.44
 1372.41 1372.91 1376.17 1376.18 1376.5  1377.07 1377.59 1379.83 1380.11
 1380.72 1380.79 1381.38 1385.23 1385.42 1385.74 1388.04 1388.3  1388.63
 1390.08 1390.45 1390.84 1391.01 1391.18 1392.46 1394.07 1395.   1396.31
 1397.45 1398.   1398.05 1399.4  1401.2  1403.12 1403.51 1403.52 1406.77
 1407.53 1408.06 1409.11 1409.14 1411.59 1413.53 1413.8  1416.12 1416.34
 1416.4  1418.38 1419.95 1423.24 1425.15 1426.43 1428.35 1433.65 1438.99
 1439.53 1439.88 1446.04 1446.9  1447.54 1451.21 1452.52 1452.95 1454.4
 1458.35 1460.37 1462.85 1467.54 1467.95 1469.04 1469.89 1470.07 1472.58
 1474.26 1475.44 1476.91 1477.65 1477.88 1480.57 1481.25 1484.68 1484.86
 1486.9  1488.85 1496.9  1497.42 1500.66 1502.13 1504.31 1506.44 1507.3
 1508.33 1510.2  1514.24 1515.9  1516.16 1519.66 1520.45 1531.05 1535.14
 1538.87 1539.62 1539.7  1540.86 1541.15 1542.85 1544.83 1546.48 1548.82
 1549.07 1552.65 1554.55 1557.09 1561.58 1562.09 1565.18]

strikes:
[ 609.          610.          611.         ... 1738.12530208 1738.45885136
 1738.79240064]

maturities:
[ 30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47
  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65
  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83
  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101
 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119
 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137
 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155
 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173
 174 175 176 177 178 179 180 181 182 183 184 185 186 198 226 254 282 310
 338]

types:
['call' 'put']


moneyness:
[-0.1        -0.1        -0.09999761 ...  0.09997585  0.09997656
  0.1       ]

number of calls, puts:
3348075,14210541

total prices:
17558616

Deep Neural Network
hidden layers sizes: (10, 10, 10)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
         spot_price  strike_price  heston_price  days_to_maturity  \
count  1.755862e+07  1.755862e+07  1.755862e+07      1.755862e+07   
mean   1.254718e+03  1.256698e+03  4.770597e+02      1.222921e+02   
min    6.760300e+02  6.090000e+02 -1.676217e-07      3.000000e+01   
25%    1.188420e+03  1.147000e+03  2.631014e+02      7.200000e+01   
50%    1.333240e+03  1.320000e+03  5.078439e+02      1.140000e+02   
75%    1.409140e+03  1.431000e+03  6.869910e+02      1.590000e+02   
max    1.565180e+03  1.738792e+03  1.060817e+03      3.380000e+02   
std    2.347389e+02  2.464902e+02  2.615987e+02      6.562377e+01   

       risk_free_rate  dividend_rate         kappa         theta  \
count    1.755862e+07   1.755862e+07  1.755862e+07  1.755862e+07   
mean     4.000000e-02   1.926064e+00  3.114736e+00  7.392048e-02   
min      4.000000e-02   1.803100e-02  6.280245e-01  4.072687e-02   
25%      4.000000e-02   1.858800e+00  1.691350e+00  5.429967e-02   
50%      4.000000e-02   2.141200e+00  2.070256e+00  5.763813e-02   
75%      4.000000e-02   2.322700e+00  3.934227e+00  6.600293e-02   
max      4.000000e-02   3.773500e+00  1.325023e+01  1.955930e-01   
std      2.617302e-12   1.017225e+00  2.324392e+00  3.488189e-02   

                rho           eta            v0  \
count  1.755862e+07  1.755862e+07  1.755862e+07   
mean  -9.559775e-01  2.466284e-01  9.726245e-02   
min   -1.000000e+00  1.480442e-01  1.944033e-02   
25%   -1.000000e+00  1.713457e-01  3.692898e-02   
50%   -9.999999e-01  1.965543e-01  5.166429e-02   
75%   -9.999747e-01  2.562272e-01  1.156208e-01   
max   -2.443310e-01  1.523884e+00  6.940162e-01   
std    1.443272e-01  1.668307e-01  1.073768e-01   

                    calculation_date                expiration_date  \
count                       17558616                       17558616   
mean   2008-05-29 05:18:15.806640640  2008-09-28 12:18:49.788726272   
min              2007-10-01 00:00:00            2007-10-31 00:00:00   
25%              2008-01-18 00:00:00            2008-05-17 00:00:00   
50%              2008-05-19 00:00:00            2008-09-20 00:00:00   
75%              2008-09-24 00:00:00            2009-01-31 00:00:00   
max              2009-04-01 00:00:00            2010-03-05 00:00:00   
std                              NaN                            NaN   

       observed_price     moneyness  
count    1.755862e+07  1.755862e+07  
mean     4.770599e+02 -1.597383e-03  
min      3.405384e-06 -1.000000e-01  
25%      2.631075e+02 -5.161373e-02  
50%      5.078472e+02 -2.223616e-03  
75%      6.869894e+02  4.810897e-02  
max      1.060682e+03  1.000000e-01  
std      2.615981e+02  5.755525e-02  
#############
# test data #
#############
         spot_price  strike_price  heston_price  days_to_maturity  \
count  7.271079e+06  7.271079e+06  7.271079e+06      7.271079e+06   
mean   1.001722e+03  1.003219e+03  3.840956e+02      1.223383e+02   
min    8.149600e+02  7.340000e+02  2.241232e-02      3.000000e+01   
25%    9.194000e+02  9.240000e+02  2.147382e+02      7.200000e+01   
50%    1.020610e+03  1.005000e+03  4.146916e+02      1.140000e+02   
75%    1.087240e+03  1.083000e+03  5.556794e+02      1.590000e+02   
max    1.127850e+03  1.252981e+03  8.088477e+02      3.380000e+02   
std    8.763219e+01  1.052608e+02  2.063341e+02      6.567111e+01   

       risk_free_rate  dividend_rate         kappa         theta  \
count    7.271079e+06   7.271079e+06  7.271079e+06  7.271079e+06   
mean     4.000000e-02   1.865197e+00  5.043511e+00  7.847298e-02   
min      4.000000e-02   2.008000e-02  2.348700e+00  5.788979e-02   
25%      4.000000e-02   2.069200e+00  3.822263e+00  6.665870e-02   
50%      4.000000e-02   2.161300e+00  4.907215e+00  7.118153e-02   
75%      4.000000e-02   2.420200e+00  5.851989e+00  8.393201e-02   
max      4.000000e-02   2.876400e+00  1.006043e+01  1.511908e-01   
std      3.331849e-13   9.093216e-01  1.551260e+00  1.945146e-02   

                rho           eta            v0  \
count  7.271079e+06  7.271079e+06  7.271079e+06   
mean  -9.416150e-01  1.969329e-01  5.048119e-02   
min   -1.000000e+00  1.545096e-01  1.494568e-02   
25%   -9.999878e-01  1.808555e-01  3.347424e-02   
50%   -9.698029e-01  1.895328e-01  4.225281e-02   
75%   -9.018281e-01  2.020133e-01  5.999310e-02   
max   -5.397599e-01  4.498648e-01  1.503238e-01   
std    7.624666e-02  3.075979e-02  2.685626e-02   

                    calculation_date                expiration_date  \
count                        7271079                        7271079   
mean   2009-08-23 17:32:31.522903296  2009-12-24 01:39:42.092287232   
min              2009-04-02 00:00:00            2009-05-02 00:00:00   
25%              2009-06-18 00:00:00            2009-10-10 00:00:00   
50%              2009-08-27 00:00:00            2009-12-23 00:00:00   
75%              2009-10-30 00:00:00            2010-03-04 00:00:00   
max              2009-12-31 00:00:00            2010-12-04 00:00:00   
std                              NaN                            NaN   

       observed_price     moneyness  
count    7.271079e+06  7.271079e+06  
mean     3.840957e+02 -1.671230e-03  
min      5.115484e-04 -1.000000e-01  
25%      2.147379e+02 -5.165280e-02  
50%      4.146922e+02 -2.311361e-03  
75%      5.556815e+02  4.801170e-02  
max      8.089619e+02  1.000000e-01  
std      2.063341e+02  5.752600e-02  

in sample results:
     RMSE: 4.22105158330862
     MAE: 3.047602471647502

out of sample results:
     RMSE: 29.12585236599492
     MAE: 21.285327159164954
