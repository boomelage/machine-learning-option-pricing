
        spot_price  strike_price   barrier  days_to_maturity updown outin  \
0          1416.59      1274.931   708.295                30   Down   Out   
1          1416.59      1274.931   708.295                30   Down   Out   
2          1416.59      1274.931   708.295                30   Down    In   
3          1416.59      1274.931   708.295                30   Down    In   
4          1416.59      1274.931   708.295                60   Down   Out   
...            ...           ...       ...               ...    ...   ...   
108115     1491.66      1640.826  2237.490               180     Up    In   
108116     1491.66      1640.826  2237.490               360     Up   Out   
108117     1491.66      1640.826  2237.490               360     Up   Out   
108118     1491.66      1640.826  2237.490               360     Up    In   
108119     1491.66      1640.826  2237.490               360     Up    In   

           w barrier_type_name  rebate  dividend_rate  risk_free_rate  \
0       call           DownOut     0.0       0.018125            0.04   
1        put           DownOut     0.0       0.018125            0.04   
2       call            DownIn     0.0       0.018125            0.04   
3        put            DownIn     0.0       0.018125            0.04   
4       call           DownOut     0.0       0.018125            0.04   
...      ...               ...     ...            ...             ...   
108115   put              UpIn     0.0       0.018659            0.04   
108116  call             UpOut     0.0       0.018659            0.04   
108117   put             UpOut     0.0       0.018659            0.04   
108118  call              UpIn     0.0       0.018659            0.04   
108119   put              UpIn     0.0       0.018659            0.04   

           theta     kappa  rho       eta        v0   calculation_date  \
0       0.082956  0.233438 -1.0  0.098497  0.010662  January 3rd, 2007   
1       0.082956  0.233438 -1.0  0.098497  0.010662  January 3rd, 2007   
2       0.082956  0.233438 -1.0  0.098497  0.010662  January 3rd, 2007   
3       0.082956  0.233438 -1.0  0.098497  0.010662  January 3rd, 2007   
4       0.082956  0.233438 -1.0  0.098497  0.010662  January 3rd, 2007   
...          ...       ...  ...       ...       ...                ...   
108115  0.024513  1.058987 -1.0  0.112957  0.014931     May 10th, 2007   
108116  0.024513  1.058987 -1.0  0.112957  0.014931     May 10th, 2007   
108117  0.024513  1.058987 -1.0  0.112957  0.014931     May 10th, 2007   
108118  0.024513  1.058987 -1.0  0.112957  0.014931     May 10th, 2007   
108119  0.024513  1.058987 -1.0  0.112957  0.014931     May 10th, 2007   

        barrier_price  moneyness moneyness_tag  observed_price  
0          143.765466   0.111111           itm      143.765466  
1            0.026056  -0.100000           otm        0.159338  
2            0.068991   0.111111           itm        0.068991  
3           -0.003565  -0.100000           otm       -0.003565  
4          146.290699   0.111111           itm      146.290699  
...               ...        ...           ...             ...  
108115       0.037515   0.100000           itm        0.037515  
108116      30.158273  -0.090909           otm       30.158273  
108117     143.044024   0.100000           itm      143.111900  
108118      -0.003287  -0.090909           otm       -0.003287  
108119       0.048393   0.100000           itm        0.048393  

[108120 rows x 21 columns]

          spot_price   strike_price        barrier  days_to_maturity  \
count  108120.000000  108120.000000  108120.000000     108120.000000   
mean     1435.928975    1435.928975    1435.928975        153.052164   
std        30.957805     104.572210     443.856220        117.077279   
min      1374.200000    1236.780000     687.100000         30.000000   
25%      1416.590000    1347.366000    1064.463450         60.000000   
50%      1428.810000    1432.329889    1430.755900         90.000000   
75%      1449.930000    1520.883000    1793.156550        198.000000   
max      1512.520000    1663.772000    2268.780000        360.000000   

         rebate  dividend_rate  risk_free_rate          theta          kappa  \
count  108120.0  108120.000000    1.081200e+05  108120.000000  108120.000000   
mean        0.0       0.018570    4.000000e-02       0.042852       1.395611   
std         0.0       0.000562    3.101700e-14       0.042554       1.644372   
min         0.0       0.017798    4.000000e-02       0.019921       0.039700   
25%         0.0       0.018125    4.000000e-02       0.022089       0.280413   
50%         0.0       0.018512    4.000000e-02       0.025497       0.957678   
75%         0.0       0.019118    4.000000e-02       0.065074       1.934722   
max         0.0       0.019742    4.000000e-02       0.405049      12.326035   

                 rho            eta             v0  barrier_price  \
count  108120.000000  108120.000000  108120.000000  108120.000000   
mean       -0.919530       0.126196       0.011673      29.974028   
std         0.152884       0.080051       0.004771      45.757767   
min        -1.000000       0.088178       0.005244      -0.423777   
25%        -1.000000       0.098497       0.008933       0.030695   
50%        -1.000000       0.106442       0.010662       4.138075   
75%        -0.782801       0.123817       0.013191      41.996915   
max        -0.347098       0.708018       0.031695     197.342122   

           moneyness  observed_price  
count  108120.000000   108120.000000  
mean        0.002436       30.033687  
std         0.069908       45.757620  
min        -0.100000       -0.392571  
25%        -0.050000        0.099018  
50%         0.000000        4.187773  
75%         0.052632       42.035255  
max         0.111111      197.531320  

spot(s):
[1374.2  1377.99 1386.77 1386.98 1387.16 1391.82 1392.05 1395.15 1399.96
 1401.5  1401.77 1402.74 1403.05 1406.48 1406.64 1409.82 1410.74 1412.12
 1412.71 1414.71 1416.59 1416.97 1418.28 1420.46 1420.83 1422.42 1422.43
 1423.07 1423.8  1424.27 1424.44 1426.09 1428.02 1428.7  1428.81 1430.36
 1430.59 1430.69 1431.78 1433.55 1434.56 1434.69 1436.11 1437.38 1437.45
 1438.07 1438.45 1438.91 1439.15 1439.97 1443.66 1444.24 1444.47 1445.71
 1447.04 1447.77 1447.89 1448.38 1448.46 1449.6  1449.93 1451.23 1452.78
 1455.05 1455.51 1456.3  1456.93 1457.51 1459.53 1468.23 1470.62 1471.33
 1472.32 1480.49 1481.12 1482.47 1484.4  1486.09 1491.66 1494.22 1494.32
 1495.27 1496.   1502.3  1505.49 1507.84 1509.13 1512.52]

strikes:
[1236.78       1240.191      1248.093      1248.282      1248.444
 1252.638      1252.845      1255.635      1259.964      1261.35
 1261.593      1262.466      1262.745      1265.832      1265.976
 1268.838      1269.666      1270.908      1271.439      1273.239
 1274.931      1275.273      1276.452      1278.414      1278.747
 1280.178      1280.187      1280.763      1281.42       1281.843
 1281.996      1283.481      1285.218      1285.83       1285.929
 1287.324      1287.531      1287.621      1288.602      1290.195
 1291.104      1291.221      1292.499      1293.642      1293.705
 1294.263      1294.605      1295.019      1295.235      1295.973
 1299.294      1299.816      1300.023      1301.139      1302.336
 1302.993      1303.101      1303.542      1303.614      1304.64
 1304.937      1305.49       1306.107      1306.41077778 1307.502
 1309.0905     1309.545      1309.959      1310.67       1311.237
 1311.759      1313.577      1317.4315     1317.631      1317.802
 1321.407      1322.229      1322.4475     1323.558      1324.197
 1325.088      1325.3925     1329.962      1331.425      1331.6815
 1332.441      1332.603      1332.8975     1333.008      1334.223
 1335.96       1336.156      1336.308      1337.481      1337.89055556
 1339.329      1340.203      1341.514      1342.0745     1342.494
 1343.9745     1344.798      1344.888      1345.743      1345.7605
 1346.1215     1346.4        1347.366      1349.437      1349.7885
 1351.299      1351.3085     1351.9165     1352.07       1352.61
 1353.0565     1353.218      1354.7855     1354.941      1356.619
 1357.056      1357.265      1357.3695     1358.217      1358.842
 1359.0605     1359.1555     1360.191      1361.268      1361.8725
 1362.832      1362.9555     1364.3045     1365.511      1365.5775
 1366.1665     1366.5275     1366.9645     1367.1925     1367.9715
 1369.37033333 1371.477      1372.028      1372.2465     1373.4245
 1374.2        1374.688      1375.3815     1375.4955     1375.961
 1376.037      1377.12       1377.4335     1377.99       1378.6685
 1380.141      1382.2975     1382.7345     1383.485      1384.0835
 1384.6345     1386.5535     1386.77       1386.98       1387.16
 1391.82       1392.05       1394.8185     1395.15       1397.089
 1397.7635     1398.704      1399.96       1400.85011111 1401.5
 1401.77       1402.74       1403.05       1406.4655     1406.48
 1406.64       1407.064      1408.3465     1409.82       1410.18
 1410.74       1411.7855     1412.12       1412.71       1414.71
 1416.59       1416.97       1417.077      1418.28       1419.509
 1419.604      1420.46       1420.5065     1420.83       1421.2
 1422.42       1422.43       1423.07       1423.8        1424.27
 1424.44       1426.09       1427.185      1428.02       1428.7
 1428.81       1430.2155     1430.36       1430.59       1430.69
 1431.78       1432.32988889 1432.448      1433.55       1433.6735
 1434.56       1434.69       1436.11       1436.894      1437.38
 1437.45       1438.07       1438.45       1438.91       1439.15
 1439.97       1442.91       1443.66       1444.24       1444.47
 1445.71       1446.8895     1447.04       1447.77       1447.89
 1448.38       1448.46       1449.6        1449.93       1451.23
 1452.78       1455.05       1455.51       1456.1085     1456.3
 1456.329      1456.518      1456.93       1457.51       1459.53
 1461.411      1461.6525     1463.80966667 1464.9075     1468.23
 1469.958      1470.62       1471.33       1471.575      1471.8585
 1472.32       1472.877      1473.2025     1476.804      1476.972
 1480.311      1480.49       1481.12       1481.277      1482.47
 1482.726      1483.3455     1484.4        1485.4455     1486.09
 1487.4195     1487.8185     1489.194      1491.483      1491.66
 1491.8715     1493.541      1493.5515     1494.22       1494.2235
 1494.32       1494.99       1495.27       1495.28944444 1495.4835
 1495.662      1496.         1497.3945     1499.421      1500.135
 1500.2505     1501.878      1502.1195     1502.2245     1502.3
 1503.369      1505.2275     1505.49       1506.288      1506.4245
 1507.84       1507.9155     1509.13       1509.249      1509.3225
 1509.9735     1510.3725     1510.8555     1511.1075     1511.62
 1511.9685     1512.52       1515.789      1515.843      1516.452
 1516.6935     1517.9955     1519.392      1520.1585     1520.2845
 1520.799      1520.883      1522.08       1522.4265     1523.7915
 1525.419      1525.447      1525.678      1525.876      1526.76922222
 1527.8025     1528.2855     1529.115      1529.7765     1530.3855
 1531.002      1531.255      1532.5065     1534.665      1539.956
 1541.6415     1541.65       1541.947      1543.014      1543.355
 1544.151      1544.8965     1545.936      1547.128      1547.304
 1550.802      1551.814      1553.332      1553.981      1554.5145
 1555.176      1556.181      1556.5935     1558.249      1558.62
 1558.667      1560.108      1560.3945     1562.506      1562.913
 1564.662      1564.673      1565.377      1566.18       1566.243
 1566.697      1566.884      1568.699      1568.931      1569.036
 1570.0335     1570.8        1570.822      1571.57       1571.691
 1573.396      1573.649      1573.759      1574.958      1576.905
 1577.415      1578.016      1578.159      1579.721      1580.7645
 1581.118      1581.195      1581.877      1582.295      1582.801
 1583.065      1583.232      1583.967      1584.5865     1588.026
 1588.146      1588.664      1588.917      1590.281      1591.744
 1592.547      1592.679      1593.218      1593.306      1594.56
 1594.923      1596.353      1598.058      1600.555      1601.061
 1601.93       1602.623      1603.261      1605.483      1615.053
 1617.682      1618.463      1619.552      1628.539      1629.232
 1630.717      1632.84       1634.699      1640.826      1643.642
 1643.752      1644.797      1645.6        1652.53       1656.039
 1658.624      1660.043      1663.772     ]

maturities:
[ 30  37  44  51  58  60  65  72  79  86  90  93 100 107 114 121 128 135
 142 149 156 163 170 177 180 184 191 198 205 212 219 226 233 240 247 254
 261 268 275 282 289 296 303 310 317 324 331 338 345 352 359 360]

types:
['call' 'put']

['itm' 'otm' 'atm']

['DownOut' 'DownIn' 'UpOut' 'UpIn']
moneyness:
[-1.00000000e-01 -1.00000000e-01 -1.00000000e-01 -9.09090909e-02
 -9.09090909e-02 -9.09090909e-02 -9.09090909e-02 -7.77777778e-02
 -7.21649485e-02 -5.55555556e-02 -5.26315789e-02 -5.00000000e-02
 -5.00000000e-02 -5.00000000e-02 -5.00000000e-02 -4.76190476e-02
 -4.76190476e-02 -4.76190476e-02 -4.76190476e-02 -4.76190476e-02
 -3.33333333e-02 -3.22580645e-02 -1.11111111e-02 -1.09890110e-02
 -3.33066907e-16 -1.11022302e-16  0.00000000e+00  2.22044605e-16
  1.11111111e-02  1.12359551e-02  3.33333333e-02  3.44827586e-02
  5.00000000e-02  5.00000000e-02  5.00000000e-02  5.26315789e-02
  5.26315789e-02  5.55555556e-02  5.88235294e-02  7.77777778e-02
  8.43373494e-02  1.00000000e-01  1.00000000e-01  1.00000000e-01
  1.11111111e-01  1.11111111e-01]

number of calls, puts:
{train_contracts.n_calls},{train_contracts.n_puts}

initial count:
108120

total prices:
108120

        spot_price  strike_price  days_to_maturity  risk_free_rate  \
count  1082.000000   1082.000000       1082.000000    1.082000e+03   
mean   1436.279372   1433.325952        149.001848    4.000000e-02   
std      30.994786    102.700013        114.906083    6.872682e-16   
min    1374.200000   1240.191000         30.000000    4.000000e-02   
25%    1416.590000   1347.883750         60.000000    4.000000e-02   
50%    1430.360000   1430.690000         90.000000    4.000000e-02   
75%    1451.230000   1520.883000        180.000000    4.000000e-02   
max    1512.520000   1663.772000        360.000000    4.000000e-02   

       dividend_rate    moneyness       target   prediciton  \
count    1082.000000  1082.000000  1082.000000  1082.000000   
mean        0.018562     0.000648    29.623767    28.725652   
std         0.000559     0.069625    45.880031    35.718031   
min         0.017798    -0.100000    -0.123852    -4.973081   
25%         0.018125    -0.050000     0.080379     3.815328   
50%         0.018512     0.000000     2.740205    15.598336   
75%         0.019118     0.052632    41.049269    33.421027   
max         0.019742     0.111111   186.130283   150.451349   

       abs_relative_error  
count         1082.000000  
mean                  inf  
std                   NaN  
min              0.003638  
25%              0.265826  
50%              2.065969  
75%             91.150529  
max                   inf  


Deep Neural Network
hidden layers sizes: (10, 10, 10)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001