Mon Oct  7 09:12:38 2024
spot(s):
[1374.2  1377.99 1386.77 1386.98 1387.16 1391.82 1392.05 1395.15 1399.96
 1401.5  1401.77 1402.74 1403.05 1406.48 1406.58 1406.64 1406.77 1409.82
 1410.74 1412.12 1412.71 1413.18 1414.71 1416.4  1416.59 1416.97 1418.28
 1420.46 1420.83 1422.42 1422.43 1423.07 1423.8  1424.27 1424.44 1426.09
 1426.6  1428.02 1428.35 1428.7  1428.81 1430.36 1430.59 1430.69 1431.78
 1433.18 1433.19 1433.55 1433.65 1434.56 1434.69 1436.11 1437.38 1437.45
 1438.07 1438.45 1438.91 1438.99 1439.15 1439.53 1439.88 1439.97 1443.66
 1444.24 1444.47 1445.28 1445.5  1445.71 1447.03 1447.04 1447.77 1447.89
 1448.38 1448.46 1449.6  1449.93 1451.21 1451.23 1451.6  1452.78 1452.95
 1452.96 1453.53 1453.85 1454.47 1454.78 1455.05 1455.51 1456.3  1456.93
 1457.51 1457.85 1458.35 1459.18 1459.53 1462.63 1462.85 1463.59 1463.78
 1466.35 1466.84 1467.25 1467.95 1468.23 1469.04 1469.89 1470.07 1470.62
 1471.33 1471.43 1471.49 1471.93 1471.99 1472.32 1472.58 1472.83 1473.51
 1474.26 1475.44 1476.23 1476.68 1477.65 1478.45 1479.09 1480.49 1480.57
 1481.12 1481.25 1482.47 1483.7  1484.16 1484.4  1484.51 1484.86 1486.09
 1486.9  1488.85 1489.28 1489.55 1491.66 1492.47 1493.24 1494.22 1494.32
 1495.27 1496.   1497.37 1497.46 1500.66 1501.4  1502.13 1502.3  1502.37
 1503.06 1503.36 1504.31 1505.36 1505.49 1506.   1506.03 1506.09 1506.44
 1507.3  1507.68 1507.84 1507.94 1508.33 1509.13 1510.2  1510.29 1511.77
 1512.26 1512.52 1512.61 1513.95 1514.24 1515.42 1515.75 1515.9  1516.16
 1516.28 1517.65 1517.78 1517.93 1518.08 1518.59 1518.8  1519.26 1519.38
 1519.66 1520.45 1521.61 1522.16 1522.51 1522.95 1523.96 1524.76 1524.84
 1525.35 1525.39 1525.5  1526.61 1528.78 1529.95 1530.14 1530.37 1530.69
 1531.05 1531.08 1531.44 1531.83 1532.93 1533.31 1534.08 1535.14 1536.18
 1538.87 1539.04 1539.62 1539.7  1540.86 1541.15 1542.85 1544.83 1546.47
 1546.48 1547.66 1548.82 1549.07 1549.66 1549.68 1552.26 1552.65 1552.8
 1554.55 1557.09 1561.58 1562.09 1565.18]

strikes:
[1236.78  1240.191 1248.093 ... 1717.738 1718.299 1721.698]

maturities:
[ 60  90 180 360 540 720]

types:
['call' 'put']

['DownOut' 'DownIn' 'UpOut' 'UpIn']
number of calls, puts:
1048520,1080178

total prices:
2128698
Deep Neural Network
hidden layers sizes: (10, 10, 10)
learning rate: adaptive
activation: relu
solver: sgd
alpha: 0.0001
#################
# training data #
#################
         spot_price  strike_price       barrier  days_to_maturity  \
count  2.128698e+06  2.128698e+06  2.128698e+06      2.128698e+06   
mean   1.492770e+03  1.491496e+03  1.491620e+03      3.322242e+02   
min    1.374200e+03  1.236780e+03  6.871000e+02      6.000000e+01   
25%    1.467250e+03  1.415555e+03  1.113976e+03      9.000000e+01   
50%    1.497460e+03  1.490609e+03  1.495376e+03      3.600000e+02   
75%    1.522510e+03  1.566218e+03  1.879199e+03      5.400000e+02   
max    1.565180e+03  1.721698e+03  2.347770e+03      7.200000e+02   
std    3.901456e+01  9.577734e+01  4.621484e+02      2.418070e+02   

       barrier_price     rebate  dividend_rate  risk_free_rate         theta  \
count   2.128698e+06  2128698.0   2.128698e+06    2.128698e+06  2.128698e+06   
mean    5.194757e+01        0.0   1.879834e-02    4.000000e-02  4.119287e-02   
min     2.593117e-08        0.0   1.779800e-02    4.000000e-02  1.992058e-02   
25%     1.583901e+00        0.0   1.843000e-02    4.000000e-02  3.123731e-02   
50%     2.829058e+01        0.0   1.871000e-02    4.000000e-02  3.893240e-02   
75%     8.981712e+01        0.0   1.913600e-02    4.000000e-02  4.972231e-02   
max     2.930981e+02        0.0   2.009800e-02    4.000000e-02  4.050494e-01   
std     5.779346e+01        0.0   4.739105e-04    8.899758e-13  1.701276e-02   

              kappa           rho           eta            v0  \
count  2.128698e+06  2.128698e+06  2.128698e+06  2.128698e+06   
mean   2.062832e+00 -9.409688e-01  2.029999e-01  3.357190e-02   
min    3.970018e-02 -1.000000e+00  8.817807e-02  5.244166e-03   
25%    9.645340e-01 -1.000000e+00  1.220301e-01  1.635893e-02   
50%    1.250748e+00 -9.999999e-01  1.594369e-01  2.822116e-02   
75%    2.348951e+00 -9.999992e-01  2.052679e-01  4.849839e-02   
max    1.232603e+01 -2.766103e-01  1.457690e+00  1.350097e-01   
std    2.093020e+00  1.627010e-01  1.727508e-01  2.045893e-02   

                    calculation_date                expiration_date  \
count                        2128698                        2128698   
mean   2007-08-06 07:45:48.987408640  2008-07-03 13:08:36.616636416   
min              2007-01-03 00:00:00            2007-03-04 00:00:00   
25%              2007-06-07 00:00:00            2007-12-04 00:00:00   
50%              2007-08-14 00:00:00            2008-05-15 00:00:00   
75%              2007-10-10 00:00:00            2009-02-06 00:00:00   
max              2007-12-14 00:00:00            2009-12-03 00:00:00   
std                              NaN                            NaN   

       observed_price  
count    2.128698e+06  
mean     5.195539e+01  
min      0.000000e+00  
25%      1.589316e+00  
50%      2.829932e+01  
75%      8.982045e+01  
max      2.931517e+02  
std      5.778693e+01  
#############
# test data #
#############
          spot_price   strike_price        barrier  days_to_maturity  \
count  299871.000000  299871.000000  299871.000000     299871.000000   
mean     1418.441368    1417.441253    1418.713870        328.993067   
min      1311.130000    1180.017000     655.565000         60.000000   
25%      1380.790000    1343.868980    1055.173300         90.000000   
50%      1416.340000    1414.958694    1430.503400        360.000000   
75%      1460.370000    1492.396429    1782.037250        540.000000   
max      1497.420000    1647.162000    2246.130000        720.000000   
std        54.014404      98.881373     442.929981        241.421254   

       barrier_price    rebate  dividend_rate  risk_free_rate          theta  \
count   2.998710e+05  299871.0  299871.000000    2.998710e+05  299871.000000   
mean    5.942989e+01       0.0       0.019936    4.000000e-02       0.057391   
min     5.479303e-07       0.0       0.018832    4.000000e-02       0.052883   
25%     3.689855e+00       0.0       0.019228    4.000000e-02       0.055780   
50%     3.827688e+01       0.0       0.019942    4.000000e-02       0.057191   
75%     1.034225e+02       0.0       0.020471    4.000000e-02       0.059229   
max     2.896199e+02       0.0       0.021637    4.000000e-02       0.061622   
std     6.168592e+01       0.0       0.000832    2.539015e-13       0.002230   

               kappa            rho            eta             v0  \
count  299871.000000  299871.000000  299871.000000  299871.000000   
mean        2.612134      -0.954584       0.232810       0.051654   
min         1.272383      -1.000000       0.182017       0.025719   
25%         1.786466      -1.000000       0.191475       0.042079   
50%         1.992654      -1.000000       0.199273       0.050917   
75%         2.238322      -1.000000       0.205726       0.057070   
max         8.984402      -0.484084       0.670358       0.100623   
std         1.708074       0.131176       0.104630       0.017409   

                    calculation_date                expiration_date  \
count                         299871                         299871   
mean   2008-01-04 19:48:24.612983296  2008-11-28 19:38:25.603410176   
min              2007-12-17 00:00:00            2008-02-15 00:00:00   
25%              2007-12-26 00:00:00            2008-04-07 00:00:00   
50%              2008-01-07 00:00:00            2008-12-12 00:00:00   
75%              2008-01-15 00:00:00            2009-06-30 00:00:00   
max              2008-01-24 00:00:00            2010-01-13 00:00:00   
std                              NaN                            NaN   

       observed_price  
count   299871.000000  
mean        59.436377  
min          0.000000  
25%          3.697075  
50%         38.260712  
75%        103.436150  
max        289.715782  
std         61.679910  

spot_price                  float64
strike_price                float64
barrier                     float64
days_to_maturity              int64
barrier_price               float64
updown                       object
outin                        object
w                            object
barrier_type_name            object
rebate                      float64
dividend_rate               float64
risk_free_rate              float64
theta                       float64
kappa                       float64
rho                         float64
eta                         float64
v0                          float64
calculation_date     datetime64[ns]
expiration_date      datetime64[ns]
observed_price              float64
dtype: object
in sample results:
     RMSE: 6.473798386584201
     MAE: 4.333781604674754

out of sample results:
     RMSE: 9.416811776983792
     MAE: 6.31439114611391

features:
     spot_price
     strike_price
     days_to_maturity
     risk_free_rate
     dividend_rate
     kappa
     theta
     rho
     eta
     v0
     barrier
     barrier_type_name
     w

target: observed_price

cpu: 156.2660653591156
Mon Oct  7 09:15:14 2024